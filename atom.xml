<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>CoderyeahğŸ‰</title>
  
  
  <link href="https://www.fomal.cc/atom.xml" rel="self"/>
  
  <link href="https://www.fomal.cc/"/>
  <updated>2022-09-21T12:35:08.775Z</updated>
  <id>https://www.fomal.cc/</id>
  
  <author>
    <name>CoderyeahğŸ‰</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>è‡ªå®šä¹‰æ³¨è§£å®ç°ç³»ç»Ÿå¯åŠ¨æ—¶åç«¯æƒé™æ•°æ®ç”Ÿæˆ</title>
    <link href="https://www.fomal.cc/posts/c5539480.html"/>
    <id>https://www.fomal.cc/posts/c5539480.html</id>
    <published>2025-05-20T08:38:30.658Z</published>
    <updated>2022-09-21T12:35:08.775Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ä¸€-æ³¨è§£ä»‹ç»"><a href="#ä¸€-æ³¨è§£ä»‹ç»" class="headerlink" title="ä¸€. æ³¨è§£ä»‹ç»"></a>ä¸€. æ³¨è§£ä»‹ç»</h3><ol><li><p>æ³¨è§£Annotationæ˜¯ä¸€ç§å¼•ç”¨æ•°æ®ç±»å‹ï¼Œç¼–è¯‘ä¹‹åä¹Ÿæ˜¯ç”Ÿæˆ.classç±»å‹çš„javaæ–‡ä»¶</p><p>è¯­æ³•ï¼šä¿®é¥°ç¬¦ @interface æ³¨è§£ç±»å‹å</p><ul><li>æ³¨è§£å¯ä»¥å‡ºç°åœ¨ç±»ä¸Šã€æ–¹æ³•ä¸Šã€å±æ€§ä¸Šã€ç”šè‡³æ³¨è§£ä¸Šç­‰â€¦</li><li>JDKä¸­å†…ç½®çš„æ³¨è§£@Override(å¤å†™)ã€@SuppressWarnings(å¿½ç•¥ç¼–è¯‘å™¨çš„è­¦å‘Š)ç­‰</li></ul></li><li><p>å…ƒæ³¨è§£</p><ul><li><p>å…ƒæ³¨è§£å°±æ˜¯ç”¨æ¥ä¿®é¥°æ³¨è§£çš„ï¼Œæ˜¯æ³¨è§£ä¸Šçš„æ³¨è§£ï¼›å¸¸è§çš„å…ƒæ³¨è§£æœ‰@Targetã€@Retentionã€@Documentedã€@Inherited.</p></li><li><p>@Targetï¼šè¡¨ç¤ºå½“å‰æ³¨è§£ä½¿ç”¨åœ¨ä»€ä¹ˆä½ç½®</p><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ä¾‹å¦‚<span class="number">1</span>ï¼š@<span class="keyword">Target</span>(ElementType.METHOD)</span><br><span class="line"><span class="keyword">Target</span>å†…éƒ¨çš„å€¼ä½¿ç”¨æšä¸¾ElementTypeè¡¨ç¤ºï¼Œè¡¨ç¤ºçš„ä¸»è¦ä½ç½®æœ‰ï¼šæ³¨è§£ã€æ„é€ æ–¹æ³•ã€å±æ€§ã€å±€éƒ¨å˜é‡ã€å‡½æ•°ã€åŒ…ã€å‚æ•°å’Œç±»(é»˜è®¤å€¼)ã€‚</span><br><span class="line">ä¾‹å¦‚<span class="number">2</span>ï¼š@<span class="keyword">Target</span>(&#123;ElementType.METHOD,ElementType.<span class="keyword">TYPE</span>&#125;)</span><br><span class="line">å¤šä¸ªä½ç½®ä½¿ç”¨æ•°ç»„çš„å†™æ³•</span><br></pre></td></tr></table></figure></li><li><p>@Retentionï¼šå®šä¹‰è¢«å®ƒæ‰€æ ‡è®°çš„æ³¨è§£èƒ½ä¿ç•™å¤šä¹…</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Retentionæ³¨è§£æœ‰ä¸€ä¸ªå±æ€§valueï¼Œæ˜¯RetentionPolicyç±»å‹çš„ï¼ŒEnum RetentionPolicyæ˜¯ä¸€ä¸ªæšä¸¾ç±»å‹</span><br><span class="line">è¿™ä¸ªæšä¸¾å†³å®šäº†Retentionæ³¨è§£åº”è¯¥å¦‚ä½•å»ä¿æŒï¼Œä¹Ÿå¯ç†è§£ä¸ºRententionæ­é… RententionPolicyä½¿ç”¨</span><br><span class="line">RetentionPolicyæœ‰<span class="number">3</span>ä¸ªå€¼ï¼š<span class="keyword">CLASS</span>ï¼Œ<span class="keyword">RUNTIME</span>ï¼Œ<span class="keyword">SOURCE</span></span><br><span class="line"></span><br><span class="line">@Retention(RetentionPolicy.<span class="keyword">SOURCE</span>)ï¼šæ³¨è§£åªä¿ç•™åœ¨æºæ–‡ä»¶ï¼Œå½“Javaæ–‡ä»¶ç¼–è¯‘æˆ<span class="keyword">class</span>æ–‡ä»¶çš„æ—¶å€™ï¼Œæ³¨è§£è¢«é—å¼ƒ</span><br><span class="line">@Retention(RetentionPolicy.<span class="keyword">CLASS</span>)ï¼šæ³¨è§£è¢«ä¿ç•™åˆ°<span class="keyword">class</span>æ–‡ä»¶ï¼Œä½†jvmåŠ è½½<span class="keyword">class</span>æ–‡ä»¶æ—¶å€™è¢«é—å¼ƒï¼Œè¿™æ˜¯é»˜è®¤çš„ç”Ÿå‘½å‘¨æœŸ</span><br><span class="line">@Retention(RetentionPolicy.<span class="keyword">RUNTIME</span>)ï¼šæ³¨è§£ä¸ä»…è¢«ä¿å­˜åˆ°<span class="keyword">class</span>æ–‡ä»¶ä¸­ï¼ŒjvmåŠ è½½<span class="keyword">class</span>æ–‡ä»¶ä¹‹åï¼Œä»ç„¶å­˜åœ¨</span><br></pre></td></tr></table></figure></li><li><p>@Documentedï¼šåŠ äº†è¿™ä¸ªæ³¨è§£çš„æ³¨è§£ï¼Œåœ¨ç”Ÿæˆæ–‡æ¡£çš„æ—¶å€™ï¼Œå¯ä»¥åœ¨æ–‡æ¡£ä¸­æ˜¾ç¤ºå‡ºæ¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> A&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>@Inheritedï¼šåŠ äº†è¿™ä¸ªæ³¨è§£çš„æ³¨è§£ï¼Œèƒ½è¢«ç»§æ‰¿</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Inherited</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> A&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@A</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span>()&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span> <span class="keyword">extends</span> <span class="title class_">B</span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ol><h3 id="äºŒ-è‡ªå®šä¹‰æƒé™æ³¨è§£ï¼Œé¡¹ç›®å¯åŠ¨æ—¶æ‰«ææ³¨è§£åŠ æƒé™"><a href="#äºŒ-è‡ªå®šä¹‰æƒé™æ³¨è§£ï¼Œé¡¹ç›®å¯åŠ¨æ—¶æ‰«ææ³¨è§£åŠ æƒé™" class="headerlink" title="äºŒ. è‡ªå®šä¹‰æƒé™æ³¨è§£ï¼Œé¡¹ç›®å¯åŠ¨æ—¶æ‰«ææ³¨è§£åŠ æƒé™"></a>äºŒ. è‡ªå®šä¹‰æƒé™æ³¨è§£ï¼Œé¡¹ç›®å¯åŠ¨æ—¶æ‰«ææ³¨è§£åŠ æƒé™</h3><h4 id="1-å®šä¹‰æ³¨è§£"><a href="#1-å®šä¹‰æ³¨è§£" class="headerlink" title="1. å®šä¹‰æ³¨è§£"></a>1. å®šä¹‰æ³¨è§£</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> io.coderyeah.basic.annotation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Target(&#123;ElementType.METHOD, ElementType.TYPE&#125;)</span><span class="comment">//æ³¨è§£èƒ½ä½œç”¨åœ¨æ–¹æ³•ä¸Šã€ç±»ä¸Š</span></span><br><span class="line"><span class="comment">//Javaä¸­çš„åå°„ï¼šåœ¨è¿è¡Œæ—¶ï¼ŒåŠ¨æ€è·å–ç±»çš„å„ç§ä¿¡æ¯çš„ä¸€ç§èƒ½åŠ›</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span><span class="comment">//å¯ä»¥é€šè¿‡åå°„è¯»å–æ³¨è§£</span></span><br><span class="line"><span class="meta">@Inherited</span><span class="comment">//å¯ä»¥è¢«ç»§æ‰¿</span></span><br><span class="line"><span class="meta">@Documented</span><span class="comment">//å¯ä»¥è¢«javadocå·¥å…·æå–æˆæ–‡æ¡£ï¼Œå¯ä»¥ä¸åŠ </span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> PreAuthorize &#123;</span><br><span class="line">    <span class="comment">//å¯¹åº”t_permissionè¡¨ä¸­çš„sn</span></span><br><span class="line">    String <span class="title function_">sn</span><span class="params">()</span>; <span class="comment">//department:patchDel</span></span><br><span class="line"><span class="comment">//å¯¹åº”t_permissionè¡¨ä¸­çš„name</span></span><br><span class="line">    String <span class="title function_">name</span><span class="params">()</span>; <span class="comment">//éƒ¨é—¨æ‰¹é‡åˆ é™¤</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»¥ååœ¨æ–¹æ³•æˆ–ç±»ä¸ŠåŠ äº†è¿™ä¸ª<code>@PreAuthorize</code> æ³¨è§£ï¼Œéƒ½ä¼šå»æ‰§è¡Œä¸€æ®µä¸šåŠ¡ä»£ç ã€ä¾‹å¦‚ï¼šæ·»åŠ æƒé™åˆ°<code>t_promission</code>ã€‘ï¼Œä½†æ˜¯è¦å…ˆæ‰«æè¿™ä¸ªæ³¨è§£ï¼Œç„¶åè§£æè¿™ä¸ªæ³¨è§£ï¼Œå†å»æ‰§è¡Œç›¸åº”çš„ä¸šåŠ¡ä»£ç </p><h4 id="2-ä¾‹å­"><a href="#2-ä¾‹å­" class="headerlink" title="2. ä¾‹å­"></a>2. ä¾‹å­</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> DepartmentService departmentService;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> deptDTO éƒ¨é—¨æŸ¥è¯¢å‚æ•°</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> Result</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PreAuthorize(name = &quot;éƒ¨é—¨åˆ—è¡¨&quot;, sn = &quot;department:list&quot;)</span></span><br><span class="line"><span class="meta">@LogAnnotation(module = &quot;éƒ¨é—¨æ¨¡å—&quot;, operate = &quot;åˆ†é¡µæŸ¥è¯¢éƒ¨é—¨åˆ—è¡¨&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;æŸ¥è¯¢éƒ¨é—¨åˆ—è¡¨&quot;)</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/list&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">list</span><span class="params">(<span class="meta">@RequestBody(required = false)</span> DeptDTO deptDTO)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> departmentService.list(deptDTO);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-æ‰«ææ³¨è§£åŠ æƒé™"><a href="#3-æ‰«ææ³¨è§£åŠ æƒé™" class="headerlink" title="3. æ‰«ææ³¨è§£åŠ æƒé™"></a>3. æ‰«ææ³¨è§£åŠ æƒé™</h4><p>æ³¨è§£å®šä¹‰ä¹‹åï¼Œéœ€è¦æ‰«æã€‚å°±åƒä¸šåŠ¡ä»£ç ä¸­@Serviceæ³¨è§£ï¼ŒæœåŠ¡å¯åŠ¨çš„æ—¶å€™å°±ä¼šå»æ‰«æï¼Œç”Ÿæˆä¸šåŠ¡å¯¹è±¡ã€‚å¹¶æ³¨å…¥åˆ°Controllerä½¿ç”¨ã€‚å¦‚æœå¯åŠ¨çš„æ—¶å€™ä¸šåŠ¡ä»£ç ä¸­æ²¡æœ‰æ·»åŠ @Serviceæ³¨è§£ï¼Œå¯åŠ¨ä¼šæŠ¥é”™çš„ã€‚</p><h4 id="4-è‡ªå®šä¹‰çš„æ³¨è§£æ€ä¹ˆæ‰«æå‘¢ï¼Ÿè€Œä¸”è¦åœ¨æœåŠ¡å™¨å¯åŠ¨çš„æ—¶å€™è‡ªåŠ¨æ‰«æï¼Ÿ"><a href="#4-è‡ªå®šä¹‰çš„æ³¨è§£æ€ä¹ˆæ‰«æå‘¢ï¼Ÿè€Œä¸”è¦åœ¨æœåŠ¡å™¨å¯åŠ¨çš„æ—¶å€™è‡ªåŠ¨æ‰«æï¼Ÿ" class="headerlink" title="4. è‡ªå®šä¹‰çš„æ³¨è§£æ€ä¹ˆæ‰«æå‘¢ï¼Ÿè€Œä¸”è¦åœ¨æœåŠ¡å™¨å¯åŠ¨çš„æ—¶å€™è‡ªåŠ¨æ‰«æï¼Ÿ"></a>4. è‡ªå®šä¹‰çš„æ³¨è§£æ€ä¹ˆæ‰«æå‘¢ï¼Ÿè€Œä¸”è¦åœ¨æœåŠ¡å™¨å¯åŠ¨çš„æ—¶å€™è‡ªåŠ¨æ‰«æï¼Ÿ</h4><ul><li>å¯ä»¥é€šè¿‡Webä¸‰å¤§ç»„ä»¶ï¼šServletã€è¿‡æ»¤å™¨Filterã€ç›‘å¬å™¨Listenter</li></ul><ul><li><p>åœ¨SpringBooté¡¹ç›®ä¸­ï¼Œå¦‚æœæƒ³è‡ªå®šä¹‰Servletã€Filterã€Listenterï¼Œæˆ‘ä»¬åªéœ€è¦å®Œæˆä¸¤ä¸ªæ­¥éª¤ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> è‡ªå·±å†™ä¸€ä¸ªç±»å®ç°çˆ¶æ¥å£æˆ–è€…ç»§æ‰¿çˆ¶ç±»ï¼šSpringæä¾›çš„çš„Servletã€<span class="keyword">Filter</span>ã€Listenterï¼Œå¹¶åœ¨å®ç°ç±»ä¸Šæ‰“ä¸Šæ³¨è§£</span><br><span class="line"><span class="number">1.1</span>. è‡ªå®šä¹‰servletï¼šç»§æ‰¿HttpServletï¼Œæ‰“æ³¨è§£<span class="variable">@WebServlet</span></span><br><span class="line">  <span class="number">1.2</span>. è‡ªå®šä¹‰<span class="keyword">Filter</span>ï¼šå®ç°<span class="keyword">Filter</span>ï¼Œæ‰“æ³¨è§£<span class="variable">@WebFilter</span></span><br><span class="line"><span class="number">1.3</span>. è‡ªå®šä¹‰Listenterï¼šå®ç°ServletContextListenerï¼Œæ‰“æ³¨è§£<span class="variable">@WebListener</span> </span><br><span class="line">æ³¨æ„ï¼šSpringBooté¡¹ç›®ä¸­æ²¡æœ‰web.xmlï¼Œä¸èƒ½é€šè¿‡xmlé…ç½®å®ç°ã€‚ä½†æ˜¯å¯ä»¥é€šè¿‡æ³¨è§£</span><br><span class="line"><span class="number">2.</span> äº¤ç»™å®¹å™¨æ‰«æï¼šåœ¨å¯åŠ¨ç±»ä¸Šæ‰“æ³¨è§£ï¼š<span class="variable">@ServletComponentScan</span>æ‰«æServletã€<span class="keyword">Filter</span>ã€Listenterçš„åŒ…å³å¯</span><br></pre></td></tr></table></figure></li></ul><h4 id="5-æƒé™æ³¨è§£æ‰«æç›‘å¬å™¨"><a href="#5-æƒé™æ³¨è§£æ‰«æç›‘å¬å™¨" class="headerlink" title="5 .æƒé™æ³¨è§£æ‰«æç›‘å¬å™¨"></a>5 .æƒé™æ³¨è§£æ‰«æç›‘å¬å™¨</h4><p>ç›‘å¬å™¨ï¼šç›‘å¬å››å¤§ä½œç”¨åŸŸçš„å˜åŒ–å’Œå±æ€§çš„å˜æ›´<br>applicationçš„ç±»å‹ï¼š<code>ServletContext</code> - è¿™ä¸ªå¯¹è±¡ä¼šåœ¨æœåŠ¡å™¨å¯åŠ¨çš„æ—¶å€™è‡ªåŠ¨ç”Ÿæˆï¼Œè€Œä¸”æ˜¯å”¯ä¸€ä¸€ä¸ªã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> io.coderyeah.system.listener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.coderyeah.system.service.PermissionScanService;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletContextEvent;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletContextListener;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebListener;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebListener</span><span class="comment">//ç”³æ˜è‡ªå®šä¹‰çš„webç›‘å¬å™¨ï¼Œè¢«å®¹å™¨æ³¨å†Œå’Œä½¿ç”¨</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PermissionScanInitListener</span> <span class="keyword">implements</span> <span class="title class_">ServletContextListener</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> IPermissionScanService permissionScanService;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//springå®¹å™¨åˆå§‹åŒ–ç»“æŸä¹‹åè¢«è°ƒç”¨</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextInitialized</span><span class="params">(ServletContextEvent servletContextEvent)</span> &#123;</span><br><span class="line">        <span class="comment">//è¿™é‡Œé¢çš„ä¸šåŠ¡éšç€æ¥å£çš„å˜å¤šï¼Œå¯èƒ½æ‰§è¡Œæ—¶é—´ä¼šéå¸¸ä¹…ï¼Œå½±å“æ€§èƒ½ã€‚å½±å“ä¸»çº¿ç¨‹çš„å¯åŠ¨</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;<span class="comment">//ä¸ç”¨ä¸»çº¿ç¨‹å»æ‰§è¡Œï¼Œç”¨ä¸€ä¸ªæ–°çš„çº¿ç¨‹å»æ‰§è¡Œ</span></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                <span class="comment">//å¯ä»¥åœ¨è¿™é‡Œæ‰«ææˆ‘ä»¬è‡ªå®šä¹‰çš„æ³¨è§£@PreAuthorizeï¼Œç„¶åå°†ä¿¡æ¯å­˜å‚¨åˆ°t_permissionè¡¨</span></span><br><span class="line">                <span class="comment">//è¿™æ ·å°±æ— éœ€æ‰‹åŠ¨å½•å…¥ä¿¡æ¯åˆ°æƒé™t_permissionè¡¨äº†</span></span><br><span class="line">                log.info(<span class="string">&quot;æƒé™åˆå§‹åŒ–å¼€å§‹******************************************&quot;</span>);</span><br><span class="line">                System.out.println(<span class="string">&quot;æƒé™åˆå§‹åŒ–å¼€å§‹******************************************&quot;</span>);</span><br><span class="line">                permissionScanService.scanPermission();</span><br><span class="line">                System.out.println(<span class="string">&quot;æƒé™åˆå§‹åŒ–ç»“æŸ******************************************&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">//å®¹å™¨é”€æ¯çš„æ—¶å€™æ‰§è¡Œ</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">contextDestroyed</span><span class="params">(ServletContextEvent servletContextEvent)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="6-å¯åŠ¨ç±»"><a href="#6-å¯åŠ¨ç±»" class="headerlink" title="6. å¯åŠ¨ç±»"></a>6. å¯åŠ¨ç±»</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@MapperScan(&quot;io.coderyeah.*.mapper&quot;)</span></span><br><span class="line"><span class="comment">//åŠ è½½Listener - æœ¬æ¥ç›‘å¬å™¨åªè¦æœåŠ¡å™¨ä¸€å¯åŠ¨å°±ä¼šæ‰§è¡Œï¼Œä½†æ˜¯SpringBooté¡¹ç›®ä¸­æ˜¯é€šè¿‡å¯åŠ¨ç±»å¼€å¯æœåŠ¡çš„ï¼Œæ‰€ä»¥è¦åŠ è¿™ä¸ªæ³¨è§£å»åŠ è½½listenerï¼Œlisteneræ‰ä¼šèµ·ä½œç”¨</span></span><br><span class="line"><span class="meta">@ServletComponentScan(value = &#123;&quot;io.coderyeah.system.listener&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PetHomeApplication</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(PetHomeApplication.class,args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æµ‹è¯•ï¼šå¯åŠ¨é¡¹ç›®å°±ä¼šæ‰“å°è¾“å‡ºä¿¡æ¯</span></span><br></pre></td></tr></table></figure><h4 id="7-ä¸šåŠ¡æ¥å£"><a href="#7-ä¸šåŠ¡æ¥å£" class="headerlink" title="7. ä¸šåŠ¡æ¥å£"></a>7. ä¸šåŠ¡æ¥å£</h4><p>æ­¤ä¸šåŠ¡æ¥å£ä¸“é—¨ç”¨æ¥è§£ææ³¨è§£<code>@PreAuthorize(name = &quot;éƒ¨é—¨åˆ—è¡¨&quot;,sn= &quot;department:list&quot;)</code>å’Œæ³¨è§£ä¸Šçš„å‚æ•°ï¼Œå¹¶è·å–å‡ºæ¥æ·»åŠ åˆ°æƒé™è¡¨t_permissionã€‚</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.æ‰¾åŒ… - æ‰¾ç±» - æ‰¾æ–¹æ³• - æ‰¾æ³¨è§£</span></span><br><span class="line"><span class="comment">//2.è§£æè¿™ä¸ªæ³¨è§£æ‹¿åˆ°ï¼šsn,name</span></span><br><span class="line"><span class="comment">//3.å½“å‰æ–¹æ³•çš„urlåœ°å€</span></span><br><span class="line"><span class="comment">//4.åˆ›å»ºä¸€ä¸ªPermissonå¯¹è±¡ - æ·»åŠ åˆ°æ•°æ®åº“</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> io.coderyeah.system.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.conditions.query.LambdaQueryWrapper;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;</span><br><span class="line"><span class="keyword">import</span> io.coderyeah.basic.annotation.PreAuthorize;</span><br><span class="line"><span class="keyword">import</span> io.coderyeah.basic.util.ClassUtils;</span><br><span class="line"><span class="keyword">import</span> io.coderyeah.system.domain.Permission;</span><br><span class="line"><span class="keyword">import</span> io.coderyeah.system.mapper.PermissionMapper;</span><br><span class="line"><span class="keyword">import</span> io.coderyeah.system.service.PermissionService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileFilter;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Annotation;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Matcher;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Pattern;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> coderyeah</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> é’ˆå¯¹è¡¨ã€t_permissionã€‘çš„æ•°æ®åº“æ“ä½œServiceå®ç°</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@createDate</span> 2022-09-21 11:00:07</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PermissionServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;PermissionMapper, Permission&gt; <span class="keyword">implements</span> <span class="title class_">PermissionService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">PKG_PREFIX</span> <span class="operator">=</span> <span class="string">&quot;io.coderyeah.&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">PKG_SUFFIX</span> <span class="operator">=</span> <span class="string">&quot;.controller&quot;</span>;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> PermissionMapper permissionMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">scanPermission</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//è·å– io.coderyeah ä¸‹é¢æ‰€æœ‰çš„æ¨¡å—ç›®å½•</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> <span class="built_in">this</span>.getClass().getResource(<span class="string">&quot;/&quot;</span>).getPath() + <span class="string">&quot;/io/coderyeah/&quot;</span>;</span><br><span class="line">        <span class="comment">// å½“å‰åŒ…è·¯å¾„ä¸‹çš„æ–‡ä»¶å¯¹è±¡</span></span><br><span class="line">        <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(path);</span><br><span class="line">        <span class="comment">// è¿‡æ»¤å‡ºå½“å‰åŒ…ä¸‹æ‰€æœ‰ç›®å½•çš„æ–‡ä»¶æ•°ç»„</span></span><br><span class="line">        File[] files = file.listFiles(<span class="keyword">new</span> <span class="title class_">FileFilter</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">accept</span><span class="params">(File file)</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> file.isDirectory();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è·å–io.coderyeah.*.controlleré‡Œé¢æ‰€æœ‰çš„ç±»</span></span><br><span class="line">        Set&lt;Class&gt; clazzes = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">assert</span> files != <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">for</span> (File fileTmp : files) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;===============æƒé™æ³¨è§£è§£æï¼šè·å–æ‰€æœ‰çš„åŒ…==============&quot;</span>);</span><br><span class="line">            System.out.println(fileTmp.getName());</span><br><span class="line">            <span class="comment">// å°†æ‰€æœ‰ç±»å¯¹è±¡æ”¾è¿›seté›†åˆ</span></span><br><span class="line">            clazzes.addAll(ClassUtils.getClasses(PKG_PREFIX + fileTmp.getName() + PKG_SUFFIX));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// éå†ç±»å¯¹è±¡é›†åˆ</span></span><br><span class="line">        <span class="keyword">for</span> (Class clazz : clazzes) &#123;</span><br><span class="line">            <span class="comment">// è·å–å½“å‰ç±»çš„æ‰€æœ‰æ–¹æ³•</span></span><br><span class="line">            Method[] methods = clazz.getMethods();</span><br><span class="line">            <span class="comment">// åˆ¤æ–­æ˜¯å¦æœ‰æ–¹æ³•å­˜åœ¨</span></span><br><span class="line">            <span class="keyword">if</span> (methods == <span class="literal">null</span> || methods.length &lt; <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// éå†å½“å‰ç±»ä¸­æ‰€æœ‰çš„æ–¹æ³•</span></span><br><span class="line">            <span class="keyword">for</span> (Method method : methods) &#123;</span><br><span class="line">                <span class="comment">// è·å–æ¥å£æ‰§è¡Œè·¯å¾„</span></span><br><span class="line">                <span class="type">String</span> <span class="variable">uri</span> <span class="operator">=</span> getUri(clazz, method);</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="type">PreAuthorize</span> <span class="variable">preAuthorizeAnno</span> <span class="operator">=</span> method.getAnnotation(PreAuthorize.class);</span><br><span class="line">                    <span class="keyword">if</span> (preAuthorizeAnno == <span class="literal">null</span>) &#123;</span><br><span class="line">                        <span class="comment">// è·³å‡ºå½“å‰å¾ªç¯</span></span><br><span class="line">                        <span class="keyword">continue</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> preAuthorizeAnno.name();</span><br><span class="line">                    <span class="type">String</span> <span class="variable">permissionSn</span> <span class="operator">=</span> preAuthorizeAnno.sn();</span><br><span class="line">                    <span class="type">Permission</span> <span class="variable">permissionTmp</span> <span class="operator">=</span> permissionMapper.selectOne(<span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;Permission&gt;().eq(Permission::getSn, permissionSn));</span><br><span class="line">                    <span class="comment">//å¦‚æœä¸å­˜åœ¨å°±æ·»åŠ </span></span><br><span class="line">                    <span class="keyword">if</span> (permissionTmp == <span class="literal">null</span>) &#123;</span><br><span class="line">                        <span class="type">Permission</span> <span class="variable">permission</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Permission</span>();</span><br><span class="line">                        permission.setName(name);       <span class="comment">//t_permissionè¡¨ä¸­çš„æƒé™å</span></span><br><span class="line">                        permission.setSn(permissionSn); <span class="comment">//t_permissionè¡¨ä¸­çš„æƒé™ç¼–å·</span></span><br><span class="line">                        permission.setUrl(uri);           <span class="comment">//t_permissionè¡¨ä¸­çš„æƒé™è·¯å¾„</span></span><br><span class="line">                        permissionMapper.insert(permission);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="comment">//å¦‚æœå­˜åœ¨å°±ä¿®æ”¹</span></span><br><span class="line">                        permissionTmp.setName(name);</span><br><span class="line">                        permissionTmp.setSn(permissionSn);</span><br><span class="line">                        permissionTmp.setUrl(uri);</span><br><span class="line">                        permissionMapper.updateById(permissionTmp);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//è·å–t_permissionè¡¨ä¸­çš„url  //@RequestMapping(&quot;/department&quot;) //@GetMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">getUri</span><span class="params">(Class clazz, Method method)</span> &#123;</span><br><span class="line">        <span class="comment">//è·å–ç±»ä¸Šçš„è¯·æ±‚è·¯å¾„ï¼š/department</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">classPath</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="comment">// è·å–å½“å‰ç±»çš„@RequestMappingæ³¨è§£</span></span><br><span class="line">        <span class="type">Annotation</span> <span class="variable">annotation</span> <span class="operator">=</span> clazz.getAnnotation(RequestMapping.class);</span><br><span class="line">        <span class="comment">// åˆ¤æ–­æ³¨è§£æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">        <span class="keyword">if</span> (annotation != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">// ç±»å‹å¼ºè½¬</span></span><br><span class="line">            <span class="type">RequestMapping</span> <span class="variable">requestMapping</span> <span class="operator">=</span> (RequestMapping) annotation;</span><br><span class="line">            <span class="comment">// è·å–@RequestMappingæ³¨è§£çš„æ•°ç»„å€¼</span></span><br><span class="line">            String[] values = requestMapping.value();</span><br><span class="line">            <span class="comment">// åˆ¤æ–­å€¼æ˜¯å¦ä¸ºç©º</span></span><br><span class="line">            <span class="keyword">if</span> (values != <span class="literal">null</span> &amp;&amp; values.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="comment">// å°†è¯·æ±‚è·¯å¾„èµ‹å€¼ç»™classPath</span></span><br><span class="line">                classPath = values[<span class="number">0</span>];</span><br><span class="line">                <span class="keyword">if</span> (!<span class="string">&quot;&quot;</span>.equals(classPath) &amp;&amp; !classPath.startsWith(<span class="string">&quot;/&quot;</span>))</span><br><span class="line">                    classPath = <span class="string">&quot;/&quot;</span> + classPath;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//ä»¥ä¸‹æ˜¯è·å–æ–¹æ³•ä¸Šçš„è¯·æ±‚è·¯å¾„ï¼š/&#123;id&#125;</span></span><br><span class="line">        <span class="type">GetMapping</span> <span class="variable">getMapping</span> <span class="operator">=</span> method.getAnnotation(GetMapping.class);</span><br><span class="line">        <span class="comment">// æ–¹æ³•ä¸Šçš„è¯·æ±‚è·¯å¾„</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">methodPath</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (getMapping != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">// è·å–æ³¨è§£ä¸Šçš„å€¼</span></span><br><span class="line">            String[] values = getMapping.value();</span><br><span class="line">            <span class="keyword">if</span> (values != <span class="literal">null</span> &amp;&amp; values.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                methodPath = values[<span class="number">0</span>];</span><br><span class="line">                <span class="keyword">if</span> (!<span class="string">&quot;&quot;</span>.equals(methodPath) &amp;&amp; !methodPath.startsWith(<span class="string">&quot;/&quot;</span>))</span><br><span class="line">                    methodPath = <span class="string">&quot;/&quot;</span> + methodPath;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">PostMapping</span> <span class="variable">postMapping</span> <span class="operator">=</span> method.getAnnotation(PostMapping.class);</span><br><span class="line">        <span class="keyword">if</span> (postMapping != <span class="literal">null</span>) &#123;</span><br><span class="line">            String[] values = postMapping.value();</span><br><span class="line">            <span class="keyword">if</span> (values != <span class="literal">null</span> &amp;&amp; values.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                methodPath = values[<span class="number">0</span>];</span><br><span class="line">                <span class="keyword">if</span> (!<span class="string">&quot;&quot;</span>.equals(methodPath) &amp;&amp; !methodPath.startsWith(<span class="string">&quot;/&quot;</span>))</span><br><span class="line">                    methodPath = <span class="string">&quot;/&quot;</span> + methodPath;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">DeleteMapping</span> <span class="variable">deleteMapping</span> <span class="operator">=</span> method.getAnnotation(DeleteMapping.class);</span><br><span class="line">        <span class="keyword">if</span> (deleteMapping != <span class="literal">null</span>) &#123;</span><br><span class="line">            String[] values = deleteMapping.value();</span><br><span class="line">            <span class="keyword">if</span> (values != <span class="literal">null</span> &amp;&amp; values.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                methodPath = values[<span class="number">0</span>];</span><br><span class="line">                <span class="keyword">if</span> (!<span class="string">&quot;&quot;</span>.equals(methodPath) &amp;&amp; !methodPath.startsWith(<span class="string">&quot;/&quot;</span>))</span><br><span class="line">                    methodPath = <span class="string">&quot;/&quot;</span> + methodPath;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">PutMapping</span> <span class="variable">putMapping</span> <span class="operator">=</span> method.getAnnotation(PutMapping.class);</span><br><span class="line">        <span class="keyword">if</span> (putMapping != <span class="literal">null</span>) &#123;</span><br><span class="line">            String[] values = putMapping.value();</span><br><span class="line">            <span class="keyword">if</span> (values != <span class="literal">null</span> &amp;&amp; values.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                methodPath = values[<span class="number">0</span>];</span><br><span class="line">                <span class="keyword">if</span> (!<span class="string">&quot;&quot;</span>.equals(methodPath) &amp;&amp; !methodPath.startsWith(<span class="string">&quot;/&quot;</span>))</span><br><span class="line">                    methodPath = <span class="string">&quot;/&quot;</span> + methodPath;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">PatchMapping</span> <span class="variable">patchMapping</span> <span class="operator">=</span> method.getAnnotation(PatchMapping.class);</span><br><span class="line">        <span class="keyword">if</span> (patchMapping != <span class="literal">null</span>) &#123;</span><br><span class="line">            String[] values = patchMapping.value();</span><br><span class="line">            <span class="keyword">if</span> (values != <span class="literal">null</span> &amp;&amp; values.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                methodPath = values[<span class="number">0</span>];</span><br><span class="line">                <span class="keyword">if</span> (!<span class="string">&quot;&quot;</span>.equals(methodPath) &amp;&amp; !methodPath.startsWith(<span class="string">&quot;/&quot;</span>))</span><br><span class="line">                    methodPath = <span class="string">&quot;/&quot;</span> + methodPath;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">RequestMapping</span> <span class="variable">requestMapping</span> <span class="operator">=</span> method.getAnnotation(RequestMapping.class);</span><br><span class="line">        <span class="keyword">if</span> (requestMapping != <span class="literal">null</span>) &#123;</span><br><span class="line">            String[] values = requestMapping.value();</span><br><span class="line">            <span class="keyword">if</span> (values != <span class="literal">null</span> &amp;&amp; values.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                methodPath = values[<span class="number">0</span>];</span><br><span class="line">                <span class="keyword">if</span> (!<span class="string">&quot;&quot;</span>.equals(methodPath) &amp;&amp; !methodPath.startsWith(<span class="string">&quot;/&quot;</span>))</span><br><span class="line">                    methodPath = <span class="string">&quot;/&quot;</span> + methodPath;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> classPath + methodPath;  <span class="comment">// /department/&#123;id&#125;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">getPermissionSn</span><span class="params">(String value)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">regex</span> <span class="operator">=</span> <span class="string">&quot;\\[(.*?)]&quot;</span>;</span><br><span class="line">        <span class="type">Pattern</span> <span class="variable">p</span> <span class="operator">=</span> Pattern.compile(<span class="string">&quot;(?&lt;=\\()[^\\)]+&quot;</span>);</span><br><span class="line">        <span class="type">Matcher</span> <span class="variable">m</span> <span class="operator">=</span> p.matcher(value);</span><br><span class="line">        <span class="type">String</span> <span class="variable">permissionSn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (m.find()) &#123;</span><br><span class="line">            permissionSn = m.group(<span class="number">0</span>).substring(<span class="number">1</span>, m.group().length() - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> permissionSn;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="8-å·¥å…·ç±»ï¼šClassUtils-java"><a href="#8-å·¥å…·ç±»ï¼šClassUtils-java" class="headerlink" title="8. å·¥å…·ç±»ï¼šClassUtils.java"></a>8. å·¥å…·ç±»ï¼šClassUtils.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> io.coderyeah.basic.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileFilter;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.net.URLDecoder;</span><br><span class="line"><span class="keyword">import</span> java.util.Enumeration;</span><br><span class="line"><span class="keyword">import</span> java.util.LinkedHashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ClassUtils</span> &#123;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä»ä¼ å…¥çš„åŒ…ä¸­è·å–æ‰€æœ‰çš„ç±»çš„å­—èŠ‚ç å¯¹è±¡:</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> LEIYU</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> pack</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Set&lt;Class&lt;?&gt;&gt; getClasses(String pack) &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¬¬ä¸€ä¸ªclassç±»çš„é›†åˆ</span></span><br><span class="line">Set&lt;Class&lt;?&gt;&gt; classes = <span class="keyword">new</span> <span class="title class_">LinkedHashSet</span>&lt;Class&lt;?&gt;&gt;();</span><br><span class="line"><span class="comment">// æ˜¯å¦å¾ªç¯è¿­ä»£</span></span><br><span class="line"><span class="type">boolean</span> <span class="variable">recursive</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line"><span class="comment">// è·å–åŒ…çš„åå­— å¹¶è¿›è¡Œæ›¿æ¢</span></span><br><span class="line"><span class="type">String</span> <span class="variable">packageName</span> <span class="operator">=</span> pack;</span><br><span class="line"><span class="type">String</span> <span class="variable">packageDirName</span> <span class="operator">=</span> packageName.replace(<span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;/&#x27;</span>);</span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªæšä¸¾çš„é›†åˆ å¹¶è¿›è¡Œå¾ªç¯æ¥å¤„ç†è¿™ä¸ªç›®å½•ä¸‹çš„things</span></span><br><span class="line">Enumeration&lt;URL&gt; dirs;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">dirs = Thread.currentThread().getContextClassLoader().getResources(packageDirName);</span><br><span class="line"><span class="comment">// å¾ªç¯è¿­ä»£ä¸‹å»</span></span><br><span class="line"><span class="keyword">while</span> (dirs.hasMoreElements()) &#123;</span><br><span class="line"><span class="comment">// è·å–ä¸‹ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line"><span class="type">URL</span> <span class="variable">url</span> <span class="operator">=</span> dirs.nextElement();</span><br><span class="line"><span class="comment">// å¾—åˆ°åè®®çš„åç§°</span></span><br><span class="line"><span class="type">String</span> <span class="variable">protocol</span> <span class="operator">=</span> url.getProtocol();</span><br><span class="line"><span class="comment">// å¦‚æœæ˜¯ä»¥æ–‡ä»¶çš„å½¢å¼ä¿å­˜åœ¨æœåŠ¡å™¨ä¸Š</span></span><br><span class="line"><span class="keyword">if</span> (<span class="string">&quot;file&quot;</span>.equals(protocol)) &#123;</span><br><span class="line"><span class="comment">// è·å–åŒ…çš„ç‰©ç†è·¯å¾„</span></span><br><span class="line"><span class="type">String</span> <span class="variable">filePath</span> <span class="operator">=</span> URLDecoder.decode(url.getFile(), <span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line"><span class="comment">// ä»¥æ–‡ä»¶çš„æ–¹å¼æ‰«ææ•´ä¸ªåŒ…ä¸‹çš„æ–‡ä»¶ å¹¶æ·»åŠ åˆ°é›†åˆä¸­</span></span><br><span class="line">findAndAddClassesInPackageByFile(packageName, filePath, recursive, classes);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> classes;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.ä»¥æ–‡ä»¶çš„å½¢å¼æ¥è·å–åŒ…ä¸‹çš„æ‰€æœ‰Class</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä»¥æ–‡ä»¶çš„å½¢å¼æ¥è·å–åŒ…ä¸‹çš„æ‰€æœ‰Class</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> packageName</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> packagePath</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> recursive</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> classes</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">findAndAddClassesInPackageByFile</span><span class="params">(String packageName, String packagePath, <span class="keyword">final</span> <span class="type">boolean</span> recursive,</span></span><br><span class="line"><span class="params">Set&lt;Class&lt;?&gt;&gt; classes)</span> &#123;</span><br><span class="line"><span class="comment">// è·å–æ­¤åŒ…çš„ç›®å½• å»ºç«‹ä¸€ä¸ªFile</span></span><br><span class="line"><span class="type">File</span> <span class="variable">dir</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(packagePath);</span><br><span class="line"><span class="comment">// å¦‚æœä¸å­˜åœ¨æˆ–è€… ä¹Ÿä¸æ˜¯ç›®å½•å°±ç›´æ¥è¿”å›</span></span><br><span class="line"><span class="keyword">if</span> (!dir.exists() || !dir.isDirectory()) &#123;</span><br><span class="line"><span class="comment">// log.warn(&quot;ç”¨æˆ·å®šä¹‰åŒ…å &quot; + packageName + &quot; ä¸‹æ²¡æœ‰ä»»ä½•æ–‡ä»¶&quot;);</span></span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å¦‚æœå­˜åœ¨ å°±è·å–åŒ…ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ åŒ…æ‹¬ç›®å½•</span></span><br><span class="line">File[] dirfiles = dir.listFiles(<span class="keyword">new</span> <span class="title class_">FileFilter</span>() &#123;</span><br><span class="line"><span class="comment">// è‡ªå®šä¹‰è¿‡æ»¤è§„åˆ™ å¦‚æœå¯ä»¥å¾ªç¯(åŒ…å«å­ç›®å½•) æˆ–åˆ™æ˜¯ä»¥.classç»“å°¾çš„æ–‡ä»¶(ç¼–è¯‘å¥½çš„javaç±»æ–‡ä»¶)</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">accept</span><span class="params">(File file)</span> &#123;</span><br><span class="line"><span class="keyword">return</span> (recursive &amp;&amp; file.isDirectory()) || (file.getName().endsWith(<span class="string">&quot;.class&quot;</span>));</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// å¾ªç¯æ‰€æœ‰æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">for</span> (File file : dirfiles) &#123;</span><br><span class="line"><span class="comment">// å¦‚æœæ˜¯ç›®å½• åˆ™ç»§ç»­æ‰«æ</span></span><br><span class="line"><span class="keyword">if</span> (file.isDirectory()) &#123;</span><br><span class="line">findAndAddClassesInPackageByFile(packageName + <span class="string">&quot;.&quot;</span> + file.getName(), file.getAbsolutePath(), recursive,</span><br><span class="line">classes);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">// å¦‚æœæ˜¯javaç±»æ–‡ä»¶ å»æ‰åé¢çš„.class åªç•™ä¸‹ç±»å</span></span><br><span class="line"><span class="type">String</span> <span class="variable">className</span> <span class="operator">=</span> file.getName().substring(<span class="number">0</span>, file.getName().length() - <span class="number">6</span>);</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"><span class="comment">// æ·»åŠ åˆ°é›†åˆä¸­å»</span></span><br><span class="line"><span class="comment">// classes.add(Class.forName(packageName + &#x27;.&#x27; +</span></span><br><span class="line"><span class="comment">// className));</span></span><br><span class="line"><span class="comment">// ç»è¿‡å›å¤åŒå­¦çš„æé†’ï¼Œè¿™é‡Œç”¨forNameæœ‰ä¸€äº›ä¸å¥½ï¼Œä¼šè§¦å‘staticæ–¹æ³•ï¼Œæ²¡æœ‰ä½¿ç”¨classLoaderçš„loadå¹²å‡€</span></span><br><span class="line">classes.add(</span><br><span class="line">Thread.currentThread().getContextClassLoader().loadClass(packageName + <span class="string">&#x27;.&#x27;</span> + className));</span><br><span class="line">&#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line"><span class="comment">// log.error(&quot;æ·»åŠ ç”¨æˆ·è‡ªå®šä¹‰è§†å›¾ç±»é”™è¯¯ æ‰¾ä¸åˆ°æ­¤ç±»çš„.classæ–‡ä»¶&quot;);</span></span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;ä¸€-æ³¨è§£ä»‹ç»&quot;&gt;&lt;a href=&quot;#ä¸€-æ³¨è§£ä»‹ç»&quot; class=&quot;headerlink&quot; title=&quot;ä¸€. æ³¨è§£ä»‹ç»&quot;&gt;&lt;/a&gt;ä¸€. æ³¨è§£ä»‹ç»&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;æ³¨è§£Annotationæ˜¯ä¸€ç§å¼•ç”¨æ•°æ®ç±»å‹ï¼Œç¼–è¯‘ä¹‹åä¹Ÿæ˜¯ç”Ÿæˆ.classç±»å‹çš„java</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>æ­£åˆ™è¡¨è¾¾å¼</title>
    <link href="https://www.fomal.cc/posts/46563.html"/>
    <id>https://www.fomal.cc/posts/46563.html</id>
    <published>2025-05-20T08:38:30.655Z</published>
    <updated>2022-07-20T03:06:31.523Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ä¸€-ç®€ä»‹-happy"><a href="#ä¸€-ç®€ä»‹-happy" class="headerlink" title="ä¸€. ç®€ä»‹:happy:"></a>ä¸€. ç®€ä»‹:happy:</h3><ol><li><p>? é€šé…ç¬¦åŒ¹é…æ–‡ä»¶åä¸­çš„ 0 ä¸ªæˆ– 1 ä¸ªå­—ç¬¦ï¼Œè€Œ * é€šé…ç¬¦åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ã€‚</p></li><li><p>æ­£åˆ™è¡¨è¾¾å¼åœ¨çº¿æµ‹è¯•å·¥å…·ï¼š(<a href="https://c.runoob.com/front-end/854/">https://c.runoob.com/front-end/854/</a>)</p></li><li><p>ä¾‹å­ï¼šåƒ <code>data(\w)?\.dat</code> è¿™æ ·çš„æ¨¡å¼å°†æŸ¥æ‰¾ä¸‹åˆ—æ–‡ä»¶ï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data.dat</span><br><span class="line">data1.dat</span><br><span class="line">data2.dat</span><br><span class="line">datax.dat</span><br><span class="line">dataN.dat</span><br></pre></td></tr></table></figure></li><li><p><img src="https://raw.githubusercontent.com/lqs-blog/picgo/main/img/20220715155152.png" alt="image-20220715155152077"></p><ul><li><code>^</code> ä¸ºåŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„å¼€å§‹ä½ç½®ã€‚</li><li><code>[0-9]+</code>åŒ¹é…å¤šä¸ªæ•°å­—ï¼Œ <code>[0-9]</code> åŒ¹é…å•ä¸ªæ•°å­—ï¼Œ<code>+</code> åŒ¹é…ä¸€ä¸ªæˆ–è€…å¤šä¸ªã€‚</li><li><code>abc$</code>åŒ¹é…å­—æ¯ <code>abc</code> å¹¶ä»¥ <code>abc</code> ç»“å°¾ï¼Œ<code>$</code> ä¸ºåŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„ç»“æŸä½ç½®ã€‚</li></ul></li><li><p>ä¾‹å­â‘ ï¼šæˆ‘ä»¬åœ¨å†™ç”¨æˆ·æ³¨å†Œè¡¨å•æ—¶ï¼Œåªå…è®¸ç”¨æˆ·ååŒ…å«å­—ç¬¦ã€æ•°å­—ã€ä¸‹åˆ’çº¿å’Œè¿æ¥å­—ç¬¦ -ï¼Œå¹¶è®¾ç½®ç”¨æˆ·åçš„é•¿åº¦ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ­£åˆ™è¡¨è¾¾å¼æ¥è®¾å®šã€‚ï¼ˆ<code>^[a-z0-9_-]&#123;3,20&#125;$</code>ï¼‰</p><p><img src="https://raw.githubusercontent.com/lqs-blog/picgo/main/img/20220715160155.png" alt="image-20220715160155236" style="zoom: 50%;" /></p></li><li><p>ä¾‹å­â‘¡</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;123abc&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> patt1 = <span class="regexp">/^[0-9]+abc$/</span>;</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(str.<span class="title function_">match</span>(patt1));</span><br></pre></td></tr></table></figure><p>åŒ¹é…ç»“æœæ˜¯ï¼š<code>123.abc</code></p></li></ol><h3 id="äºŒ-è¯­æ³•"><a href="#äºŒ-è¯­æ³•" class="headerlink" title="äºŒ. è¯­æ³•"></a>äºŒ. è¯­æ³•</h3><ol><li><p>æ­£åˆ™è¡¨è¾¾å¼(regular expression)æè¿°äº†ä¸€ç§å­—ç¬¦ä¸²åŒ¹é…çš„æ¨¡å¼ï¼ˆpatternï¼‰ï¼Œå¯ä»¥ç”¨æ¥æ£€æŸ¥ä¸€ä¸ªä¸²æ˜¯å¦å«æœ‰æŸç§å­ä¸²ã€å°†åŒ¹é…çš„å­ä¸²æ›¿æ¢æˆ–è€…ä»æŸä¸ªä¸²ä¸­å–å‡ºç¬¦åˆæŸä¸ªæ¡ä»¶çš„å­ä¸²ç­‰ã€‚</p></li><li><p><code>runoo+b</code>ï¼Œå¯ä»¥åŒ¹é… <strong><code>runoob</code>ã€<code>runooob</code>ã€<code>runoooooob</code></strong> ç­‰ï¼Œ+ å·ä»£è¡¨å‰é¢çš„å­—ç¬¦å¿…é¡»è‡³å°‘å‡ºç°ä¸€æ¬¡ï¼ˆ1æ¬¡æˆ–å¤šæ¬¡ï¼‰ã€‚</p></li><li><p><code>runoo*b</code>ï¼Œå¯ä»¥åŒ¹é… <strong><code>runob</code>ã€<code>runoob</code>ã€<code>runoooooob</code></strong> ç­‰ï¼Œ* å·ä»£è¡¨å‰é¢çš„å­—ç¬¦å¯ä»¥ä¸å‡ºç°ï¼Œä¹Ÿå¯ä»¥å‡ºç°ä¸€æ¬¡æˆ–è€…å¤šæ¬¡ï¼ˆ0æ¬¡ã€æˆ–1æ¬¡ã€æˆ–å¤šæ¬¡ï¼‰ã€‚</p></li><li><p><code>colou?r</code> å¯ä»¥åŒ¹é… <strong><code>color</code></strong> æˆ–è€… <strong><code>colour</code></strong>ï¼Œ? é—®å·ä»£è¡¨å‰é¢çš„å­—ç¬¦æœ€å¤šåªå¯ä»¥å‡ºç°ä¸€æ¬¡ï¼ˆ0æ¬¡æˆ–1æ¬¡ï¼‰ã€‚</p></li><li><h4 id="æ™®é€šå­—ç¬¦"><a href="#æ™®é€šå­—ç¬¦" class="headerlink" title="æ™®é€šå­—ç¬¦"></a>æ™®é€šå­—ç¬¦</h4><ul><li><p><code>[ABC]</code>: åŒ¹é… [â€¦] ä¸­çš„æ‰€æœ‰å­—ç¬¦ï¼Œä¾‹å¦‚ <code>[aeiou]</code> åŒ¹é…å­—ç¬¦ä¸² â€œ<code>google runoob taobao</code>â€œ ä¸­æ‰€æœ‰çš„ e o u a å­—æ¯ã€‚</p></li><li><p><code>[^ABC]</code>: åŒ¹é…é™¤äº† [â€¦] ä¸­å­—ç¬¦çš„æ‰€æœ‰å­—ç¬¦ï¼Œä¾‹å¦‚<code>[^aeiou]</code>åŒ¹é…å­—ç¬¦ä¸² â€œ<code>google runoob taobao</code>â€œ ä¸­é™¤äº† e o u a å­—æ¯çš„æ‰€æœ‰å­—æ¯ã€‚</p></li><li><p><code>[A-Z]</code>: <code>[A-Z]</code> è¡¨ç¤ºä¸€ä¸ªåŒºé—´ï¼ŒåŒ¹é…æ‰€æœ‰å¤§å†™å­—æ¯ï¼Œ[a-z] è¡¨ç¤ºæ‰€æœ‰å°å†™å­—æ¯ã€‚</p></li><li><p><code>.</code>: åŒ¹é…é™¤æ¢è¡Œç¬¦ï¼ˆ\nã€\rï¼‰ä¹‹å¤–çš„ä»»ä½•å•ä¸ªå­—ç¬¦ï¼Œç›¸ç­‰äº <code>[^\n\r]</code>ã€‚</p></li><li><p><code>[\s\S]</code>: åŒ¹é…æ‰€æœ‰ã€‚\s æ˜¯åŒ¹é…æ‰€æœ‰ç©ºç™½ç¬¦ï¼ŒåŒ…æ‹¬æ¢è¡Œï¼Œ\S éç©ºç™½ç¬¦ï¼Œä¸åŒ…æ‹¬æ¢è¡Œã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;google runoob taobao\nRUnoob\ntaobao&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> patt1 = <span class="regexp">/[\s\S]/g</span>;</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(str.<span class="title function_">match</span>(patt1));</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š<code>g,o,o,g,l,e, ,r,u,n,o,o,b, ,t,a,o,b,a,o, ,R,U,n,o,o,b, ,t,a,o,b,a,o</code></p></li><li><p><code>[\w]</code>: åŒ¹é…å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ã€‚ç­‰ä»·äº <code>[A-Za-z0-9_]</code> </p></li></ul></li><li><h4 id="ç‰¹æ®Šå­—ç¬¦"><a href="#ç‰¹æ®Šå­—ç¬¦" class="headerlink" title="ç‰¹æ®Šå­—ç¬¦"></a>ç‰¹æ®Šå­—ç¬¦</h4><ul><li>æ‰€è°“ç‰¹æ®Šå­—ç¬¦ï¼Œå°±æ˜¯ä¸€äº›æœ‰ç‰¹æ®Šå«ä¹‰çš„å­—ç¬¦ï¼Œå¦‚ä¸Šé¢è¯´çš„ <code>runoo*b</code> ä¸­çš„ <em>ï¼Œç®€å•çš„è¯´å°±æ˜¯è¡¨ç¤ºä»»ä½•å­—ç¬¦ä¸²çš„æ„æ€ã€‚å¦‚æœè¦æŸ¥æ‰¾å­—ç¬¦ä¸²ä¸­çš„ </em> ç¬¦å·ï¼Œåˆ™éœ€è¦å¯¹ <em> è¿›è¡Œè½¬ä¹‰ï¼Œå³åœ¨å…¶å‰åŠ ä¸€ä¸ª \ï¼Œ`runo\</em>ob<code>åŒ¹é…å­—ç¬¦ä¸² **</code>runo*ob`**ã€‚</li></ul></li><li><h4 id="é™å®šç¬¦"><a href="#é™å®šç¬¦" class="headerlink" title="é™å®šç¬¦"></a>é™å®šç¬¦</h4><p>| <em>     | åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–å¤šæ¬¡ã€‚ä¾‹å¦‚ï¼Œ`zo</em><code>èƒ½åŒ¹é… &quot;z&quot; ä»¥åŠ &quot;zoo&quot;ã€‚* ç­‰ä»·äº&#123;0,&#125;ã€‚ || ----- | :----------------------------------------------------------: || +     | åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼ä¸€æ¬¡æˆ–å¤šæ¬¡ã€‚ä¾‹å¦‚ï¼Œ</code>â€˜zo+â€™<code>èƒ½åŒ¹é…</code>â€œzo<code>&quot; ä»¥åŠ</code>â€œzooâ€<code>ï¼Œä½†ä¸èƒ½åŒ¹é… &quot;z&quot;ã€‚+ ç­‰ä»·äº &#123;1,&#125;ã€‚ || ?     | åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–ä¸€æ¬¡ã€‚ä¾‹å¦‚ï¼Œ&quot;do(es)?&quot; å¯ä»¥åŒ¹é… &quot;do&quot; ã€ &quot;does&quot; ä¸­çš„ &quot;does&quot; ã€ &quot;</code>doxy<code>&quot; ä¸­çš„ &quot;do&quot; ã€‚? ç­‰ä»·äº &#123;0,1&#125;ã€‚ || &#123;n&#125;   | n æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ã€‚åŒ¹é…ç¡®å®šçš„ n æ¬¡ã€‚ä¾‹å¦‚ï¼Œ&#39;o&#123;2&#125;&#39; ä¸èƒ½åŒ¹é… &quot;Bob&quot; ä¸­çš„ &#39;o&#39;ï¼Œä½†æ˜¯èƒ½åŒ¹é… &quot;food&quot; ä¸­çš„ä¸¤ä¸ª oã€‚ || &#123;n,&#125;  | n æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ã€‚è‡³å°‘åŒ¹é…n æ¬¡ã€‚ä¾‹å¦‚ï¼Œ&#39;o&#123;2,&#125;&#39; ä¸èƒ½åŒ¹é… &quot;Bob&quot; ä¸­çš„ &#39;o&#39;ï¼Œä½†èƒ½åŒ¹é… &quot;</code>foooood<code>&quot; ä¸­çš„æ‰€æœ‰ oã€‚&#39;o&#123;1,&#125;&#39; ç­‰ä»·äº &#39;o+&#39;ã€‚&#39;o&#123;0,&#125;&#39; åˆ™ç­‰ä»·äº &#39;o*&#39;ã€‚ || &#123;n,m&#125; | m å’Œ n å‡ä¸ºéè´Ÿæ•´æ•°ï¼Œå…¶ä¸­n &lt;= mã€‚æœ€å°‘åŒ¹é… n æ¬¡ä¸”æœ€å¤šåŒ¹é… m æ¬¡ã€‚ä¾‹å¦‚ï¼Œ&quot;o&#123;1,3&#125;&quot; å°†åŒ¹é… &quot;</code>fooooood`â€ ä¸­çš„å‰ä¸‰ä¸ª oã€‚â€™o{0,1}â€™ ç­‰ä»·äº â€˜o?â€™ã€‚è¯·æ³¨æ„åœ¨é€—å·å’Œä¸¤ä¸ªæ•°ä¹‹é—´ä¸èƒ½æœ‰ç©ºæ ¼ã€‚ |</p></li></ol><p><code>*</code>å’Œ <code>+</code> é™å®šç¬¦éƒ½æ˜¯è´ªå©ªçš„ï¼Œå› ä¸ºå®ƒä»¬ä¼šå°½å¯èƒ½å¤šçš„åŒ¹é…æ–‡å­—ï¼Œåªæœ‰åœ¨å®ƒä»¬çš„åé¢åŠ ä¸Šä¸€ä¸ª <code>?</code> å°±å¯ä»¥å®ç°éè´ªå©ªæˆ–æœ€å°åŒ¹é….</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>RUNOOB-èœé¸Ÿæ•™ç¨‹<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><strong>è´ªå©ª</strong>ï¼š<code>/&lt;.*&gt;/</code>===&gt;&gt;&gt;åŒ¹é…æ‰€æœ‰å†…å®¹<code>&lt;h1&gt;RUNOOB-èœé¸Ÿæ•™ç¨‹&lt;/h1&gt;</code></li><li><strong>éè´ªå©ª</strong>ï¼š<code>/&lt;.*?&gt;/</code>===&gt;&gt;&gt;<code>&lt;h1&gt;</code>æˆ–è€…<code>/&lt;\w+?&gt;/</code>===&gt;&gt;&gt;<code>&lt;h1&gt;</code></li><li>é€šè¿‡åœ¨ *ã€+ æˆ– ? é™å®šç¬¦ä¹‹åæ”¾ç½® ?ï¼Œè¯¥è¡¨è¾¾å¼ä»â€è´ªå©ªâ€è¡¨è¾¾å¼è½¬æ¢ä¸ºâ€éè´ªå©ªâ€è¡¨è¾¾å¼æˆ–è€…æœ€å°åŒ¹é…ã€‚</li></ul><ol><li><strong>å®šä½ç¬¦</strong></li></ol><ul><li>å®šä½ç¬¦ç”¨æ¥æè¿°å­—ç¬¦ä¸²æˆ–å•è¯çš„è¾¹ç•Œï¼Œ^ å’Œ $ åˆ†åˆ«æŒ‡å­—ç¬¦ä¸²çš„å¼€å§‹ä¸ç»“æŸï¼Œ\b æè¿°å•è¯çš„å‰æˆ–åè¾¹ç•Œï¼Œ\B è¡¨ç¤ºéå•è¯è¾¹ç•Œã€‚</li><li>ä¸‹é¢çš„è¡¨è¾¾å¼åŒ¹é…å•è¯ Chapter çš„å¼€å¤´ä¸‰ä¸ªå­—ç¬¦ï¼Œå› ä¸ºè¿™ä¸‰ä¸ªå­—ç¬¦å‡ºç°åœ¨å•è¯è¾¹ç•Œåé¢ï¼š<code>/\bCha/</code></li><li>ä¸‹é¢çš„è¡¨è¾¾å¼åŒ¹é…å•è¯ Chapter ä¸­çš„å­—ç¬¦ä¸² <code>ter</code>ï¼Œå› ä¸ºå®ƒå‡ºç°åœ¨å•è¯è¾¹ç•Œçš„å‰é¢ï¼š<code>/ter\b/</code></li><li>ä¸‹é¢çš„è¡¨è¾¾å¼åŒ¹é… Chapter ä¸­çš„å­—ç¬¦ä¸² aptï¼Œä½†ä¸åŒ¹é… aptitude ä¸­çš„å­—ç¬¦ä¸² aptï¼š<code>\Bapt</code></li><li>ä¸åŒ¹é… Chapter ä¸­çš„ <code>Cha</code>ï¼š<code>/\Bcha/</code></li></ul><ol><li><p><strong>ä¾‹å­</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;https://www.runoob.com:80/html/html-tutorial.html&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> patt1 = <span class="regexp">/(\w+):\/\/([^/:]+)(:\d*)?([^# ]*)/</span>;</span><br><span class="line">arr = str.<span class="title function_">match</span>(patt1);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.<span class="property">length</span> ; i++) &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">write</span>(arr[i]);</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&quot;&lt;br&gt;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç¬¬ä¸‰è¡Œä»£ç  <code>str.match(patt1)</code> è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œå®ä¾‹ä¸­çš„æ•°ç»„åŒ…å« 5 ä¸ªå…ƒç´ ï¼Œç´¢å¼• 0 å¯¹åº”çš„æ˜¯æ•´ä¸ªå­—ç¬¦ä¸²ï¼Œç´¢å¼• 1 å¯¹åº”ç¬¬ä¸€ä¸ªåŒ¹é…ç¬¦ï¼ˆæ‹¬å·å†…ï¼‰ï¼Œä»¥æ­¤ç±»æ¨ã€‚</li><li>ç¬¬ä¸€ä¸ªæ‹¬å·å­è¡¨è¾¾å¼åŒ…å« <strong><code>https</code></strong> </li><li>ç¬¬äºŒä¸ªæ‹¬å·å­è¡¨è¾¾å¼åŒ…å« <strong><code>www.runoob.com</code></strong></li><li>ç¬¬ä¸‰ä¸ªæ‹¬å·å­è¡¨è¾¾å¼åŒ…å« <strong>:80</strong> </li><li>ç¬¬å››ä¸ªæ‹¬å·å­è¡¨è¾¾å¼åŒ…å« <strong><code>/html/html-tutorial.html</code></strong></li></ul></li></ol><h3 id="ä¸‰-ä¿®é¥°ç¬¦-pattern-flags"><a href="#ä¸‰-ä¿®é¥°ç¬¦-pattern-flags" class="headerlink" title="ä¸‰. ä¿®é¥°ç¬¦ /pattern/flags"></a>ä¸‰. ä¿®é¥°ç¬¦ <code>/pattern/flags</code></h3><div class="table-container"><table><thead><tr><th>i</th><th>ignore - ä¸åŒºåˆ†å¤§å°å†™</th><th style="text-align:left">å°†åŒ¹é…è®¾ç½®ä¸ºä¸åŒºåˆ†å¤§å°å†™ï¼Œæœç´¢æ—¶ä¸åŒºåˆ†å¤§å°å†™: A å’Œ a æ²¡æœ‰åŒºåˆ«ã€‚</th></tr></thead><tbody><tr><td>g</td><td>global - å…¨å±€åŒ¹é…</td><td style="text-align:left">æŸ¥æ‰¾æ‰€æœ‰çš„åŒ¹é…é¡¹ã€‚</td></tr><tr><td>m</td><td>multi line - å¤šè¡ŒåŒ¹é…</td><td style="text-align:left">ä½¿è¾¹ç•Œå­—ç¬¦ ^ å’Œ $ åŒ¹é…æ¯ä¸€è¡Œçš„å¼€å¤´å’Œç»“å°¾ï¼Œè®°ä½æ˜¯å¤šè¡Œï¼Œè€Œä¸æ˜¯æ•´ä¸ªå­—ç¬¦ä¸²çš„å¼€å¤´å’Œç»“å°¾ã€‚</td></tr><tr><td>s</td><td>ç‰¹æ®Šå­—ç¬¦åœ†ç‚¹ . ä¸­åŒ…å«æ¢è¡Œç¬¦ \n</td><td style="text-align:left">é»˜è®¤æƒ…å†µä¸‹çš„åœ†ç‚¹ . æ˜¯åŒ¹é…é™¤æ¢è¡Œç¬¦ \n ä¹‹å¤–çš„ä»»ä½•å­—ç¬¦ï¼ŒåŠ ä¸Š s ä¿®é¥°ç¬¦ä¹‹å, . ä¸­åŒ…å«æ¢è¡Œç¬¦ \nã€‚</td></tr></tbody></table></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str=<span class="string">&quot;Google runoob taobao runoob&quot;</span>; </span><br><span class="line"><span class="keyword">var</span> n1=str.<span class="title function_">match</span>(<span class="regexp">/runoob/</span>);   <span class="comment">// æŸ¥æ‰¾ç¬¬ä¸€æ¬¡åŒ¹é…é¡¹ runoob</span></span><br><span class="line"><span class="keyword">var</span> n2=str.<span class="title function_">match</span>(<span class="regexp">/runoob/g</span>);  <span class="comment">// æŸ¥æ‰¾æ‰€æœ‰åŒ¹é…é¡¹ runoob,runoob</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str=<span class="string">&quot;Google runoob taobao RUNoob&quot;</span>; </span><br><span class="line"><span class="keyword">var</span> n1=str.<span class="title function_">match</span>(<span class="regexp">/runoob/g</span>);   <span class="comment">// åŒºåˆ†å¤§å°å†™ runoob</span></span><br><span class="line"><span class="keyword">var</span> n2=str.<span class="title function_">match</span>(<span class="regexp">/runoob/gi</span>);  <span class="comment">// ä¸åŒºåˆ†å¤§å°å†™ runoob,RUNoob</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str=<span class="string">&quot;runoobgoogle\ntaobao\nrunoobweibo&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> n1=str.<span class="title function_">match</span>(<span class="regexp">/^runoob/g</span>);   <span class="comment">// åŒ¹é…ä¸€ä¸ª runoob</span></span><br><span class="line"><span class="keyword">var</span> n2=str.<span class="title function_">match</span>(<span class="regexp">/^runoob/gm</span>);  <span class="comment">// å¤šè¡ŒåŒ¹é… runoob,runoob</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str=<span class="string">&quot;google\nrunoob\ntaobao&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> n1=str.<span class="title function_">match</span>(<span class="regexp">/google./</span>);   <span class="comment">// æ²¡æœ‰ä½¿ç”¨ sï¼Œæ— æ³•åŒ¹é…\n. </span></span><br><span class="line"><span class="keyword">var</span> n2=str.<span class="title function_">match</span>(<span class="regexp">/runoob./</span>s);  <span class="comment">// ä½¿ç”¨ sï¼ŒåŒ¹é…\n. runoob</span></span><br></pre></td></tr></table></figure><p><strong>åŒ¹é…é‚®ç®±</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;abcd 112306@qq.com 1234&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> patt1 = <span class="regexp">/\b[\w.%+-]+@[\w.-]+\.[a-zA-Z]&#123;2,6&#125;\b/g</span>;</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(str.<span class="title function_">match</span>(patt1)); <span class="comment">//112306@qq.com</span></span><br></pre></td></tr></table></figure><h3 id="å››-å®ä¾‹"><a href="#å››-å®ä¾‹" class="headerlink" title="å››. å®ä¾‹"></a>å››. å®ä¾‹</h3><p>ONE:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;abc123-_def&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> patt = <span class="regexp">/[a-zA-Z0-9_-]+/</span>;</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(str.<span class="title function_">match</span>(patt));<span class="comment">//abc123-_def</span></span><br></pre></td></tr></table></figure><p>TWO:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;abc123def&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> str2 = <span class="string">&quot;abc123_def&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> patt = <span class="regexp">/[a-zA-Z0-9_]+/</span>;</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(str.<span class="title function_">match</span>(patt));<span class="comment">//abc123def</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(str2.<span class="title function_">match</span>(patt));<span class="comment">//abc123_def</span></span><br></pre></td></tr></table></figure><p>THREE: åŒ¹é…æ‰€æœ‰ <code>img</code> æ ‡ç­¾ï¼š</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span><span class="operator">&lt;</span>img.<span class="operator">*</span><span class="operator">?</span>src<span class="operator">=</span><span class="string">&quot;(.*?)&quot;</span>.<span class="operator">*</span><span class="operator">?</span><span class="punctuation">\</span><span class="operator">/</span><span class="operator">?</span><span class="operator">&gt;</span><span class="operator">/</span>gi</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/lqs-blog/picgo/main/img/20220715194304.jpg" alt="2" style="zoom:50%;" /></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;ä¸€-ç®€ä»‹-happy&quot;&gt;&lt;a href=&quot;#ä¸€-ç®€ä»‹-happy&quot; class=&quot;headerlink&quot; title=&quot;ä¸€. ç®€ä»‹:happy:&quot;&gt;&lt;/a&gt;ä¸€. ç®€ä»‹:happy:&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;? é€šé…ç¬¦åŒ¹é…æ–‡ä»¶åä¸­çš„ 0 ä¸ªæˆ– 1 ä¸ªå­—ç¬¦ï¼Œè€Œ</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>æ€ä¹ˆå®ç°å¯¹ç™»å½•ç”¨æˆ·è®¿é—®æƒé™çš„æ‹¦æˆª</title>
    <link href="https://www.fomal.cc/posts/9a421b.html"/>
    <id>https://www.fomal.cc/posts/9a421b.html</id>
    <published>2025-05-20T08:38:30.651Z</published>
    <updated>2022-09-23T07:06:57.350Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ä¸€-è‡ªå®šä¹‰æƒé™æ³¨è§£"><a href="#ä¸€-è‡ªå®šä¹‰æƒé™æ³¨è§£" class="headerlink" title="ä¸€.  è‡ªå®šä¹‰æƒé™æ³¨è§£"></a>ä¸€.  è‡ªå®šä¹‰æƒé™æ³¨è§£</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> io.coderyeah.basic.annotation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è‡ªå®šä¹‰æ³¨è§£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Target(&#123;ElementType.METHOD, ElementType.TYPE&#125;)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> PreAuthorize &#123;</span><br><span class="line">    String <span class="title function_">name</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    String <span class="title function_">sn</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="äºŒ-åœ¨æ¥å£æ–¹æ³•ä¸Šä½¿ç”¨æ³¨è§£"><a href="#äºŒ-åœ¨æ¥å£æ–¹æ³•ä¸Šä½¿ç”¨æ³¨è§£" class="headerlink" title="äºŒ. åœ¨æ¥å£æ–¹æ³•ä¸Šä½¿ç”¨æ³¨è§£"></a>äºŒ. åœ¨æ¥å£æ–¹æ³•ä¸Šä½¿ç”¨æ³¨è§£</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> deptDTO éƒ¨é—¨æŸ¥è¯¢å‚æ•°</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> Result</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PreAuthorize(name = &quot;éƒ¨é—¨åˆ—è¡¨&quot;, sn = &quot;department:list&quot;)</span></span><br><span class="line"><span class="meta">@LogAnnotation(module = &quot;éƒ¨é—¨æ¨¡å—&quot;, operate = &quot;åˆ†é¡µæŸ¥è¯¢éƒ¨é—¨åˆ—è¡¨&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;æŸ¥è¯¢éƒ¨é—¨åˆ—è¡¨&quot;)</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/list&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">list</span><span class="params">(<span class="meta">@RequestBody(required = false)</span> DeptDTO deptDTO)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> departmentService.list(deptDTO);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¸‰-ç™»å½•æ‹¦æˆªå™¨"><a href="#ä¸‰-ç™»å½•æ‹¦æˆªå™¨" class="headerlink" title="ä¸‰. ç™»å½•æ‹¦æˆªå™¨"></a>ä¸‰. ç™»å½•æ‹¦æˆªå™¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> io.coderyeah.basic.interceptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> io.coderyeah.basic.annotation.PreAuthorize;</span><br><span class="line"><span class="keyword">import</span> io.coderyeah.basic.constant.Constants;</span><br><span class="line"><span class="keyword">import</span> io.coderyeah.org.mapper.EmployeeMapper;</span><br><span class="line"><span class="keyword">import</span> io.coderyeah.user.domain.LoginInfo;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.StringRedisTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.method.HandlerMethod;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> StringRedisTemplate stringRedisTemplate;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> EmployeeMapper employeeMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest req, HttpServletResponse resp, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// é™æ€èµ„æºæ”¾è¡Œ</span></span><br><span class="line">        <span class="keyword">if</span> (!(handler <span class="keyword">instanceof</span> HandlerMethod)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1.è·å–token</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> req.getHeader(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">        <span class="comment">//3.å¦‚æœæœ‰tokenï¼Œé€šè¿‡tokenè·å–redisçš„ç™»å½•ä¿¡æ¯</span></span><br><span class="line">        <span class="keyword">if</span> (token != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">loginInfo</span> <span class="operator">=</span> stringRedisTemplate.opsForValue().get(Constants.LOGIN_TOKEN + token); <span class="comment">// LoginInfoå¯¹è±¡</span></span><br><span class="line">            <span class="keyword">if</span> (loginInfo != <span class="literal">null</span>) &#123;<span class="comment">//ç™»å½•æˆåŠŸï¼Œè€Œä¸”æ²¡æœ‰è¿‡æœŸ</span></span><br><span class="line">                <span class="comment">//5.å¦‚æœç™»å½•ä¿¡æ¯ä¸ä¸ºnull - æ”¾è¡Œ + åˆ·æ–°è¿‡æœŸæ—¶é—´[é‡æ–°æ·»åŠ åˆ°redis]</span></span><br><span class="line">                stringRedisTemplate.opsForValue().set(Constants.LOGIN_TOKEN + token, loginInfo, <span class="number">30</span>, TimeUnit.MINUTES);</span><br><span class="line">                <span class="keyword">final</span> <span class="type">LoginInfo</span> <span class="variable">info</span> <span class="operator">=</span> JSON.parseObject(loginInfo, LoginInfo.class);</span><br><span class="line">                <span class="keyword">if</span> (info.getType() == <span class="number">1</span>) &#123;</span><br><span class="line">                    <span class="comment">// å‰ç«¯ç”¨æˆ·ç›´æ¥æ”¾è¡Œ</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// åç«¯ç®¡ç†å‘˜ éœ€è¦åˆ¤æ–­æƒé™</span></span><br><span class="line">                <span class="keyword">final</span> <span class="type">HandlerMethod</span> <span class="variable">handlerMethod</span> <span class="operator">=</span> (HandlerMethod) handler;</span><br><span class="line">                <span class="comment">// è·å–è®¿é—®çš„æ–¹æ³•ä¸Šçš„æƒé™æ³¨è§£</span></span><br><span class="line">                <span class="keyword">final</span> <span class="type">PreAuthorize</span> <span class="variable">p</span> <span class="operator">=</span> handlerMethod.getMethodAnnotation(PreAuthorize.class);</span><br><span class="line">                <span class="keyword">if</span> (<span class="literal">null</span> == p) &#123;</span><br><span class="line">                    <span class="comment">// æ­¤æ–¹æ³•ä¸Šæ²¡æœ‰è¯¥æ³¨è§£ç›´æ¥æ”¾è¡Œ å…¬ç”¨èµ„æº</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// éœ€è¦åˆ¤æ–­è¯¥ç™»å½•ç”¨æˆ·æ˜¯å¦å…·å¤‡æ­¤æ¥å£çš„æ“ä½œæƒé™</span></span><br><span class="line">                <span class="keyword">final</span> <span class="type">String</span> <span class="variable">sn</span> <span class="operator">=</span> p.sn();</span><br><span class="line">                <span class="comment">// æŸ¥è¯¢è¯¥ç™»å½•ç”¨æˆ·çš„æ‰€æœ‰æƒé™é›†åˆ</span></span><br><span class="line">                List&lt;String&gt; ownPermissions = employeeMapper.getPermissionSnByLoginInfoId(info.getId());</span><br><span class="line">                <span class="keyword">if</span> (ownPermissions.contains(sn)) &#123;</span><br><span class="line">                    <span class="comment">// åŒ…å«è¯¥æƒé™</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// æ²¡æœ‰æƒé™è¿”å›jsonä¿¡æ¯ç»™å®¢æˆ·ç«¯</span></span><br><span class="line">                resp.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">                resp.setContentType(<span class="string">&quot;application/json;charset=utf-8&quot;</span>);</span><br><span class="line">                <span class="keyword">final</span> <span class="type">PrintWriter</span> <span class="variable">writer</span> <span class="operator">=</span> resp.getWriter();</span><br><span class="line">                writer.print(<span class="string">&quot;&#123;\&quot;success\&quot;:false,\&quot;message\&quot;:\&quot;noPermission\&quot;&#125;&quot;</span>);</span><br><span class="line">                writer.close();</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        resp.setContentType(<span class="string">&quot;application/json;charset=UTF-8&quot;</span>);</span><br><span class="line">        resp.getWriter().println(<span class="string">&quot;&#123;\&quot;success\&quot;:false,\&quot;message\&quot;:\&quot;noLogin\&quot;&#125;&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å››-æŸ¥è¯¢å½“å‰ç™»å½•ç”¨æˆ·çš„æ‰€æœ‰æƒé™æ¶‰åŠåˆ°å¤šå¼ è¡¨"><a href="#å››-æŸ¥è¯¢å½“å‰ç™»å½•ç”¨æˆ·çš„æ‰€æœ‰æƒé™æ¶‰åŠåˆ°å¤šå¼ è¡¨" class="headerlink" title="å››. æŸ¥è¯¢å½“å‰ç™»å½•ç”¨æˆ·çš„æ‰€æœ‰æƒé™æ¶‰åŠåˆ°å¤šå¼ è¡¨"></a>å››. æŸ¥è¯¢å½“å‰ç™»å½•ç”¨æˆ·çš„æ‰€æœ‰æƒé™æ¶‰åŠåˆ°å¤šå¼ è¡¨</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getPermissionSnByLoginInfoId&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;java.lang.String&quot;</span>&gt;</span></span><br><span class="line">    select tp.sn</span><br><span class="line">    from t_employee te</span><br><span class="line">             join t_employee_role ter on te.id = ter.employee_id</span><br><span class="line">             join t_role tr on ter.role_id = tr.id</span><br><span class="line">             join t_role_permission trp on tr.id = trp.role_id</span><br><span class="line">             join t_permission tp on tp.id = trp.permission_id</span><br><span class="line">    where te.logininfo_id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/lqs-blog/picgo/main/img/20220923112147.png" alt="ç½‘ç»œä¼ è¾“æ•°æ®å®‰å…¨"></p><h3 id="äº”-å‰ç«¯åç½®æ‹¦æˆªå™¨å¤„ç†"><a href="#äº”-å‰ç«¯åç½®æ‹¦æˆªå™¨å¤„ç†" class="headerlink" title="äº”. å‰ç«¯åç½®æ‹¦æˆªå™¨å¤„ç†"></a>äº”. å‰ç«¯åç½®æ‹¦æˆªå™¨å¤„ç†</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//======================axiosçš„åç½®æ‹¦æˆªå™¨ã€å¤„ç†åå°ç™»å½•æ‹¦æˆªçš„ç»“æœã€‘====================//</span></span><br><span class="line">axios.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//åç«¯å“åº”çš„æ˜¯æ²¡æœ‰ç™»å½•çš„ä¿¡æ¯</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">false</span> === res.<span class="property">data</span>.<span class="property">success</span> &amp;&amp; <span class="string">&quot;noLogin&quot;</span> === res.<span class="property">data</span>.<span class="property">message</span>) &#123;</span><br><span class="line">        <span class="variable language_">localStorage</span>.<span class="title function_">removeItem</span>(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">        <span class="variable language_">localStorage</span>.<span class="title function_">removeItem</span>(<span class="string">&quot;loginInfo&quot;</span>);</span><br><span class="line">        router.<span class="title function_">push</span>(&#123;<span class="attr">path</span>: <span class="string">&#x27;/login&#x27;</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">false</span> === res.<span class="property">data</span>.<span class="property">success</span> &amp;&amp; <span class="string">&quot;noPermission&quot;</span> === res.<span class="property">data</span>.<span class="property">message</span>) &#123;</span><br><span class="line">      <span class="title class_">Message</span>.<span class="title function_">info</span>(<span class="string">&#x27;æ‚¨æ²¡æœ‰è®¿é—®æƒé™&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;,<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//======================axiosçš„åç½®æ‹¦æˆªå™¨ã€å¤„ç†åå°ç™»å½•æ‹¦æˆªçš„ç»“æœã€‘====================//</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;ä¸€-è‡ªå®šä¹‰æƒé™æ³¨è§£&quot;&gt;&lt;a href=&quot;#ä¸€-è‡ªå®šä¹‰æƒé™æ³¨è§£&quot; class=&quot;headerlink&quot; title=&quot;ä¸€.  è‡ªå®šä¹‰æƒé™æ³¨è§£&quot;&gt;&lt;/a&gt;ä¸€.  è‡ªå®šä¹‰æƒé™æ³¨è§£&lt;/h3&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>åœ¨mavenä¸­ä½¿ç”¨RocketMQå‘å¸ƒæ¶ˆæ¯å’Œæ¶ˆè´¹æ¶ˆæ¯</title>
    <link href="https://www.fomal.cc/posts/75f7075c.html"/>
    <id>https://www.fomal.cc/posts/75f7075c.html</id>
    <published>2025-05-20T08:38:30.648Z</published>
    <updated>2022-11-03T02:57:45.546Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ä¸€-åˆ›å»ºmavené¡¹ç›®å¹¶å¯¼å…¥ä¾èµ–"><a href="#ä¸€-åˆ›å»ºmavené¡¹ç›®å¹¶å¯¼å…¥ä¾èµ–" class="headerlink" title="ä¸€. åˆ›å»ºmavené¡¹ç›®å¹¶å¯¼å…¥ä¾èµ–"></a>ä¸€. åˆ›å»ºmavené¡¹ç›®å¹¶å¯¼å…¥ä¾èµ–</h3><p><strong>PS: éœ€è¦è‡ªè¡Œå®‰è£…RocketMQå¹¶å¯åŠ¨æœåŠ¡</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.rocketmq<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>rocketmq-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.9.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="äºŒ-åŒæ­¥æ¶ˆæ¯"><a href="#äºŒ-åŒæ­¥æ¶ˆæ¯" class="headerlink" title="äºŒ. åŒæ­¥æ¶ˆæ¯"></a>äºŒ. åŒæ­¥æ¶ˆæ¯</h3><p>åŒæ­¥å‘é€æ˜¯æŒ‡å‘é€çš„æ¶ˆæ¯éœ€è¦<strong>ç­‰å¾…è·å–åˆ°è¿”å›ç»“æœ</strong>åå†æ‰§è¡Œç¬¬äºŒæ¡æ¶ˆæ¯å‘é€,é‡‡ç”¨çš„æ˜¯ä¸€ç§é˜»å¡æ¨¡å‹ï¼Œå®‰å…¨ï¼Œä½†æ•ˆç‡ä¼šé™ä½ä¸€ä¸¢ä¸¢ã€‚</p><ol><li><h4 id="ç”Ÿäº§è€…"><a href="#ç”Ÿäº§è€…" class="headerlink" title="ç”Ÿäº§è€…"></a>ç”Ÿäº§è€…</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.demo01;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.rocketmq.client.producer.DefaultMQProducer;</span><br><span class="line"><span class="keyword">import</span> org.apache.rocketmq.client.producer.SendResult;</span><br><span class="line"><span class="keyword">import</span> org.apache.rocketmq.common.message.Message;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.nio.charset.StandardCharsets;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lqs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/11/3 9:07</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Producer</span> &#123; <span class="comment">// ç”Ÿäº§è€…</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºç”Ÿäº§è€… </span></span><br><span class="line">        <span class="type">DefaultMQProducer</span> <span class="variable">producer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultMQProducer</span>(<span class="string">&quot;producer-demo&quot;</span>);</span><br><span class="line">        <span class="comment">// è¿æ¥æœåŠ¡</span></span><br><span class="line">        producer.setNamesrvAddr(<span class="string">&quot;127.0.0.1:9876&quot;</span>);</span><br><span class="line">        producer.start();</span><br><span class="line"><span class="comment">// æ¶ˆæ¯å‚æ•°ä¾æ¬¡æ˜¯ä¸»é¢˜ã€æ ‡ç­¾ã€å‘é€çš„æ¶ˆæ¯</span></span><br><span class="line">        <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Message</span>(<span class="string">&quot;demo-topic&quot;</span>, <span class="string">&quot;demo&quot;</span>, <span class="string">&quot;aaa I am a monster! nice to see ya!!!&quot;</span>.getBytes(StandardCharsets.UTF_8));</span><br><span class="line">        <span class="comment">// è¿”å›ç»“æœ</span></span><br><span class="line">        <span class="type">SendResult</span> <span class="variable">result</span> <span class="operator">=</span> producer.send(message);</span><br><span class="line">        System.out.println(result);</span><br><span class="line"><span class="comment">// å…³é—­ç”Ÿäº§è€…</span></span><br><span class="line">        producer.shutdown();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><h4 id="æ¶ˆè´¹è€…"><a href="#æ¶ˆè´¹è€…" class="headerlink" title="æ¶ˆè´¹è€…"></a>æ¶ˆè´¹è€…</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.demo01;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.rocketmq.client.consumer.DefaultMQPushConsumer;</span><br><span class="line"><span class="keyword">import</span> org.apache.rocketmq.client.consumer.listener.ConsumeConcurrentlyContext;</span><br><span class="line"><span class="keyword">import</span> org.apache.rocketmq.client.consumer.listener.ConsumeConcurrentlyStatus;</span><br><span class="line"><span class="keyword">import</span> org.apache.rocketmq.client.consumer.listener.MessageListenerConcurrently;</span><br><span class="line"><span class="keyword">import</span> org.apache.rocketmq.client.exception.MQClientException;</span><br><span class="line"><span class="keyword">import</span> org.apache.rocketmq.common.message.MessageExt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lqs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/11/3 9:25</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Consumer</span> &#123;<span class="comment">// æ¶ˆè´¹è€…</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºæ¶ˆè´¹è€…</span></span><br><span class="line">        <span class="type">DefaultMQPushConsumer</span> <span class="variable">consumer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultMQPushConsumer</span>(<span class="string">&quot;demo-consumer&quot;</span>);</span><br><span class="line">        consumer.setNamesrvAddr(<span class="string">&quot;127.0.0.1:9876&quot;</span>);</span><br><span class="line">        <span class="comment">// è®¢é˜…éœ€è¦æ¶ˆè´¹çš„ä¸»é¢˜å’Œæ ‡ç­¾ä¸‹çš„æ¶ˆæ¯</span></span><br><span class="line">        consumer.subscribe(<span class="string">&quot;demo-topic&quot;</span>, <span class="string">&quot;demo&quot;</span>);</span><br><span class="line">        <span class="comment">// å®ç°æ¶ˆæ¯ç›‘å¬æ¥å£</span></span><br><span class="line">        consumer.registerMessageListener(<span class="keyword">new</span> <span class="title class_">MessageListenerConcurrently</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> ConsumeConcurrentlyStatus <span class="title function_">consumeMessage</span><span class="params">(List&lt;MessageExt&gt; list, ConsumeConcurrentlyContext consumeConcurrentlyContext)</span> &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    list.forEach(l -&gt; &#123;</span><br><span class="line">                        <span class="comment">// è·å–æ¶ˆæ¯</span></span><br><span class="line">                        System.out.println(<span class="string">&quot;body:&quot;</span> +<span class="keyword">new</span> <span class="title class_">String</span>(l.getBody()));</span><br><span class="line">                        System.out.println(<span class="string">&quot;context:&quot;</span> + consumeConcurrentlyContext);</span><br><span class="line">                    &#125;);</span><br><span class="line">                    <span class="keyword">return</span> ConsumeConcurrentlyStatus.CONSUME_SUCCESS;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    <span class="keyword">return</span> ConsumeConcurrentlyStatus.RECONSUME_LATER;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        consumer.start();</span><br><span class="line">        System.out.println(<span class="string">&quot;æ¶ˆæ¯æ¶ˆæ¯å¯åŠ¨æˆåŠŸ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ol><h3 id="ä¸‰-å¼‚æ­¥æ¶ˆæ¯"><a href="#ä¸‰-å¼‚æ­¥æ¶ˆæ¯" class="headerlink" title="ä¸‰. å¼‚æ­¥æ¶ˆæ¯"></a>ä¸‰. å¼‚æ­¥æ¶ˆæ¯</h3><p>å¼‚æ­¥æ¶ˆæ¯æ˜¯æŒ‡å‘é€çš„æ¶ˆæ¯åˆ°MQé˜Ÿåˆ—ä¸ç”¨ç­‰å¾…å…¶è¿”å›ç»“æœï¼Œç»§ç»­å‘é€å…¶å®ƒæ¶ˆæ¯ï¼Œæ•ˆç‡å¿«ã€‚</p><ol><li><h4 id="ç”Ÿäº§è€…-1"><a href="#ç”Ÿäº§è€…-1" class="headerlink" title="ç”Ÿäº§è€…"></a>ç”Ÿäº§è€…</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.demo02;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.rocketmq.client.producer.DefaultMQProducer;</span><br><span class="line"><span class="keyword">import</span> org.apache.rocketmq.client.producer.SendCallback;</span><br><span class="line"><span class="keyword">import</span> org.apache.rocketmq.client.producer.SendResult;</span><br><span class="line"><span class="keyword">import</span> org.apache.rocketmq.common.message.Message;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.nio.charset.StandardCharsets;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lqs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/11/3 9:38</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Producer</span> &#123;<span class="comment">// å¼‚æ­¥ç”Ÿäº§è€…å‘é€æ¶ˆæ¯</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">DefaultMQProducer</span> <span class="variable">producer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultMQProducer</span>(<span class="string">&quot;producer-demo&quot;</span>);</span><br><span class="line">        producer.setNamesrvAddr(<span class="string">&quot;127.0.0.1:9876&quot;</span>);</span><br><span class="line">        producer.start();</span><br><span class="line"></span><br><span class="line">        <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Message</span>(<span class="string">&quot;demo-topic&quot;</span>, <span class="string">&quot;demo-async&quot;</span>, <span class="string">&quot;this is a async message and lqs is freaking awesome!&quot;</span>.getBytes(StandardCharsets.UTF_8));</span><br><span class="line">        <span class="comment">// è®¾ç½®å»¶æ—¶(è¿‡äº†ä¸€å®šæ—¶é—´å†å‘é€åˆ°MQå¯¹åˆ—) 5ç§’</span></span><br><span class="line">      <span class="comment">//  message.setDelayTimeLevel(2);// æŒ‡å®šå»¶è¿Ÿç­‰çº§ æ¯”å¦‚2 è¡¨ç¤º5ç§’</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å¼‚æ­¥å›è°ƒè·å–è¿”å›ç»“æœ</span></span><br><span class="line">        producer.send(message, <span class="keyword">new</span> <span class="title class_">SendCallback</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onSuccess</span><span class="params">(SendResult sendResult)</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;å‘é€ç»“æœ:&quot;</span>+sendResult);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onException</span><span class="params">(Throwable throwable)</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;å¤±è´¥åŸå› :&quot;</span>+throwable.getMessage());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><h4 id="æ¶ˆè´¹è€…-1"><a href="#æ¶ˆè´¹è€…-1" class="headerlink" title="æ¶ˆè´¹è€…"></a>æ¶ˆè´¹è€…</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.demo02;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.rocketmq.client.consumer.DefaultMQPushConsumer;</span><br><span class="line"><span class="keyword">import</span> org.apache.rocketmq.client.consumer.listener.ConsumeConcurrentlyContext;</span><br><span class="line"><span class="keyword">import</span> org.apache.rocketmq.client.consumer.listener.ConsumeConcurrentlyStatus;</span><br><span class="line"><span class="keyword">import</span> org.apache.rocketmq.client.consumer.listener.MessageListenerConcurrently;</span><br><span class="line"><span class="keyword">import</span> org.apache.rocketmq.client.exception.MQClientException;</span><br><span class="line"><span class="keyword">import</span> org.apache.rocketmq.common.message.MessageExt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lqs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/11/3 9:47</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Consumer</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">DefaultMQPushConsumer</span> <span class="variable">consumer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultMQPushConsumer</span>(<span class="string">&quot;demo-consumer&quot;</span>);</span><br><span class="line">        consumer.setNamesrvAddr(<span class="string">&quot;127.0.0.1:9876&quot;</span>);</span><br><span class="line">        consumer.subscribe(<span class="string">&quot;demo-topic&quot;</span>, <span class="string">&quot;demo-async&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å®ç°æ¶ˆæ¯ç›‘å¬æ¥å£</span></span><br><span class="line">        consumer.registerMessageListener(<span class="keyword">new</span> <span class="title class_">MessageListenerConcurrently</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> ConsumeConcurrentlyStatus <span class="title function_">consumeMessage</span><span class="params">(List&lt;MessageExt&gt; list, ConsumeConcurrentlyContext consumeConcurrentlyContext)</span> &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    list.forEach(l -&gt; &#123;</span><br><span class="line">                        <span class="comment">// è·å–æ¶ˆæ¯</span></span><br><span class="line">                        System.out.println(<span class="string">&quot;body:&quot;</span> +<span class="keyword">new</span> <span class="title class_">String</span>(l.getBody()));</span><br><span class="line">                        System.out.println(<span class="string">&quot;context:&quot;</span> + consumeConcurrentlyContext);</span><br><span class="line">                    &#125;);</span><br><span class="line">                    <span class="comment">// è¿”å›çŠ¶æ€è¡¨ç¤ºæ¶ˆæ¯å·²ç»è¢«æ¶ˆè´¹ï¼Œä¸å¯å†æ¬¡æ¶ˆè´¹</span></span><br><span class="line">                    <span class="keyword">return</span> ConsumeConcurrentlyStatus.CONSUME_SUCCESS;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    <span class="comment">// æ¶ˆè´¹å¤±è´¥ å¯å†æ¬¡æ¶ˆè´¹</span></span><br><span class="line">                    <span class="keyword">return</span> ConsumeConcurrentlyStatus.RECONSUME_LATER;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        consumer.start();</span><br><span class="line">        System.out.println(<span class="string">&quot;æ¶ˆæ¯æ¶ˆæ¯å¯åŠ¨æˆåŠŸ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ol><h3 id="å››-äº‹åŠ¡æ¶ˆæ¯"><a href="#å››-äº‹åŠ¡æ¶ˆæ¯" class="headerlink" title="å››. äº‹åŠ¡æ¶ˆæ¯"></a>å››. äº‹åŠ¡æ¶ˆæ¯</h3><ol><li><h4 id="äº‹åŠ¡ç›‘å¬"><a href="#äº‹åŠ¡ç›‘å¬" class="headerlink" title="äº‹åŠ¡ç›‘å¬"></a>äº‹åŠ¡ç›‘å¬</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.demo4;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.rocketmq.client.producer.LocalTransactionState;</span><br><span class="line"><span class="keyword">import</span> org.apache.rocketmq.client.producer.TransactionListener;</span><br><span class="line"><span class="keyword">import</span> org.apache.rocketmq.common.message.Message;</span><br><span class="line"><span class="keyword">import</span> org.apache.rocketmq.common.message.MessageExt;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lqs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/11/3 10:12</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyTransactionCheckListener</span> <span class="keyword">implements</span> <span class="title class_">TransactionListener</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> message</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> o       äº‹ç‰©æ¶ˆæ¯æºå¸¦çš„é¢å¤–å‚æ•°</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> LocalTransactionState <span class="title function_">executeLocalTransaction</span><span class="params">(Message message, Object o)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;äº‹åŠ¡å‘å¸ƒæ¶ˆæ¯:&quot;</span> + message);</span><br><span class="line">            System.out.println(<span class="string">&quot;äº‹åŠ¡å‚æ•°ï¼ˆé¢å¤–æ•°æ®ï¼‰:&quot;</span> + o);</span><br><span class="line">            <span class="comment">// äº‹åŠ¡è¿”å›çŠ¶æ€</span></span><br><span class="line">            <span class="keyword">return</span> LocalTransactionState.COMMIT_MESSAGE;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> LocalTransactionState.ROLLBACK_MESSAGE;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> LocalTransactionState <span class="title function_">checkLocalTransaction</span><span class="params">(MessageExt messageExt)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><h4 id="ç”Ÿæˆè€…"><a href="#ç”Ÿæˆè€…" class="headerlink" title="ç”Ÿæˆè€…"></a>ç”Ÿæˆè€…</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.demo4;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.rocketmq.client.exception.MQClientException;</span><br><span class="line"><span class="keyword">import</span> org.apache.rocketmq.client.producer.DefaultMQProducer;</span><br><span class="line"><span class="keyword">import</span> org.apache.rocketmq.client.producer.TransactionMQProducer;</span><br><span class="line"><span class="keyword">import</span> org.apache.rocketmq.common.message.Message;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.nio.charset.StandardCharsets;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ExecutorService;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.Executors;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lqs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/11/3 10:13</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Producer</span> &#123;<span class="comment">// äº‹åŠ¡æ¶ˆæ¯ç”Ÿäº§è€…</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//1.åˆ›å»ºç”Ÿäº§è€…å¯¹è±¡</span></span><br><span class="line">        <span class="type">TransactionMQProducer</span> <span class="variable">producer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TransactionMQProducer</span>(<span class="string">&quot;trans-demo&quot;</span>);</span><br><span class="line">        <span class="comment">//2.è¿æ¥NameServer</span></span><br><span class="line">        producer.setNamesrvAddr(<span class="string">&quot;127.0.0.1:9876&quot;</span>);</span><br><span class="line">        <span class="comment">//3.åˆ›å»ºçº¿ç¨‹</span></span><br><span class="line">        <span class="type">ExecutorService</span> <span class="variable">executorService</span> <span class="operator">=</span> Executors.newFixedThreadPool(<span class="number">2</span>);</span><br><span class="line">        producer.setExecutorService(executorService);</span><br><span class="line">        <span class="comment">//4.æŒ‡å®šçº¿ç¨‹çš„äº‹ç‰©ç›‘å¬</span></span><br><span class="line">        producer.setTransactionListener(<span class="keyword">new</span> <span class="title class_">MyTransactionCheckListener</span>());</span><br><span class="line">        <span class="comment">//3.å¯åŠ¨</span></span><br><span class="line">        producer.start();</span><br><span class="line"></span><br><span class="line">        <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Message</span>(<span class="string">&quot;demo-topic&quot;</span>, <span class="string">&quot;demo-trans&quot;</span>, <span class="string">&quot;this is a trans message and lqs is freaking awesome!&quot;</span>.getBytes(StandardCharsets.UTF_8));</span><br><span class="line">        producer.sendMessageInTransaction(message, <span class="string">&quot;äº‹åŠ¡demoå‚æ•°&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><h4 id="æ¶ˆè´¹è€…-2"><a href="#æ¶ˆè´¹è€…-2" class="headerlink" title="æ¶ˆè´¹è€…"></a>æ¶ˆè´¹è€…</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.demo4;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.rocketmq.client.consumer.DefaultMQPushConsumer;</span><br><span class="line"><span class="keyword">import</span> org.apache.rocketmq.client.consumer.listener.ConsumeConcurrentlyContext;</span><br><span class="line"><span class="keyword">import</span> org.apache.rocketmq.client.consumer.listener.ConsumeConcurrentlyStatus;</span><br><span class="line"><span class="keyword">import</span> org.apache.rocketmq.client.consumer.listener.MessageListenerConcurrently;</span><br><span class="line"><span class="keyword">import</span> org.apache.rocketmq.common.message.MessageExt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lqs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/11/3 9:47</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Consumer</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">DefaultMQPushConsumer</span> <span class="variable">consumer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultMQPushConsumer</span>(<span class="string">&quot;demo-trans&quot;</span>);</span><br><span class="line">        consumer.setNamesrvAddr(<span class="string">&quot;127.0.0.1:9876&quot;</span>);</span><br><span class="line">        consumer.subscribe(<span class="string">&quot;demo-topic&quot;</span>, <span class="string">&quot;demo-trans&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å®ç°æ¶ˆæ¯ç›‘å¬æ¥å£</span></span><br><span class="line">        consumer.registerMessageListener(<span class="keyword">new</span> <span class="title class_">MessageListenerConcurrently</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> ConsumeConcurrentlyStatus <span class="title function_">consumeMessage</span><span class="params">(List&lt;MessageExt&gt; list, ConsumeConcurrentlyContext consumeConcurrentlyContext)</span> &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    list.forEach(l -&gt; &#123;</span><br><span class="line">                        <span class="comment">// è·å–æ¶ˆæ¯</span></span><br><span class="line">                        System.out.println(<span class="string">&quot;body:&quot;</span> +<span class="keyword">new</span> <span class="title class_">String</span>(l.getBody()));</span><br><span class="line">                        System.out.println(<span class="string">&quot;context:&quot;</span> + consumeConcurrentlyContext);</span><br><span class="line">                    &#125;);</span><br><span class="line">                    <span class="keyword">return</span> ConsumeConcurrentlyStatus.CONSUME_SUCCESS;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    <span class="keyword">return</span> ConsumeConcurrentlyStatus.RECONSUME_LATER;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        consumer.start();</span><br><span class="line">        System.out.println(<span class="string">&quot;æ¶ˆæ¯æ¶ˆæ¯å¯åŠ¨æˆåŠŸ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h3 id="äº”-RocketMQäº‹åŠ¡æ¶ˆæ¯å·¥ä½œæµç¨‹"><a href="#äº”-RocketMQäº‹åŠ¡æ¶ˆæ¯å·¥ä½œæµç¨‹" class="headerlink" title="äº”. RocketMQäº‹åŠ¡æ¶ˆæ¯å·¥ä½œæµç¨‹"></a>äº”. <code>RocketMQ</code>äº‹åŠ¡æ¶ˆæ¯å·¥ä½œæµç¨‹</h3><ul><li>äº‹åŠ¡æ¶ˆæ¯è§£å†³çš„å°±æ˜¯ï¼Œäº‹åŠ¡å‘é€æ–¹æ‰§è¡Œæœ¬åœ°äº‹åŠ¡å’Œäº‹åŠ¡æ¶ˆæ¯çš„åŸå­æ€§ã€‚</li></ul><ol><li><p>é¦–å…ˆäº‹åŠ¡å‘èµ·æ–¹:å¾€MQä¸­å‘é€ä¸€ä¸ªäº‹åŠ¡æ¶ˆæ¯-halfåŠæ¶ˆæ¯(å‡†å¤‡æ¶ˆæ¯)ï¼Œè¯¥æ¶ˆæ¯ä¸å¯è¢«æ¶ˆè´¹;</p></li><li><p>ç„¶åäº‹åŠ¡å‘é€æ–¹æ‰§è¡Œæœ¬åœ°äº‹åŠ¡ï¼Œå¹¶å‘é€commitç»™MQï¼Œå¦‚æœæ˜¯æ‰§è¡Œå¤±è´¥å°±ä¼šå‘é€rollbackç»™MQ;</p></li><li><p>MQæœåˆ°commitæŒ‡ä»¤ï¼Œä»£è¡¨æœ¬åœ°äº‹åŠ¡æ‰§è¡ŒæˆåŠŸï¼Œä¹‹å‰çš„halfæ¶ˆæ¯å°±ä¼šæˆä¸ºå¯ä»¥è¢«commitæäº¤çš„æ¶ˆ</p><p>æ¯ï¼Œå¦åˆ™å°±æ˜¯Rollbackæ¶ˆæ¯;</p></li><li><p>äº‹åŠ¡å‚ä¸è€…ï¼Œä¹Ÿå°±æ˜¯æ¶ˆè´¹è€…ä¼šæ¶ˆè´¹è¿™ä¸ªæ¶ˆæ¯ï¼Œç„¶åæ‰§è¡Œç›¸å…³çš„é€»è¾‘å¤„ç†ã€‚å¦‚æœæ˜¯Rollbackæ¶ˆæ¯å°±ä¸</p><p>ä¼šè¢«æ¶ˆè´¹ï¼Œè€Œæ˜¯ä¸¢å¼ƒ;</p></li><li><p>å¦‚æœäº‹åŠ¡å‚ä¸æ–¹å¹¶æ²¡æœ‰å‘é€commitæˆ–è€…rollbackæŒ‡ä»¤MQï¼ŒMQå›è°ƒç”¨äº‹åŠ¡å‘é€æ–¹çš„å›åˆ°æ–¹æ³•æ¥æ£€</p><p>æŸ¥ï¼Œæˆ‘ä»¬éœ€è¦å»å®ç°è¿™ä¸ªæœ¬åœ°äº‹åŠ¡æ£€æŸ¥æ¥å£ï¼Œé€šè¿‡è¿”å›commitæˆ–è€…rollbackæ¥å‘ŠçŸ¥MQæœ¬åœ°äº‹åŠ¡æ˜¯</p><p>å¦æ‰§è¡ŒæˆåŠŸã€‚</p></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;ä¸€-åˆ›å»ºmavené¡¹ç›®å¹¶å¯¼å…¥ä¾èµ–&quot;&gt;&lt;a href=&quot;#ä¸€-åˆ›å»ºmavené¡¹ç›®å¹¶å¯¼å…¥ä¾èµ–&quot; class=&quot;headerlink&quot; title=&quot;ä¸€. åˆ›å»ºmavené¡¹ç›®å¹¶å¯¼å…¥ä¾èµ–&quot;&gt;&lt;/a&gt;ä¸€. åˆ›å»ºmavené¡¹ç›®å¹¶å¯¼å…¥ä¾èµ–&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;PS: </summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>ç”¨javaæ¯”è¾ƒä¸¤ä¸ªäºŒå‰æœç´¢æ ‘æ˜¯å¦ç­‰ä»·</title>
    <link href="https://www.fomal.cc/posts/c73d9d2.html"/>
    <id>https://www.fomal.cc/posts/c73d9d2.html</id>
    <published>2025-05-20T08:38:30.644Z</published>
    <updated>2023-12-06T08:02:09.231Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ä¸€-å®šä¹‰æ ‘çš„çš„èŠ‚ç‚¹"><a href="#ä¸€-å®šä¹‰æ ‘çš„çš„èŠ‚ç‚¹" class="headerlink" title="ä¸€. å®šä¹‰æ ‘çš„çš„èŠ‚ç‚¹"></a>ä¸€. å®šä¹‰æ ‘çš„çš„èŠ‚ç‚¹</h3><p>â€‹    ä¸åŒäºŒå‰æ ‘çš„å¶èŠ‚ç‚¹ä¸Šå¯ä»¥ä¿å­˜ç›¸åŒçš„å€¼åºåˆ—ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹ä¸¤ä¸ªäºŒå‰æ ‘éƒ½ä¿å­˜äº†åºåˆ— <code>1ï¼Œ1ï¼Œ2ï¼Œ3ï¼Œ5ï¼Œ8ï¼Œ13</code>ã€‚  </p><p><img src="../blog/coderyeah/source/_posts/img/tree.png" alt="img"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.wedoo.coderyeah.<span class="keyword">module</span>.iot.algorithm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lqs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/12/6 15:23</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TreeNode</span> &#123; <span class="comment">// æ¯”è¾ƒä¸¤ä¸ªäºŒå‰æœç´¢æ ‘æ˜¯å¦ç­‰ä»·</span></span><br><span class="line">    <span class="keyword">private</span> TreeNode Left; <span class="comment">// å·¦è¾¹çš„æ ‘ç»“æ„</span></span><br><span class="line">    <span class="keyword">private</span> Integer Value; <span class="comment">// æ ‘èŠ‚ç‚¹çš„æ•°å€¼</span></span><br><span class="line">    <span class="keyword">private</span> TreeNode Right; <span class="comment">// å³è¾¹çš„æ ‘ç»“æ„</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ„é€ æ–¹æ³•</span></span><br><span class="line">    TreeNode(<span class="type">int</span> x) &#123;</span><br><span class="line">        Value = x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="äºŒ-å…·ä½“å®ç°"><a href="#äºŒ-å…·ä½“å®ç°" class="headerlink" title="äºŒ. å…·ä½“å®ç°"></a>äºŒ. å…·ä½“å®ç°</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.wedoo.coderyeah.<span class="keyword">module</span>.iot.algorithm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lqs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/12/6 15:27</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BinaryTree</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç”¨äºä¿å­˜æ¯ä¸ªèŠ‚ç‚¹å€¼ </span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">saveNodeValues</span><span class="params">(TreeNode node, List&lt;Integer&gt; list)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// é€’å½’è°ƒç”¨è‡ªå·± å·¦æ ‘</span></span><br><span class="line">        saveNodeValues(node.getLeft(), list);</span><br><span class="line">        <span class="comment">// å°†å€¼ä¿å­˜åœ¨é›†åˆä¸­ æœ€åæ‰€å¾—æ˜¯æ•´æ£µæ ‘çš„å„èŠ‚ç‚¹å€¼</span></span><br><span class="line">        list.add(node.getValue());</span><br><span class="line">         <span class="comment">// é€’å½’è°ƒç”¨è‡ªå·± å³æ ‘</span></span><br><span class="line">        saveNodeValues(node.getRight(), list);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç”¨äºæ¯”è¾ƒä¸¤æ£µæ ‘æ˜¯å¦ç­‰ä»·</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Boolean <span class="title function_">compare</span><span class="params">(TreeNode tree1, TreeNode tree2)</span> &#123;</span><br><span class="line">        <span class="comment">// å‡†å¤‡é›†åˆä¿å­˜èŠ‚ç‚¹å€¼</span></span><br><span class="line">        List&lt;Integer&gt; list1 = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        List&lt;Integer&gt; list2 = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        saveNodeValues(tree1, list1);</span><br><span class="line">        saveNodeValues(tree2, list2);</span><br><span class="line">        System.out.println(<span class="string">&quot;list1:&quot;</span> + list1);<span class="comment">//list1:[2, 1, 9]</span></span><br><span class="line">        System.out.println(<span class="string">&quot;list2:&quot;</span> + list2);<span class="comment">//list2:[2, 1, 3]</span></span><br><span class="line"><span class="comment">// æ¯”è¾ƒé›†åˆæ˜¯å¦ç›¸ç­‰</span></span><br><span class="line">        <span class="keyword">return</span> list1.equals(list2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// æ„é€ ç¬¬ä¸€é¢—äºŒå‰æ ‘</span></span><br><span class="line">        <span class="type">TreeNode</span> <span class="variable">treeNode</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TreeNode</span>(<span class="number">1</span>);</span><br><span class="line">        treeNode.setLeft(<span class="keyword">new</span> <span class="title class_">TreeNode</span>(<span class="number">2</span>));</span><br><span class="line">        treeNode.setRight(<span class="keyword">new</span> <span class="title class_">TreeNode</span>(<span class="number">3</span>));</span><br><span class="line"><span class="comment">// æ„é€ ç¬¬äºŒé¢—äºŒå‰æ ‘</span></span><br><span class="line">        <span class="type">TreeNode</span> <span class="variable">treeNode2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TreeNode</span>(<span class="number">1</span>);</span><br><span class="line">        treeNode2.setLeft(<span class="keyword">new</span> <span class="title class_">TreeNode</span>(<span class="number">2</span>));</span><br><span class="line">        treeNode2.setRight(<span class="keyword">new</span> <span class="title class_">TreeNode</span>(<span class="number">9</span>));</span><br><span class="line"></span><br><span class="line">        <span class="type">Boolean</span> <span class="variable">aBoolean</span> <span class="operator">=</span> compare(treeNode2, treeNode);</span><br><span class="line">        System.out.println(<span class="string">&quot;aBoolean: &quot;</span> + aBoolean);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¸‰-GOå®ç°"><a href="#ä¸‰-GOå®ç°" class="headerlink" title="ä¸‰. GOå®ç°"></a>ä¸‰. GOå®ç°</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;golang.org/x/tour/tree&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// äºŒå‰æ ‘æŸ¥æ‰¾æ¯”è¾ƒ ç­‰ä»·äºŒå‰æŸ¥æ‰¾æ ‘</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    t1 := tree.New(<span class="number">1</span>)</span><br><span class="line">    t2 := tree.New(<span class="number">1</span>)</span><br><span class="line">    b := compare(t1, t2)</span><br><span class="line">    fmt.Println(<span class="string">&quot;t1==t2:&quot;</span>, b)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Walk</span><span class="params">(t *tree.Tree, ch <span class="keyword">chan</span> <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> t == <span class="literal">nil</span> &#123; <span class="comment">// ç©ºæ ‘ æ²¡æœ‰å¶å­èŠ‚ç‚¹</span></span><br><span class="line">       <span class="keyword">return</span> <span class="comment">// é€’å½’å‡½æ•°ç»“æŸæ¡ä»¶</span></span><br><span class="line">    &#125;</span><br><span class="line">    Walk(t.Left, ch)</span><br><span class="line">    ch &lt;- t.Value</span><br><span class="line">    Walk(t.Right, ch)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">compare</span><span class="params">(t1, t2 *tree.Tree)</span></span> <span class="type">bool</span> &#123;</span><br><span class="line">    c1 := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>) <span class="comment">// ç®¡é“ ä¼ é€’æ•°æ® æ— ç¼“å†²é»˜è®¤1ï¼ŒæŒ‰é¡ºåºä¼ é€’æ•°æ®</span></span><br><span class="line">    c2 := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>)</span><br><span class="line">    <span class="keyword">go</span> Walk(t1, c1)</span><br><span class="line">    <span class="keyword">go</span> Walk(t2, c2)</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">       x, y := &lt;-c1, &lt;-c2</span><br><span class="line">       fmt.Println(x, y)</span><br><span class="line">       <span class="keyword">if</span> x != y &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">       &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;ä¸€-å®šä¹‰æ ‘çš„çš„èŠ‚ç‚¹&quot;&gt;&lt;a href=&quot;#ä¸€-å®šä¹‰æ ‘çš„çš„èŠ‚ç‚¹&quot; class=&quot;headerlink&quot; title=&quot;ä¸€. å®šä¹‰æ ‘çš„çš„èŠ‚ç‚¹&quot;&gt;&lt;/a&gt;ä¸€. å®šä¹‰æ ‘çš„çš„èŠ‚ç‚¹&lt;/h3&gt;&lt;p&gt;â€‹    ä¸åŒäºŒå‰æ ‘çš„å¶èŠ‚ç‚¹ä¸Šå¯ä»¥ä¿å­˜ç›¸åŒçš„å€¼åºåˆ—ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹ä¸¤ä¸ªäºŒå‰æ ‘éƒ½ä¿å­˜äº†</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>ä¸€ç¯‡å¸¦ä½ äº†è§£ä»€ä¹ˆæ˜¯äº‹åŠ¡åŠå…¶åŸç†</title>
    <link href="https://www.fomal.cc/posts/9447ebf6.html"/>
    <id>https://www.fomal.cc/posts/9447ebf6.html</id>
    <published>2025-05-20T08:38:30.641Z</published>
    <updated>2022-12-11T08:45:40.032Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ä¸€-ä»€ä¹ˆæ˜¯äº‹åŠ¡"><a href="#ä¸€-ä»€ä¹ˆæ˜¯äº‹åŠ¡" class="headerlink" title="ä¸€.ä»€ä¹ˆæ˜¯äº‹åŠ¡"></a>ä¸€.ä»€ä¹ˆæ˜¯äº‹åŠ¡</h3><p><strong>äº‹åŠ¡:</strong> æŒ‡ä½œä¸ºå•ä¸ªé€»è¾‘å·¥ä½œå•å…ƒ(Serviceæ–¹æ³•)æ‰§è¡Œçš„ä¸€ç³»åˆ—æ“ä½œï¼ˆæ•°æ®åº“æ“ä½œï¼‰ï¼Œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ¨ä¸æ‰§è¡Œã€‚äº‹åŠ¡å¯ä»¥çœ‹åšæ˜¯ä¸€ç»„ä»»åŠ¡ï¼Œé€šå¸¸å¯¹åº”äº†ä¸€ä¸ªä¸šåŠ¡æ–¹æ³•,è¿™äº›ä»»åŠ¡è¦ä¹ˆå…¨éƒ¨æˆåŠŸ,è¦ä¹ˆå…¨éƒ¨å¤±è´¥ã€‚</p><p>æœ¬åœ°äº‹åŠ¡æœ‰è¿™ä¹ˆå‡ ä¸ªç‰¹å¾:</p><ul><li><p>ä¸€æ¬¡äº‹åŠ¡åªè¿æ¥ä¸€ä¸ªæ”¯æŒäº‹åŠ¡çš„æ•°æ®åº“ï¼ˆä¸€èˆ¬æ¥è¯´éƒ½æ˜¯å…³ç³»å‹æ•°æ®åº“ï¼‰</p></li><li><p>äº‹åŠ¡çš„æ‰§è¡Œç»“æœä¿è¯[ACID]</p></li><li><p>ä¼šç”¨åˆ°æ•°æ®åº“é”</p><p>äº‹åŠ¡å…·æœ‰åŸå­æ€§ï¼ˆAtomicityï¼‰ã€ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ã€éš”ç¦»æ€§ï¼ˆIsolationï¼‰ã€æŒä¹…æ€§ï¼ˆDurabilityï¼‰å››ä¸ªç‰¹æ€§ï¼Œç®€ç§° ACIDï¼Œç¼ºä¸€ä¸å¯ã€‚</p></li></ul><h3 id="äºŒ-åŸå­æ€§-Atomicity"><a href="#äºŒ-åŸå­æ€§-Atomicity" class="headerlink" title="äºŒ.åŸå­æ€§ Atomicity"></a>äºŒ.åŸå­æ€§ Atomicity</h3><p><strong>å®˜æ–¹è§£é‡Š</strong></p><blockquote><p>Atomicity requires that each transaction be <strong>â€œall or nothingâ€</strong>: if one part of the transaction fails, then the entire transaction fails, and the database state is left unchanged. An atomic system must guarantee atomicity in each and every situation, including power failures, errors and crashes. To the outside world, a committed transaction appears (by its effects on the database) to be <strong>indivisible</strong> (â€œatomicâ€), and an aborted transaction does not happen.</p></blockquote><p><strong>å…³é”®è¯åœ¨äºï¼š</strong></p><ul><li><p>all or nothingï¼Œå®ƒçš„æ„æ€æ˜¯æ•°æ®åº“è¦ä¹ˆè¢«ä¿®æ”¹äº†ï¼Œè¦ä¹ˆä¿æŒåŸæ¥çš„çŠ¶æ€ã€‚æ‰€è°“ä¿æŒåŸæ¥çš„çŠ¶æ€ä¸æ˜¯æˆ‘å…ˆinsertå†deleteï¼Œè€Œæ˜¯å‹æ ¹å°±æ²¡æœ‰å‘ç”Ÿè¿‡ä»»ä½•æ“ä½œã€‚å› ä¸ºinsertç„¶åå†deleteå®é™…ä¸Šè¿˜æ˜¯ä¿®æ”¹äº†æ•°æ®åº“çŠ¶æ€çš„ï¼Œè‡³å°‘åœ¨æ•°æ®åº“æ—¥å¿—å±‚é¢æ˜¯è¿™æ ·ã€‚</p></li><li><p>indivisibleï¼Œä¸å¯åˆ†å‰²ï¼Œ<strong>ä¸€ä¸ªäº‹åŠ¡å°±æ˜¯ä¸€ä¸ªæœ€å°çš„æ— æ³•åˆ†å‰²çš„ç‹¬ç«‹å•å…ƒï¼Œä¸å…è®¸éƒ¨åˆ†æˆåŠŸéƒ¨åˆ†å¤±è´¥ã€‚</strong> </p></li></ul><p>åˆ©ç”¨<strong>Innodb</strong>çš„undo logï¼Œ<strong>undo log</strong>åä¸ºå›æ»šæ—¥å¿—ï¼Œæ˜¯å®ç°åŸå­æ€§çš„å…³é”®ï¼Œå½“äº‹åŠ¡å›æ»šæ—¶èƒ½å¤Ÿæ’¤é”€æ‰€æœ‰å·²ç»æˆåŠŸæ‰§è¡Œçš„sqlè¯­å¥ï¼Œä»–éœ€è¦è®°å½•ä½ è¦å›æ»šçš„ç›¸åº”æ—¥å¿—ä¿¡æ¯ã€‚ ä¾‹å¦‚:</p><ul><li><p>å½“ä½ deleteä¸€æ¡æ•°æ®çš„æ—¶å€™ï¼Œå°±éœ€è¦è®°å½•è¿™æ¡æ•°æ®çš„ä¿¡æ¯ï¼Œå›æ»šçš„æ—¶å€™ï¼Œinsertè¿™æ¡æ—§æ•°æ®;</p></li><li><p>å½“ä½ updateä¸€æ¡æ•°æ®çš„æ—¶å€™ï¼Œå°±éœ€è¦è®°å½•ä¹‹å‰çš„æ—§å€¼ï¼Œå›æ»šçš„æ—¶å€™ï¼Œæ ¹æ®æ—§å€¼æ‰§è¡Œupdateæ“ä½œ;</p></li><li><p>å½“å¹´insertä¸€æ¡æ•°æ®çš„æ—¶å€™ï¼Œå°±éœ€è¦è¿™æ¡è®°å½•çš„ä¸»é”®ï¼Œå›æ»šçš„æ—¶å€™ï¼Œæ ¹æ®ä¸»é”®æ‰§è¡Œdeleteæ“ä½œ</p></li></ul><p>undo logè®°å½•äº†è¿™äº›å›æ»šéœ€è¦çš„ä¿¡æ¯ï¼Œå½“äº‹åŠ¡æ‰§è¡Œå¤±è´¥æˆ–è°ƒç”¨äº†rollbackï¼Œå¯¼è‡´äº‹åŠ¡éœ€è¦å›æ»šï¼Œä¾¿å¯ä»¥åˆ©ç”¨undo logä¸­çš„ä¿¡æ¯å°†æ•°æ®å›æ»šåˆ°ä¿®æ”¹ä¹‹å‰çš„æ ·å­ã€‚</p><h3 id="ä¸‰-Consistency-ä¸€è‡´æ€§"><a href="#ä¸‰-Consistency-ä¸€è‡´æ€§" class="headerlink" title="ä¸‰.Consistency ä¸€è‡´æ€§"></a>ä¸‰.Consistency ä¸€è‡´æ€§</h3><p><strong>å®˜æ–¹è§£é‡Š</strong></p><blockquote><p>The consistency property ensures that any transaction will bring the database from one valid state to another. <strong>Any data written to the database must be valid according to all defined rules, including constraints, cascades, triggers, and any combination thereof</strong>. This does not guarantee correctness of the transaction in all ways the application programmer might have wanted (that is the responsibility of application-level code), but merely that any programming errors cannot result in the violation of any defined rules.</p></blockquote><p>ä¸€è‡´æ€§è¦æ±‚ä»»ä½•å†™åˆ°æ•°æ®åº“çš„æ•°æ®éƒ½å¿…é¡»æ»¡è¶³äºé¢„å…ˆå®šä¹‰çš„è§„åˆ™ï¼ˆæ¯”å¦‚ä½™é¢ä¸èƒ½å°äº0ã€å¤–é”®çº¦æŸç­‰ï¼‰ï¼Œç®€å•æ¥è¯´å°±æ˜¯åœ¨ä»»ä½•æ—¶é—´ç‚¹éƒ½ä¸èƒ½å‡ºç°è¿åä¸€è‡´æ€§è¦æ±‚çš„çŠ¶æ€ã€‚å‡ ä¸ªå¹¶è¡Œæ‰§è¡Œçš„äº‹åŠ¡ï¼Œå…¶æ‰§è¡Œç»“æœå¿…é¡»ä¸æŒ‰æŸä¸€é¡ºåº ä¸²è¡Œæ‰§è¡Œçš„ç»“æœç›¸ä¸€è‡´ï¼Œ<strong>Mysqlé€šè¿‡æ’ä»–é”æ¥ä¿è¯ä¸€è‡´æ€§</strong>.</p><h3 id="å››-Durability-æŒä¹…æ€§"><a href="#å››-Durability-æŒä¹…æ€§" class="headerlink" title="å››.Durability æŒä¹…æ€§"></a>å››.Durability æŒä¹…æ€§</h3><p>å®˜æ–¹è§£é‡Š</p><blockquote><p>The durability property ensures that <strong>once a transaction has been committed, it will remain so, even in the event of power loss, crashes, or errors</strong>. In a relational database, for instance, once a group of SQL statements execute, the results need to be stored permanently (even if the database crashes immediately thereafter). To defend against power loss, transactions (or their effects) must be recorded in a non-volatile memory.</p></blockquote><p>æŒä¹…æ€§çš„å…³é”®åœ¨äºä¸€æ—¦â€œå®Œæˆæäº¤â€ï¼ˆcommittedï¼‰ï¼Œé‚£ä¹ˆæ•°æ®å°±ä¸ä¼šä¸¢å¤±ã€‚<strong>undologå®ç°äº‹åŠ¡åŸå­æ€§ï¼Œredologå®ç°äº‹åŠ¡çš„æŒä¹…æ€§</strong>,<strong>Redo Logè®°å½•çš„æ˜¯æ–°æ•°æ®çš„å¤‡ä»½ã€‚</strong>åœ¨äº‹åŠ¡æäº¤å‰ï¼Œåªè¦å°†Redo LogæŒä¹…åŒ–å³å¯ï¼Œä¸éœ€è¦å°†æ•°æ®æŒä¹…åŒ–ã€‚å½“ç³»ç»Ÿå´©æºƒæ—¶ï¼Œè™½ç„¶æ•°æ®æ²¡æœ‰æŒä¹…åŒ–ï¼Œä½†æ˜¯Redo Logå·²ç»æŒä¹…åŒ–ã€‚ç³»ç»Ÿå¯ä»¥æ ¹æ®Redo Logçš„å†…å®¹ï¼Œå°†æ‰€æœ‰æ•°æ®æ¢å¤åˆ°æœ€æ–°çš„çŠ¶æ€ã€‚</p><h4 id="Undo-Redoäº‹åŠ¡çš„ç®€åŒ–è¿‡ç¨‹"><a href="#Undo-Redoäº‹åŠ¡çš„ç®€åŒ–è¿‡ç¨‹" class="headerlink" title="Undo + Redoäº‹åŠ¡çš„ç®€åŒ–è¿‡ç¨‹"></a>Undo + Redoäº‹åŠ¡çš„ç®€åŒ–è¿‡ç¨‹</h4><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1.A.äº‹åŠ¡å¼€å§‹. </span><br><span class="line">2.B.è®°å½•<span class="attribute">A</span>=1åˆ°undo log. </span><br><span class="line">3.C.ä¿®æ”¹<span class="attribute">A</span>=3. </span><br><span class="line">4.D.è®°å½•<span class="attribute">A</span>=3åˆ°redo log. </span><br><span class="line">5.E.è®°å½•<span class="attribute">B</span>=2åˆ°undo log. </span><br><span class="line">6.F.ä¿®æ”¹<span class="attribute">B</span>=4. </span><br><span class="line">7.G.è®°å½•<span class="attribute">B</span>=4åˆ°redo log. </span><br><span class="line">8.H.å°†redo logå†™å…¥ç£ç›˜ã€‚ </span><br><span class="line">I.äº‹åŠ¡æäº¤</span><br></pre></td></tr></table></figure><p>é€šè¿‡<strong>undolog</strong>ï¼ˆè®°å½•æ—§æ•°æ®ç”¨æ¥åæ‚”ï¼‰ä¿è¯äº‹åŠ¡çš„åŸå­æ€§ï¼Œ<strong>redolog</strong>(è®°å½•æ–°æ•°æ®ç”¨æ¥ä¿å­˜åˆ°ç£ç›˜)ä¿è¯æŒä¹…æ€§ã€‚</p><h4 id="é‡‡ç”¨redo-logçš„å¥½å¤„"><a href="#é‡‡ç”¨redo-logçš„å¥½å¤„" class="headerlink" title="é‡‡ç”¨redo logçš„å¥½å¤„"></a>é‡‡ç”¨redo logçš„å¥½å¤„</h4><p>redo logè¿›è¡Œåˆ·ç›˜æ¯”å¯¹æ•°æ®é¡µåˆ·ç›˜æ•ˆç‡é«˜ï¼Œå…·ä½“è¡¨ç°å¦‚ä¸‹</p><ul><li><p>redo logä½“ç§¯å°ï¼Œæ¯•ç«Ÿåªè®°å½•äº†å“ªä¸€é¡µä¿®æ”¹äº†å•¥ï¼Œå› æ­¤ä½“ç§¯å°ï¼Œåˆ·ç›˜å¿«ã€‚</p></li><li><p>redo logæ˜¯ä¸€ç›´å¾€æœ«å°¾è¿›è¡Œè¿½åŠ ï¼Œå±äºé¡ºåºIOã€‚æ•ˆç‡æ˜¾ç„¶æ¯”éšæœºIOæ¥çš„å¿«ã€‚</p></li></ul><h3 id="äº”-Isolation-éš”ç¦»æ€§"><a href="#äº”-Isolation-éš”ç¦»æ€§" class="headerlink" title="äº”.Isolation éš”ç¦»æ€§"></a>äº”.Isolation éš”ç¦»æ€§</h3><p>éš”ç¦»æ€§è¦æ±‚å¦‚æœä¸¤ä¸ªäº‹åŠ¡ä¿®æ”¹åŒä¸€ä¸ªæ•°æ®ï¼Œåˆ™å¿…é¡»æŒ‰é¡ºåºæ‰§è¡Œï¼Œå¹¶ä¸”å‰ä¸€ä¸ªäº‹åŠ¡å¦‚æœæœªå®Œæˆï¼Œé‚£ä¹ˆæœªå®Œæˆçš„ä¸­é—´çŠ¶æ€å¯¹å¦ä¸€ä¸ªäº‹åŠ¡ä¸å¯è§ã€‚</p><h3 id="å…­-äº‹åŠ¡éš”ç¦»çº§åˆ«"><a href="#å…­-äº‹åŠ¡éš”ç¦»çº§åˆ«" class="headerlink" title="å…­.äº‹åŠ¡éš”ç¦»çº§åˆ«"></a>å…­.äº‹åŠ¡éš”ç¦»çº§åˆ«</h3><ol><li><h4 id="çº¿ç¨‹å¹¶å‘å’Œäº‹åŠ¡éš”ç¦»"><a href="#çº¿ç¨‹å¹¶å‘å’Œäº‹åŠ¡éš”ç¦»" class="headerlink" title="çº¿ç¨‹å¹¶å‘å’Œäº‹åŠ¡éš”ç¦»"></a>çº¿ç¨‹å¹¶å‘å’Œäº‹åŠ¡éš”ç¦»</h4><p>SQL æ ‡å‡†å®šä¹‰äº†å››ç§éš”ç¦»çº§åˆ«ï¼ŒMySQL å…¨éƒ½æ”¯æŒã€‚è¿™å››ç§éš”ç¦»çº§åˆ«åˆ†åˆ«æ˜¯ï¼š</p><ul><li><p>è¯»æœªæäº¤ï¼ˆREAD UNCOMMITTEDï¼‰</p></li><li><p>è¯»æäº¤ ï¼ˆREAD COMMITTEDï¼‰</p></li><li><p>å¯é‡å¤è¯» ï¼ˆREPEATABLE READï¼‰</p></li><li><p>ä¸²è¡ŒåŒ– ï¼ˆSERIALIZABLEï¼‰</p><p><strong>ä»¥ä¸Šå‡ ä¸ªæ¦‚å¿µæ˜¯äº‹åŠ¡éš”ç¦»çº§åˆ«è¦å®é™…è§£å†³çš„é—®é¢˜ï¼šè„è¯»ï¼Œä¸å¯é‡å¤è¯»ï¼Œå¹»è¯»</strong></p></li></ul></li><li><h4 id="è„è¯»"><a href="#è„è¯»" class="headerlink" title="è„è¯»"></a>è„è¯»</h4><p>è„è¯»æŒ‡çš„æ˜¯è¯»åˆ°äº†å…¶ä»–äº‹åŠ¡<strong>æœªæäº¤çš„æ•°æ®</strong>ï¼Œæœªæäº¤æ„å‘³ç€è¿™äº›æ•°æ®å¯èƒ½ä¼šå›æ»šï¼Œä¹Ÿå°±æ˜¯å¯èƒ½æœ€ç»ˆä¸ä¼šå­˜åˆ°æ•°æ®åº“ä¸­ï¼Œä¹Ÿå°±æ˜¯ä¸å­˜åœ¨çš„æ•°æ®ã€‚è¯»åˆ°äº†ä¸ä¸€å®šæœ€ç»ˆå­˜åœ¨çš„æ•°æ®ï¼Œè¿™å°±æ˜¯è„è¯»ã€‚<strong>è¯»æœªæäº¤ä¼šé€ æˆè„è¯»;è¯»æäº¤å¯ä»¥è§£å†³è„è¯»é—®é¢˜ã€‚</strong></p></li><li><h4 id="ä¸å¯é‡å¤è¯»"><a href="#ä¸å¯é‡å¤è¯»" class="headerlink" title="ä¸å¯é‡å¤è¯»"></a>ä¸å¯é‡å¤è¯»</h4><p>å¯é‡å¤è¯»æŒ‡çš„æ˜¯åœ¨ä¸€ä¸ªäº‹åŠ¡å†…ï¼Œæœ€å¼€å§‹è¯»åˆ°çš„æ•°æ®å’Œäº‹åŠ¡ç»“æŸå‰çš„ä»»æ„æ—¶åˆ»è¯»åˆ°çš„åŒä¸€æ‰¹æ•°æ®éƒ½æ˜¯ä¸€è‡´çš„ï¼Œé‚£ä¸å¯é‡å¤è¯»å°±æ˜¯ä¸€ä¸ªäº‹åŠ¡å¤šæ¬¡è¯»å–åˆ°çš„æ•°æ®æ˜¯ä¸ä¸€è‡´çš„ï¼Œ<strong>é€šå¸¸é’ˆå¯¹æ•°æ®æ›´æ–°ï¼ˆUPDATEï¼‰æ“ä½œ</strong>ã€‚å³ï¼š<strong>åŒä¸€ä¸ªäº‹åŠ¡ä¸­å¤šæ¬¡ä½¿ç”¨ç›¸åŒæ¡ä»¶è¯»å–åˆ°çš„æ•°æ®æ˜¯ä¸ä¸€æ ·çš„ã€‚</strong></p><p><code>set global transaction isolation level repeatable read;</code><strong>å¯é‡å¤è¯»</strong>ï¼Œè¿™ä¹Ÿæ˜¯<code>Mysql</code>é»˜è®¤çš„äº‹åŠ¡éš”ç¦»ç­–ç•¥ï¼Œä½†æ˜¯è¯¥äº‹åŠ¡éš”ç¦»çº§åˆ«æ²¡åŠæ³•è§£å†³å¹»è¯»é—®é¢˜ã€‚</p></li><li><h4 id="å¹»è¯»"><a href="#å¹»è¯»" class="headerlink" title=".å¹»è¯»"></a>.å¹»è¯»</h4><p>äº‹åŠ¡A æŒ‰ç…§ä¸€å®šæ¡ä»¶è¿›è¡Œæ•°æ®è¯»å–ï¼Œ æœŸé—´äº‹åŠ¡B æ’å…¥äº†ç›¸åŒæœç´¢æ¡ä»¶çš„æ–°æ•°æ®ï¼Œäº‹åŠ¡Aå†æ¬¡æŒ‰ç…§åŸå…ˆæ¡ä»¶è¿›è¡Œè¯»å–æ—¶ï¼Œå‘ç°äº†äº‹åŠ¡B æ–°æ’å…¥çš„æ•°æ® ç§°ä¸ºå¹»è¯» , å³ï¼š<strong>äº‹ç‰©Aä¸¤æ¬¡è¯»å–ç›¸åŒæ¡ä»¶çš„æ•°æ®è¯»åˆ°çš„æ¡æ•°ä¸ä¸€æ ·ã€‚</strong></p><p>MySQL çš„å¯é‡å¤è¯»éš”ç¦»çº§åˆ«å…¶å®è§£å†³äº†å¹»è¯»é—®é¢˜ï¼Œå®ƒä½¿ç”¨åˆ°äº†â€œé—´éš™é”â€ã€‚</p></li><li><h4 id="ä¸²è¡ŒåŒ–"><a href="#ä¸²è¡ŒåŒ–" class="headerlink" title="ä¸²è¡ŒåŒ–"></a>ä¸²è¡ŒåŒ–</h4><p>ä¸²è¡ŒåŒ–æ˜¯4ç§äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸­éš”ç¦»æ•ˆæœæœ€å¥½çš„ï¼Œè§£å†³äº†è„è¯»ã€å¯é‡å¤è¯»ã€å¹»è¯»çš„é—®é¢˜ï¼Œä½†æ˜¯æ•ˆæœæœ€å·®ï¼Œå®ƒå°†äº‹åŠ¡çš„æ‰§è¡Œå˜ä¸ºé¡ºåºæ‰§è¡Œï¼Œä¸å…¶ä»–ä¸‰ä¸ªéš”ç¦»çº§åˆ«ç›¸æ¯”ï¼Œå®ƒå°±ç›¸å½“äºå•çº¿ç¨‹ï¼Œåä¸€ä¸ªäº‹åŠ¡çš„æ‰§è¡Œå¿…é¡»ç­‰å¾…å‰ä¸€ä¸ªäº‹åŠ¡ç»“æŸã€‚</p><p>äº‹åŠ¡éš”ç¦»å…¶å®å°±æ˜¯ä¸ºäº†è§£å†³ä¸Šé¢æåˆ°çš„è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»è¿™å‡ ä¸ªé—®é¢˜ï¼Œä¸‹é¢å±•ç¤ºäº† 4 ç§éš”ç¦»çº§åˆ«å¯¹è¿™ä¸‰ä¸ªé—®é¢˜çš„è§£å†³ç¨‹åº¦</p><p>| <strong>éš”ç¦»çº§åˆ«</strong>               | <strong>è„è¯»</strong> | <strong>ä¸å¯é‡å¤è¯»</strong> | <strong>å¹»è¯»</strong> |<br>| â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” | â€”â€”â€”â€” | â€”â€”â€”â€”â€”â€”â€” | â€”â€”â€”â€” |<br>| è¯»æœªæäº¤(Read uncommitted) | å¯èƒ½     | å¯èƒ½           | å¯èƒ½     |<br>| è¯»æäº¤(Read committed)     | ä¸å¯èƒ½   | å¯èƒ½           | å¯èƒ½     |<br>| å¯é‡å¤è¯»(Repeatable reads) | ä¸å¯èƒ½   | ä¸å¯èƒ½         | å¯èƒ½     |<br>| ä¸²è¡ŒåŒ–(Serializable)       | ä¸å¯èƒ½   | ä¸å¯èƒ½         | ä¸å¯èƒ½   |</p></li></ol><p>MySQL äº‹åŠ¡éš”ç¦»å…¶å®æ˜¯ä¾é é”æ¥å®ç°çš„ï¼ŒåŠ é”è‡ªç„¶ä¼šå¸¦æ¥æ€§èƒ½çš„æŸå¤±ã€‚è€Œè¯»æœªæäº¤éš”ç¦»çº§åˆ«æ˜¯ä¸åŠ é”çš„ï¼Œæ‰€ä»¥å®ƒçš„æ€§èƒ½æ˜¯æœ€å¥½çš„ï¼Œæ²¡æœ‰åŠ é”ã€è§£é”å¸¦æ¥çš„æ€§èƒ½å¼€é”€ã€‚ä½†æœ‰åˆ©å°±æœ‰å¼Šï¼Œè¿™åŸºæœ¬ä¸Šå°±ç›¸å½“äºè£¸å¥”å•Šï¼Œæ‰€ä»¥å®ƒè¿è„è¯»çš„é—®é¢˜éƒ½æ²¡åŠæ³•è§£å†³ã€‚</p><h3 id="ä¸ƒ-äº‹åŠ¡éš”ç¦»çº§åˆ«åŸç†-MVCC"><a href="#ä¸ƒ-äº‹åŠ¡éš”ç¦»çº§åˆ«åŸç†-MVCC" class="headerlink" title="ä¸ƒ.äº‹åŠ¡éš”ç¦»çº§åˆ«åŸç†-MVCC"></a>ä¸ƒ.äº‹åŠ¡éš”ç¦»çº§åˆ«åŸç†-MVCC</h3><ol><li><h4 id="åˆ©ç”¨çš„æ˜¯é”å’ŒMVCCæœºåˆ¶"><a href="#åˆ©ç”¨çš„æ˜¯é”å’ŒMVCCæœºåˆ¶" class="headerlink" title="åˆ©ç”¨çš„æ˜¯é”å’ŒMVCCæœºåˆ¶"></a>åˆ©ç”¨çš„æ˜¯é”å’ŒMVCCæœºåˆ¶</h4><p><strong>MVCC</strong>çš„å…¨ç§°æ˜¯<strong>â€œå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶â€</strong>(Multi Version Concurrency Control),ã€‚è¿™é¡¹æŠ€æœ¯ä½¿å¾—InnoDBçš„äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸‹æ‰§è¡Œä¸€è‡´æ€§è¯»æ“ä½œæœ‰äº†ä¿è¯ï¼Œæ¢è¨€ä¹‹ï¼Œå°±æ˜¯ä¸ºäº†æŸ¥è¯¢ä¸€äº›æ­£åœ¨è¢«å¦ä¸€ä¸ªäº‹åŠ¡æ›´æ–°çš„è¡Œï¼Œå¹¶ä¸”å¯ä»¥çœ‹åˆ°å®ƒä»¬è¢«æ›´æ–°ä¹‹å‰çš„å€¼ï¼Œä¸€ä¸ªè¡Œè®°å½•æ•°æ®æœ‰å¤šä¸ªç‰ˆæœ¬å¯¹å¿«ç…§æ•°æ®ï¼Œè¿™äº›<strong>å¿«ç…§æ•°æ®åœ¨undo logä¸­</strong>ã€‚ å¦‚æœä¸€ä¸ªäº‹åŠ¡è¯»å–çš„è¡Œæ­£åœ¨åšDELELEæˆ–è€…UPDATEæ“ä½œï¼Œè¯»å–æ“ä½œä¸ä¼šç­‰è¡Œä¸Šçš„é”é‡Šæ”¾ï¼Œè€Œæ˜¯<strong>è¯»å–è¯¥è¡Œçš„å¿«ç…§ç‰ˆæœ¬</strong>ã€‚</p><p>è¿™æ˜¯ä¸€ä¸ªå¯ä»¥ç”¨æ¥<strong>å¢å¼ºå¹¶å‘æ€§</strong>çš„å¼ºå¤§çš„æŠ€æœ¯ï¼Œå› ä¸ºè¿™æ ·çš„ä¸€æ¥çš„è¯æŸ¥è¯¢å°±ä¸ç”¨ç­‰å¾…å¦ä¸€ä¸ªäº‹åŠ¡é‡Šæ”¾é”ã€‚è¿™é¡¹æŠ€æœ¯åœ¨æ•°æ®åº“é¢†åŸŸå¹¶ä¸æ˜¯æ™®éä½¿ç”¨çš„ã€‚ä¸€äº›å…¶å®ƒçš„æ•°æ®åº“äº§å“ï¼Œä»¥åŠ<code>mysql</code>å…¶å®ƒçš„å­˜å‚¨å¼•æ“å¹¶ä¸æ”¯æŒå®ƒã€‚</p><p>å¯é‡å¤è¯»æ˜¯åœ¨äº‹åŠ¡å¼€å§‹çš„æ—¶å€™ç”Ÿæˆä¸€ä¸ªå½“å‰äº‹åŠ¡å…¨å±€æ€§çš„å¿«ç…§ï¼Œè€Œè¯»æäº¤åˆ™æ˜¯æ¯æ¬¡æ‰§è¡Œè¯­å¥çš„æ—¶å€™éƒ½é‡æ–°ç”Ÿæˆä¸€æ¬¡å¿«ç…§ã€‚</p></li></ol><h3 id="å…«-ä¸¢å¤±æ›´æ–°é—®é¢˜"><a href="#å…«-ä¸¢å¤±æ›´æ–°é—®é¢˜" class="headerlink" title="å…«.ä¸¢å¤±æ›´æ–°é—®é¢˜"></a>å…«.ä¸¢å¤±æ›´æ–°é—®é¢˜</h3><p>è„è¯»ï¼Œå¹»è¯»ï¼Œä¸å¯é‡å¤è¯»ï¼Œéƒ½æ˜¯å‘ç”Ÿåœ¨ä¸€ä¸ªäº‹åŠ¡åœ¨å†™ï¼Œä¸€ä¸ªäº‹åŠ¡åœ¨è¯»çš„æ—¶å€™å‡ºç°çš„é—®é¢˜ï¼Œè€Œä¸¢å¤±æ›´æ–°å‘ç”Ÿåœ¨ä¸¤ä¸ªäº‹åŠ¡éƒ½åœ¨åšå†™æ“ä½œçš„æ—¶å€™å‡ºç°çš„ï¼Œä¸¢å¤±æ›´æ–°åˆ†ä¸ºï¼š<strong>å›æ»šä¸¢å¤±æ›´æ–°(ä¸€ç±»)å’Œè¦†ç›–ä¸¢å¤±æ›´æ–°(äºŒç±»)</strong></p><ul><li>ç¬¬ä¸€ç±»ä¸¢å¤±æ›´æ–°(å›æ»šä¸¢å¤±ï¼ŒLost update) ï¼ˆé€šè¿‡è®¾ç½®éš”ç¦»çº§åˆ«å¯ä»¥é˜²æ­¢ Repeatable Readï¼‰</li><li>ç¬¬äºŒç±»ä¸¢å¤±æ›´æ–°(è¦†ç›–ä¸¢å¤±/ä¸¤æ¬¡æ›´æ–°é—®é¢˜ï¼ŒSecond lost update) Aäº‹åŠ¡è¦†ç›–Bäº‹åŠ¡å·²ç»æäº¤çš„æ•°æ®ï¼Œé€ æˆBäº‹åŠ¡æ‰€åšæ“ä½œä¸¢å¤±</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;ä¸€-ä»€ä¹ˆæ˜¯äº‹åŠ¡&quot;&gt;&lt;a href=&quot;#ä¸€-ä»€ä¹ˆæ˜¯äº‹åŠ¡&quot; class=&quot;headerlink&quot; title=&quot;ä¸€.ä»€ä¹ˆæ˜¯äº‹åŠ¡&quot;&gt;&lt;/a&gt;ä¸€.ä»€ä¹ˆæ˜¯äº‹åŠ¡&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;äº‹åŠ¡:&lt;/strong&gt; æŒ‡ä½œä¸ºå•ä¸ªé€»è¾‘å·¥ä½œå•å…ƒ(Serviceæ–¹æ³•)æ‰§è¡Œçš„ä¸€ç³»åˆ—æ“</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>å›¾å½¢éªŒè¯ç çš„ä½¿ç”¨è¯¦æƒ…</title>
    <link href="https://www.fomal.cc/posts/a48e7149.html"/>
    <id>https://www.fomal.cc/posts/a48e7149.html</id>
    <published>2025-05-20T08:38:30.637Z</published>
    <updated>2022-09-29T14:17:46.212Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ä¸€-å…³äºjsçš„å¯åŠ¨æœåŠ¡"><a href="#ä¸€-å…³äºjsçš„å¯åŠ¨æœåŠ¡" class="headerlink" title="ä¸€. å…³äºjsçš„å¯åŠ¨æœåŠ¡"></a>ä¸€. å…³äºjsçš„å¯åŠ¨æœåŠ¡</h3><p>ä¼ ç»Ÿå¯¼å…¥jså¼€å‘çš„æ¨¡å¼æ²¡æ³•ç›´æ¥æœåŠ¡å™¨æ–¹å¼è°ƒè¯•ï¼Œéœ€è¦å®‰è£…live-serveræœåŠ¡å™¨ï¼Œè¿™ä¸ªæœåŠ¡å™¨å°±æ˜¯nodeä¸€ä¸ªæ¨¡å—</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å®‰è£…ï¼šnpm install -g live-server</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŒ‡å®šç«¯å£80</span> </span><br><span class="line">å¯åŠ¨é¡¹ç›®ï¼šlive-server --port=80 </span><br><span class="line">æ³¨æ„ï¼šlive-serveræœåŠ¡å™¨è‡ªå¸¦çƒ­åˆ·æ–°</span><br></pre></td></tr></table></figure><h3 id="äºŒ-ä½¿ç”¨å›¾å½¢éªŒè¯ç "><a href="#äºŒ-ä½¿ç”¨å›¾å½¢éªŒè¯ç " class="headerlink" title="äºŒ. ä½¿ç”¨å›¾å½¢éªŒè¯ç "></a>äºŒ. ä½¿ç”¨å›¾å½¢éªŒè¯ç </h3><h4 id="1-å‰ç«¯ä»£ç "><a href="#1-å‰ç«¯ä»£ç " class="headerlink" title="1. å‰ç«¯ä»£ç "></a>1. å‰ç«¯ä»£ç </h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;user-phone&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;imageCode&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;am-icon-check am-icon-sm&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 180px;&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;phoneUserForm.imageCode&quot;</span> <span class="attr">id</span>=<span class="string">&quot;imageCode&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;è¯·è¾“å…¥å›¾ç‰‡éªŒè¯ç &quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">id</span>=<span class="string">&quot;captcha-image-temp&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;getImageCode&quot;</span><span class="attr">:src</span>=<span class="string">&quot;base64ImageCode&quot;</span>  <span class="attr">class</span>=<span class="string">&quot;captcha-image-temp&quot;</span>  <span class="attr">alt</span>=<span class="string">&quot;ç‚¹å‡»æ¢å›¾&quot;</span> <span class="attr">title</span>=<span class="string">&quot;ç‚¹å‡»æ¢å›¾&quot;</span> <span class="attr">style</span>=<span class="string">&quot;vertical-align: middle; cursor: pointer;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="2-æµç¨‹åˆ†æ"><a href="#2-æµç¨‹åˆ†æ" class="headerlink" title="2. æµç¨‹åˆ†æ"></a>2. æµç¨‹åˆ†æ</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">1. å‰ç«¯é¡µé¢ä¸€åŠ è½½æˆ–ç‚¹å‡»é‡æ–°è·å–ä½¿ç”¨axioså‘é€å¼‚æ­¥è¯·æ±‚è·å–éªŒè¯ç </span><br><span class="line">2. åç«¯ç”Ÿæˆå›¾å½¢éªŒè¯ç ï¼Œå¹¶å°†éªŒè¯ç ä¿å­˜åœ¨redis</span><br><span class="line">3. åç«¯ä½¿ç”¨Base64å°†å›¾ç‰‡ç¼–ç æˆå­—ç¬¦ä¸²ï¼Œå“åº”ç»™å‰ç«¯</span><br><span class="line">4. å‰ç«¯ä½¿ç”¨vueæŒ‡ä»¤base64ç¼–ç ä¹‹åçš„å­—ç¬¦ä¸²æ”¾åœ¨å¯¹åº”ä½ç½®ï¼Œæœ€ç»ˆæ˜¾ç¤ºå›¾ç‰‡</span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;è¿™é‡Œ&quot;</span>/&gt;</span></span><br><span class="line">5. åœ¨ç‚¹å‡»è·å–æ‰‹æœºéªŒè¯ç çš„æ—¶å€™éªŒè¯å›¾å½¢éªŒè¯ç æ˜¯å¦æ­£ç¡®</span><br><span class="line">é˜²æ­¢éæ³•äººå‘˜é€šè¿‡è„šæœ¬æ¶æ„ç‚¹å‡»è·å–æ‰‹æœºéªŒè¯ç </span><br><span class="line"></span><br><span class="line">åç«¯redisæ€ä¹ˆä¿å­˜å›¾å½¢éªŒè¯ç ï¼Ÿ</span><br><span class="line">1. è®¾ç½®è¿‡æœŸæ—¶é—´ - ç®€å•</span><br><span class="line">2. keyï¼šUUID - éœ€è¦åœ¨å‰åç«¯ä¹‹é—´è¿›è¡Œä¼ è¾“ã€‚æµè§ˆå™¨çš„localStorageä¿å­˜</span><br><span class="line">   valueï¼šéªŒè¯ç </span><br></pre></td></tr></table></figure><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">1.</span> è¯·æ±‚å›¾ç‰‡éªŒè¯ç ä¹‹å‰åˆ¤æ–­localStorageæ˜¯å¦æœ‰KEYï¼Œå¦‚æœæ²¡å°±åˆ›å»ºï¼Œç„¶åä¿å­˜åˆ°localStorageï¼Œå¦‚æœæœ‰è‡ªå·±ç›´æ¥ä½œä¸ºå‚æ•°å‘é€Ajaxè¯·æ±‚è·å–å›¾ç‰‡éªŒè¯ç </span><br><span class="line"><span class="bullet">2.</span> å‰ç«¯é€šè¿‡ajaxå‘é€ä¸€ä¸ªå›¾ç‰‡éªŒè¯ç è¯·æ±‚ï¼Œæºå¸¦è€…KEY</span><br><span class="line"><span class="bullet">3.</span> åç«¯æ”¶åˆ°è¯·æ±‚ï¼Œç”ŸæˆéªŒè¯ç çš„å€¼</span><br><span class="line"><span class="bullet">4.</span> æŠŠéªŒè¯ç çš„å­˜å‚¨åˆ°Redisï¼Œä»¥å‰æ®µä¼ å…¥çš„keyä½œä¸ºRedisçš„key</span><br><span class="line"><span class="bullet">5.</span> æŠŠéªŒè¯ç åˆå¹¶åˆ°ä¸€ä¸ªå›¾ç‰‡ä¸­</span><br><span class="line"><span class="bullet">6.</span> æŠŠå›¾ç‰‡åŸºäºBase64ç¼–ç å±‚å­—ç¬¦ä¸²ï¼Œå“åº”ç»™å‰ç«¯</span><br><span class="line"><span class="bullet">7.</span> å‰ç«¯æ‹¿åˆ°base64å­—ç¬¦ä¸²ï¼Œè¿›è¡Œå›¾ç‰‡çš„å±•ç¤ºï¼Œç”¨æˆ·è¾“å…¥å›¾ç‰‡éªŒè¯ç </span><br><span class="line"></span><br><span class="line">æ ¡éªŒè¿‡ç¨‹ï¼šå‰å°æäº¤æ³¨å†Œè¯·æ±‚ ï¼ŒéªŒè¯å›¾ç‰‡éªŒè¯ç (keyä¹Ÿè¦æºå¸¦)ï¼Œåç«¯æŠŠå‰ç«¯ä¼ å…¥çš„å›¾ç‰‡éªŒè¯ç çš„å€¼å’ŒRedisä¸­çš„å›¾ç‰‡éªŒè¯ç çš„å€¼åšæ¯”è¾ƒ </span><br></pre></td></tr></table></figure><h4 id="3-å‰ç«¯å­˜å‚¨æ•°æ®"><a href="#3-å‰ç«¯å­˜å‚¨æ•°æ®" class="headerlink" title="3.  å‰ç«¯å­˜å‚¨æ•°æ®"></a>3.  å‰ç«¯å­˜å‚¨æ•°æ®</h4><p><strong><code>sessionStorage</code></strong>ï¼šå­˜æ”¾çš„æ•°æ®åªåœ¨å½“å‰çª—å£æœ‰æ•ˆã€‚åŸºæœ¬ä¸ç”¨ã€‚ä¸å¯ä»¥è·¨çª—å£ï¼›<br><strong><code>localStorage</code></strong>ï¼šæŒä¹…åŒ–å­˜å‚¨ã€‚åªè¦ä¸åˆ é™¤ï¼Œåœ¨å½“å‰æµè§ˆå™¨æ°¸è¿œæœ‰æ•ˆã€‚å¯ä»¥è·¨çª—å£ï¼Œä¸èƒ½è·¨æµè§ˆå™¨ã€‚ä½†æ˜¯ä¸åŒçš„åŸŸåå…±äº«æ•°æ®çš„ï¼Œå³åœ¨åå°ç³»ç»Ÿä¿å­˜åœ¨<code>localStorage</code>çš„æ•°æ®åœ¨å‰å°ç³»ç»Ÿæ˜¯è·å–ä¸åˆ°çš„ã€‚</p><h4 id="4-å‰ç«¯åŠŸèƒ½ä»£ç "><a href="#4-å‰ç«¯åŠŸèƒ½ä»£ç " class="headerlink" title="4. å‰ç«¯åŠŸèƒ½ä»£ç "></a>4. å‰ç«¯åŠŸèƒ½ä»£ç </h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    new Vue(&#123;</span><br><span class="line">        el: &#x27;#app&#x27;,</span><br><span class="line">        data: &#123;</span><br><span class="line">            base64ImageCode: &#x27;&#x27;, //è·å–å›¾å½¢éªŒè¯ç å“åº”ä¸€ä¸ªbase64ä½çš„å­—ç¬¦ä¸²</span><br><span class="line">            base64ImageCodePrefix: &#x27;data:image/jpeg;base64,&#x27;,</span><br><span class="line">            phoneUserForm: &#123;</span><br><span class="line">                imageCode: &#x27;&#x27;</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">        methods: &#123;</span><br><span class="line">            //ç”Ÿæˆéšæœºå›¾å½¢éªŒè¯ç çš„key</span><br><span class="line">            createUUID() &#123;</span><br><span class="line">                let s = [];</span><br><span class="line">                let hexDigits = &quot;0123456789abcdefghi&quot;;</span><br><span class="line">                for (let i = 0; i &lt; 36; i++) &#123;</span><br><span class="line">                    s[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);</span><br><span class="line">                &#125;</span><br><span class="line">                s[14] = &quot;4&quot;; // bits 12-15 of the time_hi_and_version field to 0010</span><br><span class="line">                s[19] = hexDigits.substr((s[19] &amp; 0x3) | 0x8, 1); // bits 6-7 of the clock_seq_hi_and_reserved to 01</span><br><span class="line">                s[8] = s[13] = s[18] = s[23] = &quot;-&quot;;</span><br><span class="line">                let uuid = s.join(&quot;&quot;);</span><br><span class="line">                return uuid;</span><br><span class="line">            &#125;,</span><br><span class="line">            // è·å–å›¾å½¢éªŒè¯ç </span><br><span class="line">            getImageCode() &#123;</span><br><span class="line">                //è·å–localhostçš„é”®å€¼ verifyCodeKey</span><br><span class="line">                let key = localStorage.getItem(&#x27;verifyCodeKey&#x27;)</span><br><span class="line">                if (!key) &#123;// å¦‚æœkeyä¸å­˜åœ¨å°±é‡æ–°ç”Ÿæˆå­˜å‚¨åˆ°æœ¬åœ°</span><br><span class="line">                    key = this.createUUID();</span><br><span class="line">                    localStorage.setItem(&#x27;verifyCodeKey&#x27;, key)</span><br><span class="line">                &#125;</span><br><span class="line">                //å‘é€å¼‚æ­¥è¯·æ±‚è·å–base64ç¼–ç </span><br><span class="line">                this.$http.get(&#x27;/verifyCode/image/&#x27; + key).then((res) =&gt; &#123;</span><br><span class="line">                    // åœ¨å›è°ƒå‡½æ•°è·å–å“åº”çš„æ•°æ®ä¸æ‹¼æ¥å‰ç¼€ ç»‘å®šåˆ°src</span><br><span class="line">                    this.base64ImageCode = this.base64ImageCodePrefix + res.data.msg</span><br><span class="line">                &#125;).catch(() =&gt; &#123;</span><br><span class="line">                    alert(&#x27;æœåŠ¡å™¨ç¹å¿™ï¼Œè¯·ç¨åå†è¯•ï¼ï¼ï¼&#x27;)</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        mounted() &#123;</span><br><span class="line">            this.getImageCode();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h4 id="5-åç«¯ä¸šåŠ¡å®ç°"><a href="#5-åç«¯ä¸šåŠ¡å®ç°" class="headerlink" title="5. åç«¯ä¸šåŠ¡å®ç°"></a>5. åç«¯ä¸šåŠ¡å®ç°</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">VerifyCodeServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">VerifyCodeService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> StringRedisTemplate stringRedisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">getImgCode</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="comment">// è·å–éšæœºéªŒè¯ç é•¿åº¦ä¸º4</span></span><br><span class="line">        <span class="keyword">final</span> <span class="type">String</span> <span class="variable">code</span> <span class="operator">=</span> VerifyCodeUtils.generateVerifyCode(<span class="number">4</span>);</span><br><span class="line">        <span class="comment">// å°†éªŒè¯ç çš„å€¼å­˜å…¥redisä¸­ æœ‰æ•ˆæœŸäº”åˆ†é’Ÿ</span></span><br><span class="line">        stringRedisTemplate.opsForValue().set(<span class="string">&quot;cache:code:image:&quot;</span> + key, code, <span class="number">5L</span>, TimeUnit.MINUTES);</span><br><span class="line">        <span class="comment">// æŠŠéªŒè¯ç çš„å€¼åˆå¹¶åˆ°å›¾ç‰‡ï¼Œè®¾ç½®å®½åº¦å’Œé«˜åº¦ ä½¿ç”¨Base64ç¼–ç ã€‚å¹¶è¿”å›base64ç¼–ç çš„å­—ç¬¦ä¸²</span></span><br><span class="line">        <span class="keyword">return</span> Result.success(VerifyCodeUtils.verifyCode(<span class="number">115</span>, <span class="number">40</span>, code));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="6-ç”Ÿæˆå›¾å½¢éªŒè¯ç å·¥å…·ç±»"><a href="#6-ç”Ÿæˆå›¾å½¢éªŒè¯ç å·¥å…·ç±»" class="headerlink" title="6. ç”Ÿæˆå›¾å½¢éªŒè¯ç å·¥å…·ç±»"></a>6. ç”Ÿæˆå›¾å½¢éªŒè¯ç å·¥å…·ç±»</h4><p>â‘ <code>VerifyCodeUtils</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> io.coderyeah.basic.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.coderyeah.basic.exception.BusinessException;</span><br><span class="line"><span class="keyword">import</span> sun.misc.BASE64Encoder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.imageio.ImageIO;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.geom.AffineTransform;</span><br><span class="line"><span class="keyword">import</span> java.awt.image.BufferedImage;</span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">VerifyCodeUtils</span> &#123;</span><br><span class="line">    <span class="comment">//ä½¿ç”¨åˆ°Algerianå­—ä½“ï¼Œç³»ç»Ÿé‡Œæ²¡æœ‰çš„è¯éœ€è¦å®‰è£…å­—ä½“ï¼Œå­—ä½“åªæ˜¾ç¤ºå¤§å†™ï¼Œå»æ‰äº†1,0,i,oå‡ ä¸ªå®¹æ˜“æ··æ·†çš„å­—ç¬¦</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">VERIFY_CODES</span> <span class="operator">=</span> <span class="string">&quot;23456789ABCDEFGHJKLMNPQRSTUVWXYZ&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä½¿ç”¨ç³»ç»Ÿé»˜è®¤å­—ç¬¦æºç”ŸæˆéªŒè¯ç </span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> verifySize éªŒè¯ç é•¿åº¦</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">generateVerifyCode</span><span class="params">(<span class="type">int</span> verifySize)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> generateVerifyCode(verifySize, VERIFY_CODES);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä½¿ç”¨æŒ‡å®šæºç”ŸæˆéªŒè¯ç </span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> verifySize éªŒè¯ç é•¿åº¦</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sources    éªŒè¯ç å­—ç¬¦æº</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">generateVerifyCode</span><span class="params">(<span class="type">int</span> verifySize, String sources)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (sources == <span class="literal">null</span> || sources.length() == <span class="number">0</span>) &#123;</span><br><span class="line">            sources = VERIFY_CODES;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">codesLen</span> <span class="operator">=</span> sources.length();</span><br><span class="line">        <span class="type">Random</span> <span class="variable">rand</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>(System.currentTimeMillis());</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">verifyCode</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>(verifySize);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; verifySize; i++) &#123;</span><br><span class="line">            verifyCode.append(sources.charAt(rand.nextInt(codesLen - <span class="number">1</span>)));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> verifyCode.toString();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¾“å‡ºæŒ‡å®šéªŒè¯ç å›¾ç‰‡æµ</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">outputImage</span><span class="params">(<span class="type">int</span> w, <span class="type">int</span> h, OutputStream os, String code)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">verifySize</span> <span class="operator">=</span> code.length();</span><br><span class="line">        <span class="type">BufferedImage</span> <span class="variable">image</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedImage</span>(w, h, BufferedImage.TYPE_INT_RGB);</span><br><span class="line">        <span class="type">Random</span> <span class="variable">rand</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line">        <span class="type">Graphics2D</span> <span class="variable">g2</span> <span class="operator">=</span> image.createGraphics();</span><br><span class="line">        g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);</span><br><span class="line">        Color[] colors = <span class="keyword">new</span> <span class="title class_">Color</span>[<span class="number">5</span>];</span><br><span class="line">        Color[] colorSpaces = <span class="keyword">new</span> <span class="title class_">Color</span>[]&#123;Color.WHITE, Color.CYAN,</span><br><span class="line">                Color.GRAY, Color.LIGHT_GRAY, Color.MAGENTA, Color.ORANGE,</span><br><span class="line">                Color.PINK, Color.YELLOW&#125;;</span><br><span class="line">        <span class="type">float</span>[] fractions = <span class="keyword">new</span> <span class="title class_">float</span>[colors.length];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; colors.length; i++) &#123;</span><br><span class="line">            colors[i] = colorSpaces[rand.nextInt(colorSpaces.length)];</span><br><span class="line">            fractions[i] = rand.nextFloat();</span><br><span class="line">        &#125;</span><br><span class="line">        Arrays.sort(fractions);</span><br><span class="line"> </span><br><span class="line">        g2.setColor(Color.GRAY);<span class="comment">// è®¾ç½®è¾¹æ¡†è‰²</span></span><br><span class="line">        g2.fillRect(<span class="number">0</span>, <span class="number">0</span>, w, h);</span><br><span class="line"> </span><br><span class="line">        <span class="type">Color</span> <span class="variable">c</span> <span class="operator">=</span> getRandColor(<span class="number">200</span>, <span class="number">250</span>);</span><br><span class="line">        g2.setColor(c);<span class="comment">// è®¾ç½®èƒŒæ™¯è‰²</span></span><br><span class="line">        g2.fillRect(<span class="number">0</span>, <span class="number">2</span>, w, h - <span class="number">4</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//ç»˜åˆ¶å¹²æ‰°çº¿</span></span><br><span class="line">        <span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line">        g2.setColor(getRandColor(<span class="number">160</span>, <span class="number">200</span>));<span class="comment">// è®¾ç½®çº¿æ¡çš„é¢œè‰²</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">20</span>; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">x</span> <span class="operator">=</span> random.nextInt(w - <span class="number">1</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">y</span> <span class="operator">=</span> random.nextInt(h - <span class="number">1</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">xl</span> <span class="operator">=</span> random.nextInt(<span class="number">6</span>) + <span class="number">1</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">yl</span> <span class="operator">=</span> random.nextInt(<span class="number">12</span>) + <span class="number">1</span>;</span><br><span class="line">            g2.drawLine(x, y, x + xl + <span class="number">40</span>, y + yl + <span class="number">20</span>);</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="comment">// æ·»åŠ å™ªç‚¹</span></span><br><span class="line">        <span class="type">float</span> <span class="variable">yawpRate</span> <span class="operator">=</span> <span class="number">0.05f</span>;<span class="comment">// å™ªå£°ç‡</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">area</span> <span class="operator">=</span> (<span class="type">int</span>) (yawpRate * w * h);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; area; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">x</span> <span class="operator">=</span> random.nextInt(w);</span><br><span class="line">            <span class="type">int</span> <span class="variable">y</span> <span class="operator">=</span> random.nextInt(h);</span><br><span class="line">            <span class="type">int</span> <span class="variable">rgb</span> <span class="operator">=</span> getRandomIntColor();</span><br><span class="line">            image.setRGB(x, y, rgb);</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        shear(g2, w, h, c);<span class="comment">// ä½¿å›¾ç‰‡æ‰­æ›²</span></span><br><span class="line"> </span><br><span class="line">        g2.setColor(getRandColor(<span class="number">100</span>, <span class="number">160</span>));</span><br><span class="line">        <span class="type">int</span> <span class="variable">fontSize</span> <span class="operator">=</span> h - <span class="number">4</span>;</span><br><span class="line">        <span class="type">Font</span> <span class="variable">font</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Font</span>(<span class="string">&quot;Algerian&quot;</span>, Font.ITALIC, fontSize);</span><br><span class="line">        g2.setFont(font);</span><br><span class="line">        <span class="type">char</span>[] chars = code.toCharArray();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; verifySize; i++) &#123;</span><br><span class="line">            <span class="type">AffineTransform</span> <span class="variable">affine</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AffineTransform</span>();</span><br><span class="line">            affine.setToRotation(Math.PI / <span class="number">4</span> * rand.nextDouble() * (rand.nextBoolean() ? <span class="number">1</span> : -<span class="number">1</span>), (w / verifySize) * i + fontSize / <span class="number">2</span>, h / <span class="number">2</span>);</span><br><span class="line">            g2.setTransform(affine);</span><br><span class="line">            g2.drawChars(chars, i, <span class="number">1</span>, ((w - <span class="number">10</span>) / verifySize) * i + <span class="number">5</span>, h / <span class="number">2</span> + fontSize / <span class="number">2</span> - <span class="number">10</span>);</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        g2.dispose();</span><br><span class="line">        ImageIO.write(image, <span class="string">&quot;jpg&quot;</span>, os);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Color <span class="title function_">getRandColor</span><span class="params">(<span class="type">int</span> fc, <span class="type">int</span> bc)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (fc &gt; <span class="number">255</span>)</span><br><span class="line">            fc = <span class="number">255</span>;</span><br><span class="line">        <span class="keyword">if</span> (bc &gt; <span class="number">255</span>)</span><br><span class="line">            bc = <span class="number">255</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">r</span> <span class="operator">=</span> fc + random.nextInt(bc - fc);</span><br><span class="line">        <span class="type">int</span> <span class="variable">g</span> <span class="operator">=</span> fc + random.nextInt(bc - fc);</span><br><span class="line">        <span class="type">int</span> <span class="variable">b</span> <span class="operator">=</span> fc + random.nextInt(bc - fc);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Color</span>(r, g, b);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">getRandomIntColor</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">int</span>[] rgb = getRandomRgb();</span><br><span class="line">        <span class="type">int</span> <span class="variable">color</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> c : rgb) &#123;</span><br><span class="line">            color = color &lt;&lt; <span class="number">8</span>;</span><br><span class="line">            color = color | c;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> color;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span>[] getRandomRgb() &#123;</span><br><span class="line">        <span class="type">int</span>[] rgb = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">3</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">            rgb[i] = random.nextInt(<span class="number">255</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> rgb;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">shear</span><span class="params">(Graphics g, <span class="type">int</span> w1, <span class="type">int</span> h1, Color color)</span> &#123;</span><br><span class="line">        shearX(g, w1, h1, color);</span><br><span class="line">        shearY(g, w1, h1, color);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">shearX</span><span class="params">(Graphics g, <span class="type">int</span> w1, <span class="type">int</span> h1, Color color)</span> &#123;</span><br><span class="line"> </span><br><span class="line">        <span class="type">int</span> <span class="variable">period</span> <span class="operator">=</span> random.nextInt(<span class="number">2</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="type">boolean</span> <span class="variable">borderGap</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">frames</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">phase</span> <span class="operator">=</span> random.nextInt(<span class="number">2</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; h1; i++) &#123;</span><br><span class="line">            <span class="type">double</span> <span class="variable">d</span> <span class="operator">=</span> (<span class="type">double</span>) (period &gt;&gt; <span class="number">1</span>)</span><br><span class="line">                    * Math.sin((<span class="type">double</span>) i / (<span class="type">double</span>) period</span><br><span class="line">                    + (<span class="number">6.2831853071795862D</span> * (<span class="type">double</span>) phase)</span><br><span class="line">                    / (<span class="type">double</span>) frames);</span><br><span class="line">            g.copyArea(<span class="number">0</span>, i, w1, <span class="number">1</span>, (<span class="type">int</span>) d, <span class="number">0</span>);</span><br><span class="line">            <span class="keyword">if</span> (borderGap) &#123;</span><br><span class="line">                g.setColor(color);</span><br><span class="line">                g.drawLine((<span class="type">int</span>) d, i, <span class="number">0</span>, i);</span><br><span class="line">                g.drawLine((<span class="type">int</span>) d + w1, i, w1, i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">shearY</span><span class="params">(Graphics g, <span class="type">int</span> w1, <span class="type">int</span> h1, Color color)</span> &#123;</span><br><span class="line"> </span><br><span class="line">        <span class="type">int</span> <span class="variable">period</span> <span class="operator">=</span> random.nextInt(<span class="number">40</span>) + <span class="number">10</span>; <span class="comment">// 50;</span></span><br><span class="line"> </span><br><span class="line">        <span class="type">boolean</span> <span class="variable">borderGap</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">frames</span> <span class="operator">=</span> <span class="number">20</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">phase</span> <span class="operator">=</span> <span class="number">7</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; w1; i++) &#123;</span><br><span class="line">            <span class="type">double</span> <span class="variable">d</span> <span class="operator">=</span> (<span class="type">double</span>) (period &gt;&gt; <span class="number">1</span>)</span><br><span class="line">                    * Math.sin((<span class="type">double</span>) i / (<span class="type">double</span>) period</span><br><span class="line">                    + (<span class="number">6.2831853071795862D</span> * (<span class="type">double</span>) phase)</span><br><span class="line">                    / (<span class="type">double</span>) frames);</span><br><span class="line">            g.copyArea(i, <span class="number">0</span>, <span class="number">1</span>, h1, <span class="number">0</span>, (<span class="type">int</span>) d);</span><br><span class="line">            <span class="keyword">if</span> (borderGap) &#123;</span><br><span class="line">                g.setColor(color);</span><br><span class="line">                g.drawLine(i, (<span class="type">int</span>) d, i, <span class="number">0</span>);</span><br><span class="line">                g.drawLine(i, (<span class="type">int</span>) d + h1, i, h1);</span><br><span class="line">            &#125;</span><br><span class="line"> </span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–éšæœºéªŒè¯ç åŠå…¶åŠ å¯†å›¾ç‰‡</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">verifyCode</span><span class="params">(<span class="type">int</span> w, <span class="type">int</span> h, String code)</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//base64ç¼–ç å™¨</span></span><br><span class="line">            <span class="type">BASE64Encoder</span> <span class="variable">encoder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BASE64Encoder</span>();</span><br><span class="line">            <span class="comment">//å‡†å¤‡è¾“å‡ºæµ</span></span><br><span class="line">            <span class="type">ByteArrayOutputStream</span> <span class="variable">data</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">            <span class="comment">//ä½¿ç”¨codeç”Ÿæˆwå®½ hé«˜çš„å›¾ç‰‡ï¼Œå¹¶å°†ç»“æœå›¾ç‰‡å­˜å…¥dataæµä¸­</span></span><br><span class="line">            outputImage(w, h, data, code);</span><br><span class="line">            <span class="comment">//ä½¿ç”¨base64ç¼–ç æˆString</span></span><br><span class="line">            <span class="keyword">return</span> encoder.encode(data.toByteArray());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(<span class="string">&quot;ç”ŸæˆéªŒè¯ç å¤±è´¥ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span>  Exception&#123;</span><br><span class="line">        System.out.println(verifyCode(<span class="number">100</span>, <span class="number">30</span>, <span class="string">&quot;1234&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â‘¡<code>StrUtils</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> io.coderyeah.basic.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StrUtils</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŠŠé€—å·åˆ†éš”çš„å­—ç¬¦ä¸²è½¬æ¢å­—ç¬¦ä¸²æ•°ç»„</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> str</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String[] splitStr2StrArr(String str,String split) &#123;</span><br><span class="line">        <span class="keyword">if</span> (str != <span class="literal">null</span> &amp;&amp; !str.equals(<span class="string">&quot;&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> str.split(split);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŠŠé€—å·åˆ†éš”å­—ç¬¦ä¸²è½¬æ¢Listçš„Long</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> str</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;Long&gt; <span class="title function_">splitStr2LongArr</span><span class="params">(String str)</span> &#123;</span><br><span class="line">        String[] strings = splitStr2StrArr(str,<span class="string">&quot;,&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (strings == <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        List&lt;Long&gt; result = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (String string : strings) &#123;</span><br><span class="line">            result.add(Long.parseLong(string));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŠŠé€—å·åˆ†éš”å­—ç¬¦ä¸²è½¬æ¢Listçš„Long</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> str</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;Long&gt; <span class="title function_">splitStr2LongArr</span><span class="params">(String str,String split)</span> &#123;</span><br><span class="line">        String[] strings = splitStr2StrArr(str,split);</span><br><span class="line">        <span class="keyword">if</span> (strings == <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        List&lt;Long&gt; result = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (String string : strings) &#123;</span><br><span class="line">            result.add(Long.parseLong(string));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getRandomString</span><span class="params">(<span class="type">int</span> length)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> <span class="string">&quot;0123456789&quot;</span>;</span><br><span class="line">        <span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line">        <span class="type">StringBuffer</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; length; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">number</span> <span class="operator">=</span> random.nextInt(<span class="number">10</span>);</span><br><span class="line">            sb.append(str.charAt(number));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getComplexRandomString</span><span class="params">(<span class="type">int</span> length)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;</span>;</span><br><span class="line">        <span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line">        <span class="type">StringBuffer</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; length; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">number</span> <span class="operator">=</span> random.nextInt(<span class="number">62</span>);</span><br><span class="line">            sb.append(str.charAt(number));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">convertPropertiesToHtml</span><span class="params">(String properties)</span>&#123;</span><br><span class="line">        <span class="comment">//1:å®¹é‡:6:32GB_4:æ ·å¼:12:å¡‘æ–™å£³</span></span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        String[] propArr = properties.split(<span class="string">&quot;_&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (String props : propArr) &#123;</span><br><span class="line">            String[] valueArr = props.split(<span class="string">&quot;:&quot;</span>);</span><br><span class="line">            sBuilder.append(valueArr[<span class="number">1</span>]).append(<span class="string">&quot;:&quot;</span>).append(valueArr[<span class="number">3</span>]).append(<span class="string">&quot;&lt;br&gt;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sBuilder.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ä¸‰-æ•°æ®åº“ä¸‰èŒƒå¼"><a href="#ä¸‰-æ•°æ®åº“ä¸‰èŒƒå¼" class="headerlink" title="ä¸‰. æ•°æ®åº“ä¸‰èŒƒå¼"></a>ä¸‰. æ•°æ®åº“ä¸‰èŒƒå¼</h3><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span><span class="meta">FN</span>:</span><br><span class="line"><span class="number">1</span>. ç¬¬ä¸€èŒƒå¼ï¼šåˆ—å”¯ä¸€</span><br><span class="line">åˆ—ä¸å¯å†åˆ†ï¼Œä¿æŒåŸå­æ€§ï¼Œå…³ç³»å‹æ•°æ®åº“é»˜è®¤æ”¯æŒ</span><br><span class="line"><span class="number">2</span>. ç¬¬äºŒèŒƒå¼ï¼šè¡Œå”¯ä¸€</span><br><span class="line">æ¯ä¸€è¡Œçš„æ•°æ®è¦å”¯ä¸€åŒºåˆ†ã€‚æ€ä¹ˆåŒºåˆ†å‘¢ï¼Ÿéœ€è¦åŠ ä¸€åˆ—ä½œä¸ºæƒŸä¸€æ ‡è¯†ã€‚è¿™åˆ—è¢«ç§°ä¸ºä¸»é”®</span><br><span class="line">å¹¶ä¸”è¡Œä¸­æ¯ä¸€åˆ—æ•°æ®éƒ½ä¸ä¸»é”®ç›¸å…³</span><br><span class="line"><span class="number">3</span>. ç¬¬ä¸‰èŒƒå¼ï¼šå¦‚æœä¸€å¼ è¡¨çš„æ•°æ®èƒ½å¤Ÿé€šè¿‡å…¶ä»–è¡¨æ¨å¯¼å‡ºæ¥ï¼Œä¸åº”è¯¥å•ç‹¬è®¾è®¡ï¼Œé€šè¿‡å¤–é”®çš„æ–¹å¼å…³è”æŸ¥è¯¢å‡ºæ¥</span><br><span class="line">å‡å°‘æ•°æ®å†—ä½™</span><br><span class="line"></span><br><span class="line">æ€»ç»“ï¼šä¸‰å¤§èŒƒå¼åªæ˜¯ä¸€èˆ¬è®¾è®¡æ•°æ®åº“çš„åŸºæœ¬ç†å¿µï¼Œå¯ä»¥å»ºç«‹å†—ä½™è¾ƒå°ã€ç»“æ„åˆç†çš„æ•°æ®åº“ã€‚å¦‚æœæœ‰ç‰¹æ®Šæƒ…å†µï¼Œå½“ç„¶è¦ç‰¹æ®Šå¯¹å¾…ï¼Œæ•°æ®åº“è®¾è®¡æœ€é‡è¦çš„æ˜¯çœ‹éœ€æ±‚è·Ÿæ€§èƒ½ï¼Œéœ€æ±‚&gt;æ€§èƒ½&gt;è¡¨ç»“æ„ã€‚æ‰€ä»¥ä¸èƒ½ä¸€å‘³çš„å»è¿½æ±‚èŒƒå¼å»ºç«‹æ•°æ®åº“è¡¨</span><br><span class="line"></span><br><span class="line">å<span class="number">3</span><span class="meta">FN</span>ï¼š</span><br><span class="line">åŸåˆ™ä¸Šæ˜¯ä¸èƒ½è¿åä¸‰èŒƒå¼çš„ï¼Œä½†æ˜¯æœ‰çš„æ—¶å€™æˆ‘ä»¬ä¸ºäº†å¢å¼ºæŸ¥è¯¢æ•ˆç‡ã€ä¸ç”¨å…³è”æŸ¥è¯¢ï¼Œç›´æ¥å•è¡¨æŸ¥è¯¢ã€‘ï¼Œä¼šè®¾è®¡ä¸€äº›å†—ä½™å­—æ®µï¼Œå˜å¤šè¡¨æŸ¥è¯¢ä¸ºå•è¡¨æŸ¥è¯¢</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;ä¸€-å…³äºjsçš„å¯åŠ¨æœåŠ¡&quot;&gt;&lt;a href=&quot;#ä¸€-å…³äºjsçš„å¯åŠ¨æœåŠ¡&quot; class=&quot;headerlink&quot; title=&quot;ä¸€. å…³äºjsçš„å¯åŠ¨æœåŠ¡&quot;&gt;&lt;/a&gt;ä¸€. å…³äºjsçš„å¯åŠ¨æœåŠ¡&lt;/h3&gt;&lt;p&gt;ä¼ ç»Ÿå¯¼å…¥jså¼€å‘çš„æ¨¡å¼æ²¡æ³•ç›´æ¥æœåŠ¡å™¨æ–¹å¼è°ƒè¯•ï¼Œéœ€è¦å®‰è£…live-</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨vueçš„å¯Œæ–‡æœ¬ç¼–è¾‘å™¨æ“ä½œ</title>
    <link href="https://www.fomal.cc/posts/e714b79f.html"/>
    <id>https://www.fomal.cc/posts/e714b79f.html</id>
    <published>2025-05-20T08:38:30.633Z</published>
    <updated>2022-09-26T11:41:42.969Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ä¸€-vue-quill-edit"><a href="#ä¸€-vue-quill-edit" class="headerlink" title="ä¸€. vue-quill-edit"></a>ä¸€. vue-quill-edit</h3><h4 id="1-å®‰è£…vueçš„å¯Œæ–‡æœ¬"><a href="#1-å®‰è£…vueçš„å¯Œæ–‡æœ¬" class="headerlink" title="1. å®‰è£…vueçš„å¯Œæ–‡æœ¬"></a>1. å®‰è£…vueçš„å¯Œæ–‡æœ¬</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd å½“å‰çš„vueé¡¹ç›®è·¯å¾„</span><br><span class="line">npm install quill --save</span><br><span class="line">npm install vue-quill-editor --save</span><br></pre></td></tr></table></figure><h4 id="2-åœ¨é¡µé¢ä¸­å¼•å…¥vueçš„å¯Œæ–‡æœ¬"><a href="#2-åœ¨é¡µé¢ä¸­å¼•å…¥vueçš„å¯Œæ–‡æœ¬" class="headerlink" title="2. åœ¨é¡µé¢ä¸­å¼•å…¥vueçš„å¯Œæ–‡æœ¬"></a>2. åœ¨é¡µé¢ä¸­å¼•å…¥vueçš„å¯Œæ–‡æœ¬</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å¼•å…¥Vueçš„ueditorçš„èµ„æº</span></span><br><span class="line"><span class="keyword">import</span> &#123;quillEditor&#125; <span class="keyword">from</span> <span class="string">&quot;vue-quill-editor&quot;</span>; <span class="comment">//è°ƒç”¨ç¼–è¾‘å™¨</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;quill/dist/quill.core.css&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;quill/dist/quill.snow.css&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;quill/dist/quill.bubble.css&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> quillConfig <span class="keyword">from</span> <span class="string">&#x27;../../common/js/quill-config&#x27;</span>;</span><br></pre></td></tr></table></figure><h4 id="3-æ·»åŠ ç»„ä»¶"><a href="#3-æ·»åŠ ç»„ä»¶" class="headerlink" title="3. æ·»åŠ ç»„ä»¶"></a>3. æ·»åŠ ç»„ä»¶</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="attr">components</span>: &#123;</span><br><span class="line">        quillEditor</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//......</span></span><br></pre></td></tr></table></figure><h4 id="4-ä½¿ç”¨ç»„ä»¶"><a href="#4-ä½¿ç”¨ç»„ä»¶" class="headerlink" title="4. ä½¿ç”¨ç»„ä»¶"></a>4. ä½¿ç”¨ç»„ä»¶</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;el-form-item label=&quot;ç®€ä»‹&quot; prop=&quot;intro&quot;&gt;</span><br><span class="line">  &lt;!-- v-if=&quot;editForm.petDetail&quot; ä¿®æ”¹v-modelç»‘å®šå¯¹è±¡æŠ¥é”™é—®é¢˜ï¼Œv-ifå¯¹éœ€è¦æ˜¾ç¤ºçš„æ•°æ®åˆ¤æ–­ä¸‹ --&gt;</span><br><span class="line">  &lt;quill-editor v-model=&quot;editForm.petDetail.intro&quot; v-if=&quot;editForm.petDetail&quot;</span><br><span class="line">                :options=&quot;quillOption&quot;&gt;&lt;/quill-editor&gt;</span><br><span class="line">&lt;/el-form-item&gt;</span><br><span class="line">&lt;el-form-item label=&quot;é¢†å…»é¡»çŸ¥&quot; prop=&quot;orderNotice&quot;&gt;</span><br><span class="line">  &lt;quill-editor v-model=&quot;editForm.petDetail.adoptNotice&quot; v-if=&quot;editForm.petDetail&quot;</span><br><span class="line">                :options=&quot;quillOption&quot;&gt;&lt;/quill-editor&gt;</span><br><span class="line">&lt;/el-form-item&gt;</span><br></pre></td></tr></table></figure><h4 id="5-æ•´ä¸ªè¡¨å•"><a href="#5-æ•´ä¸ªè¡¨å•" class="headerlink" title="5. æ•´ä¸ªè¡¨å•"></a>5. æ•´ä¸ªè¡¨å•</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--ç¼–è¾‘ç•Œé¢--&gt;</span><br><span class="line">&lt;el-dialog :title=&quot;title&quot; :visible.sync=&quot;editFormVisible&quot; :close-on-click-modal=&quot;false&quot; width=&quot;60%&quot; @close=&quot;cancel&quot;&gt;</span><br><span class="line">  &lt;el-form :model=&quot;editForm&quot; label-width=&quot;80px&quot; :rules=&quot;editFormRules&quot; ref=&quot;editForm&quot;&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;å® ç‰©åç§°&quot; prop=&quot;name&quot;&gt;</span><br><span class="line">      &lt;el-input prefix-icon=&quot;el-icon-tickets&quot; v-model=&quot;editForm.name&quot; auto-complete=&quot;off&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;æˆæœ¬ä»·&quot; prop=&quot;costprice&quot;&gt;</span><br><span class="line">      &lt;el-input-number :min=&quot;0&quot; oninput=&quot;if(value&lt;0)value=0&quot; v-model.trim=&quot;editForm.costprice&quot;</span><br><span class="line">                       auto-complete=&quot;off&quot;&gt;&lt;/el-input-number&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;é”€å”®ä»·&quot; prop=&quot;saleprice&quot;&gt;</span><br><span class="line">      &lt;el-input-number :min=&quot;0&quot; oninput=&quot;if(value&lt;0)value=0&quot; v-model.trim=&quot;editForm.saleprice&quot;</span><br><span class="line">                       auto-complete=&quot;off&quot;&gt;&lt;/el-input-number&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;å® ç‰©ç±»å‹&quot; prop=&quot;type&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;block&quot;&gt;</span><br><span class="line">        &lt;el-cascader</span><br><span class="line">            v-model=&quot;editForm.typeId&quot;</span><br><span class="line">            :options=&quot;petTypeTree&quot;</span><br><span class="line">            :props=&quot;&#123; checkStrictly: true,value:&#x27;id&#x27;,label:&#x27;name&#x27; &#125;&quot;</span><br><span class="line">            clearable&gt;</span><br><span class="line">        &lt;/el-cascader&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;å® ç‰©å›¾ç‰‡&quot; prop=&quot;index&quot;&gt;</span><br><span class="line">      &lt;el-upload class=&quot;upload-demo&quot;</span><br><span class="line">                 action=&quot;http://localhost:8080/fastDfs/&quot;</span><br><span class="line">                 :on-preview=&quot;handlePreview&quot;</span><br><span class="line">                 :on-remove=&quot;handleRemove&quot;</span><br><span class="line">                 :on-success=&quot;handleSuccess&quot;</span><br><span class="line">                 :file-list=&quot;fileList&quot;</span><br><span class="line">                 list-type=&quot;picture&quot;&gt;</span><br><span class="line">        &lt;el-button size=&quot;small&quot; type=&quot;primary&quot;&gt;ç‚¹å‡»ä¸Šä¼ &lt;/el-button&gt;</span><br><span class="line">        &lt;div slot=&quot;tip&quot; class=&quot;el-upload__tip&quot;&gt;åªèƒ½ä¸Šä¼ jpg/pngæ–‡ä»¶ï¼Œä¸”ä¸è¶…è¿‡500kb&lt;/div&gt;</span><br><span class="line">      &lt;/el-upload&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;çŠ¶æ€&quot;&gt;</span><br><span class="line">      &lt;el-radio-group v-model=&quot;editForm.state&quot;&gt;</span><br><span class="line">        &lt;el-radio class=&quot;radio&quot; :label=&quot;1&quot;&gt;å¼€å¯&lt;/el-radio&gt;</span><br><span class="line">        &lt;el-radio class=&quot;radio&quot; :label=&quot;0&quot;&gt;å…³é—­&lt;/el-radio&gt;</span><br><span class="line">      &lt;/el-radio-group&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;ä¸Šæ¶æ—¶é—´&quot; prop=&quot;onsaletime&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;block&quot;&gt;</span><br><span class="line">        &lt;el-date-picker</span><br><span class="line">            value-format=&quot;yyyy-MM-dd HH:mm:ss&quot;</span><br><span class="line">            v-model=&quot;editForm.onsaletime&quot;</span><br><span class="line">            type=&quot;datetime&quot;</span><br><span class="line">            placeholder=&quot;é€‰æ‹©æ—¥æœŸæ—¶é—´&quot;</span><br><span class="line">            align=&quot;right&quot;</span><br><span class="line">            :picker-options=&quot;pickerOptions&quot;&gt;</span><br><span class="line">        &lt;/el-date-picker&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;ä¸‹æ¶æ—¶é—´&quot; prop=&quot;offsaletime&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;block&quot;&gt;</span><br><span class="line">        &lt;el-date-picker</span><br><span class="line">            value-format=&quot;yyyy-MM-dd HH:mm:ss&quot;</span><br><span class="line">            v-model=&quot;editForm.offsaletime&quot;</span><br><span class="line">            type=&quot;datetime&quot;</span><br><span class="line">            placeholder=&quot;é€‰æ‹©æ—¥æœŸæ—¶é—´&quot;</span><br><span class="line">            align=&quot;right&quot;</span><br><span class="line">            :picker-options=&quot;pickerOptions&quot;&gt;</span><br><span class="line">        &lt;/el-date-picker&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;æ‰€å±åº—é“º&quot; prop=&quot;shop&quot;&gt;</span><br><span class="line">      &lt;el-select v-model=&quot;editForm.shopId&quot; placeholder=&quot;è¯·é€‰æ‹©åº—é“º&quot; clearable&gt;</span><br><span class="line">        &lt;el-option</span><br><span class="line">            v-for=&quot;item in shops&quot;</span><br><span class="line">            :key=&quot;item.id&quot;</span><br><span class="line">            :label=&quot;item.name&quot;</span><br><span class="line">            :value=&quot;item.id&quot;&gt;</span><br><span class="line">        &lt;/el-option&gt;</span><br><span class="line">      &lt;/el-select&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;é¢†å…»äºº&quot;&gt;</span><br><span class="line">      &lt;el-select v-model=&quot;editForm.userId&quot; placeholder=&quot;è¯·é€‰æ‹©é¢†å…»äºº&quot; clearable&gt;</span><br><span class="line">        &lt;el-option</span><br><span class="line">            v-for=&quot;item in users&quot;</span><br><span class="line">            :key=&quot;item.id&quot;</span><br><span class="line">            :label=&quot;item.username&quot;</span><br><span class="line">            :value=&quot;item.id&quot;&gt;</span><br><span class="line">          &lt;span style=&quot;float: left&quot;&gt;&#123;&#123; item.username &#125;&#125;&lt;/span&gt;</span><br><span class="line">          &lt;span style=&quot;float: right; color: #8492a6; font-size: 13px&quot;&gt;&#123;&#123; item.phone &#125;&#125;&lt;/span&gt;</span><br><span class="line">        &lt;/el-option&gt;</span><br><span class="line">      &lt;/el-select&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;ç®€ä»‹&quot; prop=&quot;intro&quot;&gt;</span><br><span class="line">      &lt;!-- v-if=&quot;saveForm.petDetail&quot; ä¿®æ”¹v-modelç»‘å®šå¯¹è±¡æŠ¥é”™é—®é¢˜ï¼Œv-ifå¯¹éœ€è¦æ˜¾ç¤ºçš„æ•°æ®åˆ¤æ–­ä¸‹ --&gt;</span><br><span class="line">      &lt;quill-editor v-model=&quot;editForm.petDetail.intro&quot; v-if=&quot;editForm.petDetail&quot;</span><br><span class="line">                    :options=&quot;quillOption&quot;&gt;&lt;/quill-editor&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;é¢†å…»é¡»çŸ¥&quot; prop=&quot;orderNotice&quot;&gt;</span><br><span class="line">      &lt;quill-editor v-model=&quot;editForm.petDetail.adoptNotice&quot; v-if=&quot;editForm.petDetail&quot;</span><br><span class="line">                    :options=&quot;quillOption&quot;&gt;&lt;/quill-editor&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">  &lt;/el-form&gt;</span><br><span class="line">  &lt;div slot=&quot;footer&quot; class=&quot;dialog-footer&quot;&gt;</span><br><span class="line">    &lt;el-button @click.native=&quot;cancel&quot;&gt;å–æ¶ˆ&lt;/el-button&gt;</span><br><span class="line">    &lt;el-button type=&quot;primary&quot; @click.native=&quot;editSubmit&quot; :loading=&quot;editLoading&quot;&gt;æäº¤&lt;/el-button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/el-dialog&gt;</span><br></pre></td></tr></table></figure><h3 id="äºŒ-å¯Œæ–‡æœ¬æ•´åˆFastdfs"><a href="#äºŒ-å¯Œæ–‡æœ¬æ•´åˆFastdfs" class="headerlink" title="äºŒ. å¯Œæ–‡æœ¬æ•´åˆFastdfs"></a>äºŒ. å¯Œæ–‡æœ¬æ•´åˆFastdfs</h3><p>å›¾ç‰‡ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¿å­˜</p><p>ç¼–è¾‘å¯Œæ–‡æœ¬å†…å®¹çš„æ—¶å€™ï¼ŒåŸç”Ÿçš„å¯Œæ–‡æœ¬ï¼Œä¼šç›´æ¥å°†å›¾ç‰‡ä»¥base64ç¼–ç çš„æ–¹å¼å­˜å‚¨åœ¨é¡µé¢ä¸Šã€‚å½“ç‚¹å‡»ä¿å­˜æ—¶ï¼Œä¼šç›´æ¥å°†base64çš„æ•°æ®ç›´æ¥å­˜å‚¨åˆ°æ•°æ®åº“ï¼Œæ•°æ®åº“çš„å­—æ®µç›´æ¥å­˜å‚¨ä¸äº†ï¼Œå†…å®¹å¤ªå¤§ï¼æ‰€ä»¥éœ€è¦å°†å¯Œæ–‡æœ¬ç¼–è¾‘æ¡†é›†æˆFastDfsï¼Œå°†å›¾ç‰‡ä¸Šä¼ åˆ°FastDfsã€‚åªå­˜å‚¨å›¾ç‰‡çš„FastDfsè®¿é—®è·¯å¾„å³å¯ã€‚</p><h4 id="1-quill-config-js"><a href="#1-quill-config-js" class="headerlink" title="1. quill-config.js"></a>1. quill-config.js</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*å¯Œæ–‡æœ¬ç¼–è¾‘å›¾ç‰‡ä¸Šä¼ é…ç½®*/</span></span><br><span class="line"><span class="keyword">const</span> uploadConfig = &#123;</span><br><span class="line">    <span class="attr">fastDfsUrl</span>:<span class="string">&#x27;http://123.207.27.208&#x27;</span>,      <span class="comment">// å›¾ç‰‡è®¿é—®åœ°å€</span></span><br><span class="line">    <span class="attr">action</span>:  <span class="string">&#x27;http://localhost:8080/fastDfs&#x27;</span>, <span class="comment">// å¿…å¡«å‚æ•° å›¾ç‰‡ä¸Šä¼ åœ°å€</span></span><br><span class="line">    <span class="attr">methods</span>: <span class="string">&#x27;POST&#x27;</span>,  <span class="comment">// å¿…å¡«å‚æ•° å›¾ç‰‡ä¸Šä¼ æ–¹å¼</span></span><br><span class="line">    <span class="attr">token</span>: <span class="string">&#x27;&#x27;</span>,  <span class="comment">// å¯é€‰å‚æ•° å¦‚æœéœ€è¦tokenéªŒè¯ï¼Œå‡è®¾ä½ çš„tokenæœ‰å­˜æ”¾åœ¨sessionStorage</span></span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;file&#x27;</span>,  <span class="comment">// å¿…å¡«å‚æ•° æ–‡ä»¶çš„å‚æ•°å</span></span><br><span class="line">    <span class="attr">size</span>: <span class="number">500</span>,  <span class="comment">// å¯é€‰å‚æ•°   å›¾ç‰‡å¤§å°ï¼Œå•ä½ä¸ºKb, 1M = 1024Kb</span></span><br><span class="line">    <span class="attr">accept</span>: <span class="string">&#x27;image/png, image/gif, image/jpeg, image/bmp, image/x-icon&#x27;</span>  <span class="comment">// å¯é€‰ å¯ä¸Šä¼ çš„å›¾ç‰‡æ ¼å¼</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// toolbarå·¥å…·æ çš„å·¥å…·é€‰é¡¹ï¼ˆé»˜è®¤å±•ç¤ºå…¨éƒ¨ï¼‰</span></span><br><span class="line"><span class="keyword">const</span> toolOptions = [</span><br><span class="line">    [<span class="string">&#x27;bold&#x27;</span>, <span class="string">&#x27;italic&#x27;</span>, <span class="string">&#x27;underline&#x27;</span>, <span class="string">&#x27;strike&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;blockquote&#x27;</span>, <span class="string">&#x27;code-block&#x27;</span>],</span><br><span class="line">    [&#123;<span class="string">&#x27;header&#x27;</span>: <span class="number">1</span>&#125;, &#123;<span class="string">&#x27;header&#x27;</span>: <span class="number">2</span>&#125;],</span><br><span class="line">    [&#123;<span class="string">&#x27;list&#x27;</span>: <span class="string">&#x27;ordered&#x27;</span>&#125;, &#123;<span class="string">&#x27;list&#x27;</span>: <span class="string">&#x27;bullet&#x27;</span>&#125;],</span><br><span class="line">    [&#123;<span class="string">&#x27;script&#x27;</span>: <span class="string">&#x27;sub&#x27;</span>&#125;, &#123;<span class="string">&#x27;script&#x27;</span>: <span class="string">&#x27;super&#x27;</span>&#125;],</span><br><span class="line">    [&#123;<span class="string">&#x27;indent&#x27;</span>: <span class="string">&#x27;-1&#x27;</span>&#125;, &#123;<span class="string">&#x27;indent&#x27;</span>: <span class="string">&#x27;+1&#x27;</span>&#125;],</span><br><span class="line">    [&#123;<span class="string">&#x27;direction&#x27;</span>: <span class="string">&#x27;rtl&#x27;</span>&#125;],</span><br><span class="line">    [&#123;<span class="string">&#x27;size&#x27;</span>: [<span class="string">&#x27;small&#x27;</span>, <span class="literal">false</span>, <span class="string">&#x27;large&#x27;</span>, <span class="string">&#x27;huge&#x27;</span>]&#125;],</span><br><span class="line">    [&#123;<span class="string">&#x27;header&#x27;</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="literal">false</span>]&#125;],</span><br><span class="line">    [&#123;<span class="string">&#x27;color&#x27;</span>: []&#125;, &#123;<span class="string">&#x27;background&#x27;</span>: []&#125;],</span><br><span class="line">    [&#123;<span class="string">&#x27;font&#x27;</span>: []&#125;],</span><br><span class="line">    [&#123;<span class="string">&#x27;align&#x27;</span>: []&#125;],</span><br><span class="line">    [<span class="string">&#x27;clean&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;image&#x27;</span>, <span class="string">&#x27;video&#x27;</span>]</span><br><span class="line">];</span><br><span class="line"><span class="keyword">const</span> handlers = &#123;</span><br><span class="line">    <span class="attr">image</span>: <span class="keyword">function</span> <span class="title function_">image</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> self = <span class="variable language_">this</span>;</span><br><span class="line">        <span class="keyword">var</span> fileInput = <span class="variable language_">this</span>.<span class="property">container</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;input.ql-image[type=file]&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (fileInput === <span class="literal">null</span>) &#123;</span><br><span class="line">            fileInput = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;input&#x27;</span>);</span><br><span class="line">            fileInput.<span class="title function_">setAttribute</span>(<span class="string">&#x27;type&#x27;</span>, <span class="string">&#x27;file&#x27;</span>);</span><br><span class="line">            <span class="comment">// è®¾ç½®å›¾ç‰‡å‚æ•°å</span></span><br><span class="line">            <span class="keyword">if</span> (uploadConfig.<span class="property">name</span>) &#123;</span><br><span class="line">                fileInput.<span class="title function_">setAttribute</span>(<span class="string">&#x27;name&#x27;</span>, uploadConfig.<span class="property">name</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å¯è®¾ç½®ä¸Šä¼ å›¾ç‰‡çš„æ ¼å¼</span></span><br><span class="line">            fileInput.<span class="title function_">setAttribute</span>(<span class="string">&#x27;accept&#x27;</span>, uploadConfig.<span class="property">accept</span>);</span><br><span class="line">            fileInput.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;ql-image&#x27;</span>);</span><br><span class="line">            <span class="comment">// ç›‘å¬é€‰æ‹©æ–‡ä»¶</span></span><br><span class="line">            fileInput.<span class="title function_">addEventListener</span>(<span class="string">&#x27;change&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                <span class="comment">// åˆ›å»ºformData</span></span><br><span class="line">                <span class="keyword">var</span> formData = <span class="keyword">new</span> <span class="title class_">FormData</span>();</span><br><span class="line">                formData.<span class="title function_">append</span>(uploadConfig.<span class="property">name</span>, fileInput.<span class="property">files</span>[<span class="number">0</span>]);</span><br><span class="line">                formData.<span class="title function_">append</span>(<span class="string">&#x27;object&#x27;</span>,<span class="string">&#x27;product&#x27;</span>);</span><br><span class="line">                <span class="comment">// å¦‚æœéœ€è¦tokenä¸”å­˜åœ¨token</span></span><br><span class="line">                <span class="keyword">if</span> (uploadConfig.<span class="property">token</span>) &#123;</span><br><span class="line">                    formData.<span class="title function_">append</span>(<span class="string">&#x27;token&#x27;</span>, uploadConfig.<span class="property">token</span>)</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// å›¾ç‰‡ä¸Šä¼ </span></span><br><span class="line">                <span class="keyword">var</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">                xhr.<span class="title function_">open</span>(uploadConfig.<span class="property">methods</span>, uploadConfig.<span class="property">action</span>, <span class="literal">true</span>);</span><br><span class="line">                <span class="comment">// ä¸Šä¼ æ•°æ®æˆåŠŸï¼Œä¼šè§¦å‘</span></span><br><span class="line">                xhr.<span class="property">onload</span> = <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (xhr.<span class="property">status</span> === <span class="number">200</span>) &#123;</span><br><span class="line">                        <span class="keyword">var</span> res = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(xhr.<span class="property">responseText</span>);</span><br><span class="line">                        <span class="keyword">let</span> length = self.<span class="property">quill</span>.<span class="title function_">getSelection</span>(<span class="literal">true</span>).<span class="property">index</span>;</span><br><span class="line">                        <span class="comment">//è¿™é‡Œå¾ˆé‡è¦ï¼Œä½ å›¾ç‰‡ä¸Šä¼ æˆåŠŸåï¼Œimgçš„srcéœ€è¦åœ¨è¿™é‡Œæ·»åŠ ï¼Œres.pathå°±æ˜¯ä½ æœåŠ¡å™¨è¿”å›çš„å›¾ç‰‡é“¾æ¥ã€‚</span></span><br><span class="line">                        self.<span class="property">quill</span>.<span class="title function_">insertEmbed</span>(length, <span class="string">&#x27;image&#x27;</span>, uploadConfig.<span class="property">fastDfsUrl</span>+res.<span class="property">data</span>);</span><br><span class="line">                        self.<span class="property">quill</span>.<span class="title function_">setSelection</span>(length + <span class="number">1</span>)</span><br><span class="line">                    &#125;</span><br><span class="line">                    fileInput.<span class="property">value</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line">                &#125;;</span><br><span class="line">                <span class="comment">// å¼€å§‹ä¸Šä¼ æ•°æ®</span></span><br><span class="line">                xhr.<span class="property">upload</span>.<span class="property">onloadstart</span> = <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">                    fileInput.<span class="property">value</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line">                &#125;;</span><br><span class="line">                <span class="comment">// å½“å‘ç”Ÿç½‘ç»œå¼‚å¸¸çš„æ—¶å€™ä¼šè§¦å‘ï¼Œå¦‚æœä¸Šä¼ æ•°æ®çš„è¿‡ç¨‹è¿˜æœªç»“æŸ</span></span><br><span class="line">                xhr.<span class="property">upload</span>.<span class="property">onerror</span> = <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">                &#125;;</span><br><span class="line">                <span class="comment">// ä¸Šä¼ æ•°æ®å®Œæˆï¼ˆæˆåŠŸæˆ–è€…å¤±è´¥ï¼‰æ—¶ä¼šè§¦å‘</span></span><br><span class="line">                xhr.<span class="property">upload</span>.<span class="property">onloadend</span> = <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">                    <span class="comment">// console.log(&#x27;ä¸Šä¼ ç»“æŸ&#x27;)</span></span><br><span class="line">                &#125;;</span><br><span class="line">                xhr.<span class="title function_">send</span>(formData)</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">container</span>.<span class="title function_">appendChild</span>(fileInput);</span><br><span class="line">        &#125;</span><br><span class="line">        fileInput.<span class="title function_">click</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="attr">placeholder</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">theme</span>: <span class="string">&#x27;snow&#x27;</span>,  <span class="comment">// ä¸»é¢˜</span></span><br><span class="line">    <span class="attr">modules</span>: &#123;</span><br><span class="line">        <span class="attr">toolbar</span>: &#123;</span><br><span class="line">            <span class="attr">container</span>: toolOptions,  <span class="comment">// å·¥å…·æ é€‰é¡¹</span></span><br><span class="line">            <span class="attr">handlers</span>: handlers  <span class="comment">// äº‹ä»¶é‡å†™</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>PS:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è¿™ä¸ªjsæ–‡ä»¶ä¸­ä»¥ä¸‹3ä¸ªåœ°æ–¹éœ€è¦ä¿®æ”¹</span></span><br><span class="line"><span class="attr">fastDfsUrl</span>:<span class="string">&#x27;http://123.207.27.208&#x27;</span>,      <span class="comment">// å›¾ç‰‡è®¿é—®åœ°å€</span></span><br><span class="line"><span class="attr">action</span>:  <span class="string">&#x27;http://localhost:8080/fastDfs&#x27;</span>, <span class="comment">// å¿…å¡«å‚æ•° å›¾ç‰‡ä¸Šä¼ åœ°å€</span></span><br><span class="line">self.<span class="property">quill</span>.<span class="title function_">insertEmbed</span>(length, <span class="string">&#x27;image&#x27;</span>, uploadConfig.<span class="property">fastDfsUrl</span>+res.<span class="property">data</span>); <span class="comment">//data æœåŠ¡å™¨ç«¯å›¾ç‰‡çš„è·¯å¾„</span></span><br></pre></td></tr></table></figure><h4 id="2-å¯¼å…¥å¹¶ä½¿ç”¨"><a href="#2-å¯¼å…¥å¹¶ä½¿ç”¨" class="headerlink" title="2. å¯¼å…¥å¹¶ä½¿ç”¨"></a>2. å¯¼å…¥å¹¶ä½¿ç”¨</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> quillConfig <span class="keyword">from</span> <span class="string">&#x27;../../common/js/quill-config&#x27;</span>;</span><br><span class="line"><span class="attr">quillOption</span>: quillConfig,<span class="comment">// dataæ•°æ®æ¨¡å‹ä¸­é…ç½®</span></span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/lqs-blog/picgo/main/img/20220925232720.png" alt="image-20220925232720768"></p><h3 id="ä¸‰-å¤šå›¾ç‰‡ä¸Šä¼ "><a href="#ä¸‰-å¤šå›¾ç‰‡ä¸Šä¼ " class="headerlink" title="ä¸‰. å¤šå›¾ç‰‡ä¸Šä¼ "></a>ä¸‰. å¤šå›¾ç‰‡ä¸Šä¼ </h3><h4 id="1-æ•°æ®åº“å­˜å‚¨æ–¹å¼"><a href="#1-æ•°æ®åº“å­˜å‚¨æ–¹å¼" class="headerlink" title="1. æ•°æ®åº“å­˜å‚¨æ–¹å¼"></a>1. æ•°æ®åº“å­˜å‚¨æ–¹å¼</h4><p>ä¾‹å¦‚t_petä¸­æœ‰ä¸ªresourceså­—æ®µï¼Œä¸“é—¨ç”¨æ¥ä¿å­˜å® ç‰©ç»†èŠ‚å›¾ç‰‡çš„ï¼Œä¾‹å¦‚ï¼š</p><p><code>/group1/M00/00/0C/CgAIC2KrUU-ARA8EAAH2I5Y672k716.jpg,/group1/M00/00/0C/CgAIC2KrUYaAaR-6AADnxcxs4eA746.jpg,/group1/M00/00/0C/CgAIC2KrUYqAbjaZAAMbwtByyoU105.jpg,/group1/M00/00/0C/CgAIC2KrUY-AQcYWAAF5fdD2FCI302.jpg</code></p><p><strong>PS:é‡‡ç”¨é€—å·åˆ†éš”å¤šå¼ å›¾ç‰‡è·¯å¾„</strong></p><h4 id="2-å‰ç«¯å®ç°"><a href="#2-å‰ç«¯å®ç°" class="headerlink" title="2. å‰ç«¯å®ç°"></a>2. å‰ç«¯å®ç°</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;el-form-item label=&quot;å® ç‰©å›¾ç‰‡&quot; prop=&quot;index&quot;&gt;</span><br><span class="line">  &lt;el-upload class=&quot;upload-demo&quot;</span><br><span class="line">             action=&quot;http://localhost:8080/fastDfs/&quot;</span><br><span class="line">             :on-preview=&quot;handlePreview&quot;</span><br><span class="line">             :on-remove=&quot;handleRemove&quot;</span><br><span class="line">             :on-success=&quot;handleSuccess&quot;</span><br><span class="line">             :file-list=&quot;fileList&quot;</span><br><span class="line">             list-type=&quot;picture&quot;&gt;</span><br><span class="line">    &lt;el-button size=&quot;small&quot; type=&quot;primary&quot;&gt;ç‚¹å‡»ä¸Šä¼ &lt;/el-button&gt;</span><br><span class="line">    &lt;div slot=&quot;tip&quot; class=&quot;el-upload__tip&quot;&gt;åªèƒ½ä¸Šä¼ jpg/pngæ–‡ä»¶ï¼Œä¸”ä¸è¶…è¿‡500kb&lt;/div&gt;</span><br><span class="line">  &lt;/el-upload&gt;</span><br><span class="line">&lt;/el-form-item&gt;</span><br></pre></td></tr></table></figure><h4 id="3-æ•°æ®æ¨¡å‹"><a href="#3-æ•°æ®æ¨¡å‹" class="headerlink" title="3. æ•°æ®æ¨¡å‹"></a>3. æ•°æ®æ¨¡å‹</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç¼–è¾‘ç•Œé¢æ•°æ®</span></span><br><span class="line"><span class="attr">editForm</span>: &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="literal">null</span>,</span><br><span class="line">  <span class="attr">typeId</span>: <span class="literal">null</span>,</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="attr">state</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">resources</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="attr">saleprice</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="attr">costprice</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="attr">onsaletime</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="attr">offsaletime</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="attr">shopId</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="attr">userId</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="attr">petDetail</span>: &#123;  <span class="comment">//ä¸åç«¯å®ä½“ç±»ä¸€è‡´</span></span><br><span class="line">    <span class="attr">id</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">intro</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">adoptNotice</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h4 id="4-é€»è¾‘ä»£ç å®ç°"><a href="#4-é€»è¾‘ä»£ç å®ç°" class="headerlink" title="4. é€»è¾‘ä»£ç å®ç°"></a>4. é€»è¾‘ä»£ç å®ç°</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ–‡ä»¶ä¸Šä¼ çš„ä¸šåŠ¡é€»è¾‘</span></span><br><span class="line"><span class="title function_">handleSuccess</span>(<span class="params">response, file, fileList</span>) &#123;</span><br><span class="line">  <span class="comment">// ä¸Šä¼ å¤šå¼ å›¾ç‰‡éœ€è¦å¯¹resourcesè¿›è¡Œå¤„ç†,å¤šå¼ å›¾ç‰‡ä¿å­˜åˆ°æ•°æ®åº“çš„resourceså­—æ®µç”¨,éš”å¼€</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">editForm</span>.<span class="property">resources</span>) &#123;</span><br><span class="line">    <span class="comment">// å¯¹å·²ç»å­˜åœ¨çš„å›¾ç‰‡è¿›è¡Œæ‹¼æ¥</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">editForm</span>.<span class="property">resources</span> = <span class="variable language_">this</span>.<span class="property">editForm</span>.<span class="property">resources</span> + <span class="string">&quot;,&quot;</span> + response.<span class="property">data</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">editForm</span>.<span class="property">resources</span> = response.<span class="property">data</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">editForm</span>.<span class="property">resources</span>)</span><br><span class="line">  <span class="comment">// å¯¹fileListè¿›è¡Œå¤„ç†ï¼Œç”¨ä»¥æ˜¾ç¤ºå›¾ç‰‡</span></span><br><span class="line">  <span class="comment">// å…ˆæ¸…ç©º - è¿™ä¸ªfileListåšäº†ç»‘å®šï¼Œä»¥å‰æ˜¯æœ‰å€¼ã€å…ˆæ¸…ç©ºï¼Œå†æ·»åŠ æœ€æ–°çš„æ•°æ®ã€‘</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">fileList</span> = []</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">editForm</span>.<span class="property">resources</span>) &#123;</span><br><span class="line">    <span class="comment">// /group1/M00/00/0C/CgAIC2KrUU-ARA8EAAH2I5Y672k716.jpg,/group1/M00/00/0C/CgAIC2KrUYaAaR-6AADnxcxs4eA746.jpg å¯¹å…¶è¿›è¡Œåˆ†å‰²</span></span><br><span class="line">    <span class="keyword">let</span> arr = <span class="variable language_">this</span>.<span class="property">editForm</span>.<span class="property">resources</span>.<span class="title function_">split</span>(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">    <span class="comment">// å¾ªç¯éå†</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      <span class="comment">// ä»fastDfsæ–‡ä»¶ç³»ç»Ÿè·å–èµ„æº</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">fileList</span>.<span class="title function_">push</span>(&#123;<span class="string">&#x27;url&#x27;</span>: <span class="string">&#x27;http://123.207.27.208&#x27;</span> + arr[i]&#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ–‡ä»¶åˆ é™¤çš„ä¸šåŠ¡é€»è¾‘</span></span><br><span class="line"><span class="title function_">handleRemove</span>(<span class="params">file, fileList</span>) &#123;</span><br><span class="line">  <span class="comment">// url:&quot;http://123.207.27.208/group1/M00/01/D0/CgAIC2MwX7eAWEwlAACO89rfJDY938.jpg&quot;</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(file);</span><br><span class="line">  <span class="keyword">const</span> filePath = file.<span class="property">url</span>.<span class="title function_">substring</span>(file.<span class="property">url</span>.<span class="title function_">indexOf</span>(<span class="string">&#x27;/group&#x27;</span>))<span class="comment">// /group1/M00/01/D0/CgAIC2MwX7eAWEwlAACO89rfJDY938.jpg</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">$http</span>.<span class="title function_">delete</span>(<span class="string">&quot;/fastDfs?path=&quot;</span> + filePath)</span><br><span class="line">      .<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (res.<span class="property">data</span>.<span class="property">success</span>) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">success</span>(<span class="string">&quot;åˆ é™¤æˆåŠŸ&quot;</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">error</span>(<span class="string">&quot;åˆ é™¤å¤±è´¥&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">  <span class="comment">// åˆ é™¤ä¹‹åå¯¹resourcesåšå¤„ç†</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">editForm</span>.<span class="property">resources</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> arr = <span class="variable language_">this</span>.<span class="property">editForm</span>.<span class="property">resources</span>.<span class="title function_">split</span>(<span class="string">&#x27;,&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (arr[i] == filePath) &#123;<span class="comment">//æ‰¾åˆ°äº†åˆ é™¤çš„å›¾ç‰‡</span></span><br><span class="line">        arr.<span class="title function_">splice</span>(i, <span class="number">1</span>);<span class="comment">//åˆ é™¤æ•°ç»„ä¸­æŒ‡å®šçš„å›¾ç‰‡</span></span><br><span class="line">        <span class="comment">// è·³å‡ºå¾ªç¯</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å¯¹resourcesé‡æ–°æ‹¼æ¥</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">editForm</span>.<span class="property">resources</span> = arr.<span class="title function_">join</span>(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;åˆ é™¤åçš„resources:&quot;</span> + <span class="variable language_">this</span>.<span class="property">editForm</span>.<span class="property">resources</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å¯¹fileListè¿›è¡Œå¤„ç†ï¼Œç”¨ä»¥æ˜¾ç¤ºå›¾ç‰‡</span></span><br><span class="line">  <span class="comment">// å…ˆæ¸…ç©º - è¿™ä¸ªfileListåšäº†ç»‘å®šï¼Œä»¥å‰æ˜¯æœ‰å€¼ã€å…ˆæ¸…ç©ºï¼Œå†æ·»åŠ æœ€æ–°çš„æ•°æ®ã€‘</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">fileList</span> = []</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">editForm</span>.<span class="property">resources</span>) &#123;</span><br><span class="line">    <span class="comment">// /group1/M00/00/0C/CgAIC2KrUU-ARA8EAAH2I5Y672k716.jpg,/group1/M00/00/0C/CgAIC2KrUYaAaR-6AADnxcxs4eA746.jpg å¯¹å…¶è¿›è¡Œåˆ†å‰²</span></span><br><span class="line">    <span class="keyword">let</span> arr = <span class="variable language_">this</span>.<span class="property">editForm</span>.<span class="property">resources</span>.<span class="title function_">split</span>(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">    <span class="comment">// å¾ªç¯éå†</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      <span class="comment">// ä»fastDfsæ–‡ä»¶ç³»ç»Ÿè·å–èµ„æº</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">fileList</span>.<span class="title function_">push</span>(&#123;<span class="string">&#x27;url&#x27;</span>: <span class="string">&#x27;http://123.207.27.208&#x27;</span> + arr[i]&#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h4 id="5-æ•°æ®å›æ˜¾"><a href="#5-æ•°æ®å›æ˜¾" class="headerlink" title="5. æ•°æ®å›æ˜¾"></a>5. æ•°æ®å›æ˜¾</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ˜¾ç¤ºç¼–è¾‘ç•Œé¢</span></span><br><span class="line"><span class="attr">handleEdit</span>: <span class="keyword">function</span> (<span class="params">index, row</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">title</span> = <span class="string">&#x27;ç¼–è¾‘&#x27;</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">editForm</span> = <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, row);</span><br><span class="line">  <span class="comment">// å¯¹fileListè¿›è¡Œå¤„ç†ï¼Œç”¨ä»¥æ˜¾ç¤ºå›¾ç‰‡</span></span><br><span class="line">  <span class="comment">// å…ˆæ¸…ç©º - è¿™ä¸ªfileListåšäº†ç»‘å®šï¼Œä»¥å‰æ˜¯æœ‰å€¼ã€å…ˆæ¸…ç©ºï¼Œå†æ·»åŠ æœ€æ–°çš„æ•°æ®ã€‘</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">fileList</span> = []</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">editForm</span>.<span class="property">resources</span>) &#123;</span><br><span class="line">    <span class="comment">// /group1/M00/00/0C/CgAIC2KrUU-ARA8EAAH2I5Y672k716.jpg,/group1/M00/00/0C/CgAIC2KrUYaAaR-6AADnxcxs4eA746.jpg å¯¹å…¶è¿›è¡Œåˆ†å‰²</span></span><br><span class="line">    <span class="keyword">let</span> arr = <span class="variable language_">this</span>.<span class="property">editForm</span>.<span class="property">resources</span>.<span class="title function_">split</span>(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">    <span class="comment">// å¾ªç¯éå†</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      <span class="comment">// ä»fastDfsæ–‡ä»¶ç³»ç»Ÿè·å–èµ„æº</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">fileList</span>.<span class="title function_">push</span>(&#123;<span class="string">&#x27;url&#x27;</span>: <span class="string">&#x27;http://123.207.27.208&#x27;</span> + arr[i]&#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">editFormVisible</span> = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">vueçš„å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ä½¿ç”¨ä»¥åŠå¤šå›¾ç‰‡æ–‡ä»¶ä¸Šä¼ ä¸å›æ˜¾</summary>
    
    
    
    <category term="vue" scheme="https://www.fomal.cc/categories/vue/"/>
    
    
    <category term="vue" scheme="https://www.fomal.cc/tags/vue/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨SpringBootçš„å®šæ—¶ä»»åŠ¡å‘å¸ƒç§’æ€æ´»åŠ¨åˆ°redis</title>
    <link href="https://www.fomal.cc/posts/56884dd3.html"/>
    <id>https://www.fomal.cc/posts/56884dd3.html</id>
    <published>2025-05-20T08:38:30.630Z</published>
    <updated>2022-11-10T06:18:03.617Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ä¸€-EnableSchedulingæ³¨è§£å¼€å¯å®šæ—¶ä»»åŠ¡"><a href="#ä¸€-EnableSchedulingæ³¨è§£å¼€å¯å®šæ—¶ä»»åŠ¡" class="headerlink" title="ä¸€. @EnableSchedulingæ³¨è§£å¼€å¯å®šæ—¶ä»»åŠ¡"></a>ä¸€. <code>@EnableScheduling</code>æ³¨è§£å¼€å¯å®šæ—¶ä»»åŠ¡</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> io.coderyeah.ymcc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ConfigurableApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.scheduling.annotation.EnableScheduling;</span><br><span class="line"></span><br><span class="line"><span class="meta">@EnableScheduling</span><span class="comment">//å¼€å¯å®šæ—¶ä»»åŠ¡</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">KillServiceApp</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">run</span> <span class="operator">=</span> SpringApplication.run(KillServiceApp.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="äºŒ-Scheduled-cron-quot-0-0-0-quot-æŒ‡å®šå®šæ—¶ä»»åŠ¡"><a href="#äºŒ-Scheduled-cron-quot-0-0-0-quot-æŒ‡å®šå®šæ—¶ä»»åŠ¡" class="headerlink" title="äºŒ. @Scheduled(cron = &quot;0 0 0 * * ?&quot;)æŒ‡å®šå®šæ—¶ä»»åŠ¡"></a>äºŒ. <code>@Scheduled(cron = &quot;0 0 0 * * ?&quot;)</code>æŒ‡å®šå®šæ—¶ä»»åŠ¡</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cn.hutool.core.date.DateUtil;</span><br><span class="line"><span class="keyword">import</span> io.coderyeah.ymcc.domain.KillActivity;</span><br><span class="line"><span class="keyword">import</span> io.coderyeah.ymcc.service.IKillActivityService;</span><br><span class="line"><span class="keyword">import</span> io.coderyeah.ymcc.util.AssertUtil;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.scheduling.annotation.Scheduled;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PublishKillCourse2Redis</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> IKillActivityService activityService;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®šæ—¶å‘å¸ƒç§’æ€æ´»åŠ¨åˆ°redis  ï¼ˆ0 0 1 * * ?ï¼‰==&gt;&gt;æ¯å¤©å‡Œæ™¨ä¸€ç‚¹æ‰§è¡Œä¸€æ¬¡</span></span><br><span class="line">    <span class="comment">// æ¯å¤©å‡Œæ™¨0ç‚¹æ‰§è¡Œä¸€æ¬¡  @Scheduled(cron = &quot;0 0 0 * * ?&quot;)</span></span><br><span class="line">    <span class="comment">// @Scheduled(cron = &quot;0 0/1 8-20 * * ?&quot;) // æ¯éš”ä¸€åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡</span></span><br><span class="line">    <span class="meta">@Scheduled(cron = &quot;0 0 0 * * ?&quot;)</span><span class="comment">// æ¯å¤©å‡Œæ™¨0ç‚¹æ‰§è¡Œä¸€æ¬¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">publish</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// æŸ¥è¯¢å½“å¤©çš„æ•°æ®sql:SELECT * FROM t_kill_activity WHERE TO_DAYS(start_time) =TO_DAYS(NOW())</span></span><br><span class="line">        <span class="comment">// è·å–åˆ°å½“å¤©å¾…å‘å¸ƒçš„æ´»åŠ¨</span></span><br><span class="line">        List&lt;KillActivity&gt; activities = activityService.getCurrentData();</span><br><span class="line">        AssertUtil.isNotNull(activities, <span class="string">&quot;ä»Šæ—¥æš‚æ— ç§’æ€æ´»åŠ¨å‘å¸ƒ&quot;</span>);</span><br><span class="line">        <span class="comment">// éå†æ¯ä¸€ä¸ªæ´»åŠ¨æ‰§è¡Œå‘å¸ƒ</span></span><br><span class="line">        log.info(<span class="string">&quot;&#123;&#125;--ä»»åŠ¡å‡†å¤‡å‘å¸ƒåˆ°redis~~~&quot;</span>, DateUtil.now());</span><br><span class="line">        activities.forEach(killActivity -&gt; &#123;</span><br><span class="line">            <span class="comment">// ä»»åŠ¡å‘å¸ƒ</span></span><br><span class="line">            activityService.publish(killActivity.getId());</span><br><span class="line">        &#125;);</span><br><span class="line">        log.info(<span class="string">&quot;&#123;&#125;--å·²å‘å¸ƒåˆ°redis~~~&quot;</span>, DateUtil.now());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¸‰-å‘å¸ƒæ–¹æ³•"><a href="#ä¸‰-å‘å¸ƒæ–¹æ³•" class="headerlink" title="ä¸‰. å‘å¸ƒæ–¹æ³•"></a>ä¸‰. å‘å¸ƒæ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> RedissonClient redissonClient;</span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> IKillCourseService courseService;</span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> RedisTemplate&lt;Object, Object&gt; redisTemplate;</span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> KillActivityMapper activityMapper;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">publish</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">    <span class="comment">// id:å‘å¸ƒçš„æ´»åŠ¨id  æ ¹æ®idæŸ¥è¯¢å½“å‰æ´»åŠ¨</span></span><br><span class="line">    <span class="type">KillActivity</span> <span class="variable">killActivity</span> <span class="operator">=</span> selectById(id);</span><br><span class="line">    AssertUtil.isNotNull(killActivity, <span class="string">&quot;ç§’æ€æ´»åŠ¨ä¸å­˜åœ¨&quot;</span>);</span><br><span class="line">    <span class="comment">// åˆ¤æ–­æ´»åŠ¨æ˜¯å¦å¼€å¯å’Œè¿‡æœŸ</span></span><br><span class="line">    AssertUtil.isEqualsTrim(killActivity.getPublishStatus().toString(), KillActivity.KILL_WAIT_PUBLISH.toString(), <span class="string">&quot;æ´»åŠ¨å·²å‘å¸ƒæˆ–å·²ç»“æŸ&quot;</span>);</span><br><span class="line">    AssertUtil.isFalse(killActivity.getStartTime().after(<span class="keyword">new</span> <span class="title class_">Date</span>()), <span class="string">&quot;æ´»åŠ¨æœªå¼€å¯,è¯·åœ¨è§„å®šæ—¶é—´å‘å¸ƒ&quot;</span>);</span><br><span class="line">    AssertUtil.isFalse(killActivity.getEndTime().before(<span class="keyword">new</span> <span class="title class_">Date</span>()), <span class="string">&quot;æ´»åŠ¨å·²ç»ç»“æŸ&quot;</span>);</span><br><span class="line">    <span class="comment">// æ ¹æ®ç§’æ€æ´»åŠ¨æŸ¥è¯¢å‡ºæ‰€æœ‰ç§’æ€è¯¾ç¨‹</span></span><br><span class="line">    Wrapper&lt;KillCourse&gt; wrapper = <span class="keyword">new</span> <span class="title class_">EntityWrapper</span>&lt;&gt;();</span><br><span class="line">    wrapper.eq(<span class="string">&quot;activity_id&quot;</span>, id);</span><br><span class="line">    List&lt;KillCourse&gt; courses = courseService.selectList(wrapper);</span><br><span class="line">    <span class="comment">//æ›´æ–°ç§’æ€æ´»åŠ¨çŠ¶æ€</span></span><br><span class="line">    killActivity.setPublishTime(<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">    killActivity.setPublishStatus(KillActivity.KILL_OK_PUBLISH);</span><br><span class="line">    updateById(killActivity);</span><br><span class="line"></span><br><span class="line">    courses.forEach(course -&gt; &#123;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨hashå­˜å‚¨ç§’æ€è¯¾ç¨‹</span></span><br><span class="line">        <span class="comment">// è¯¾ç¨‹æ²¡æœ‰åº“å­˜ ä½¿ç”¨ä¿¡å·é‡æ¥å¤„ç†è¶…å–è¶…ä¹°é—®é¢˜</span></span><br><span class="line">        <span class="comment">// è·å–ä¿¡å·é‡</span></span><br><span class="line">        <span class="type">RSemaphore</span> <span class="variable">semaphore</span> <span class="operator">=</span> redissonClient.getSemaphore(course.getId().toString());</span><br><span class="line">        <span class="comment">// è®¾ç½®ä¿¡å·é‡ --è¯¾ç¨‹ç§’æ€çš„æ•°é‡</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">b</span> <span class="operator">=</span> semaphore.trySetPermits(course.getKillCount());</span><br><span class="line">        log.info(<span class="string">&quot;è®¾ç½®ä¿¡å·é‡ï¼š&#123;&#125;&quot;</span>, b);</span><br><span class="line">        AssertUtil.isTrue(b, <span class="string">&quot;è·å–ä¿¡å·é‡å¤±è´¥&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> RedisConstants.KILL_ACTIVITY + id;</span><br><span class="line">        redisTemplate.opsForHash().put(key, course.getCourseId().toString(), course);</span><br><span class="line">        <span class="comment">// æ›´æ–°ç§’æ€è¯¾ç¨‹çŠ¶æ€ ç§’æ€ä¸­</span></span><br><span class="line">        course.setPublishStatus(KillCourse.KILLING);</span><br><span class="line">        course.setPublishTime(<span class="keyword">new</span> <span class="title class_">Date</span>());<span class="comment">// å‘å¸ƒæ—¶é—´</span></span><br><span class="line">        courseService.updateById(course);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.redisson.Redisson;</span><br><span class="line"><span class="keyword">import</span> org.redisson.api.RedissonClient;</span><br><span class="line"><span class="keyword">import</span> org.redisson.config.Config;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RedissonConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆ›å»ºå®¢æˆ·ç«¯</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> RedissonClient <span class="title function_">redissonClient</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">Config</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Config</span>();</span><br><span class="line">        config.useSingleServer().setAddress(<span class="string">&quot;redis://127.0.0.1:6379&quot;</span>).setPassword(<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> Redisson.create(config);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.redisson<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>redisson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.17.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;ä¸€-EnableSchedulingæ³¨è§£å¼€å¯å®šæ—¶ä»»åŠ¡&quot;&gt;&lt;a href=&quot;#ä¸€-EnableSchedulingæ³¨è§£å¼€å¯å®šæ—¶ä»»åŠ¡&quot; class=&quot;headerlink&quot; title=&quot;ä¸€. @EnableSchedulingæ³¨è§£å¼€å¯å®šæ—¶ä»»åŠ¡&quot;&gt;&lt;/a&gt;ä¸€. &lt;co</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨Minioå­˜å‚¨æ–‡ä»¶å¯¹è±¡</title>
    <link href="https://www.fomal.cc/posts/f71a6512.html"/>
    <id>https://www.fomal.cc/posts/f71a6512.html</id>
    <published>2025-05-20T08:38:30.627Z</published>
    <updated>2022-11-18T02:32:41.327Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ä¸€-Dockeræ‹‰å–é•œåƒï¼ˆç¡®ä¿è‡ªå·±çš„æœåŠ¡å™¨å·²ç»å®‰è£…Dockerï¼‰"><a href="#ä¸€-Dockeræ‹‰å–é•œåƒï¼ˆç¡®ä¿è‡ªå·±çš„æœåŠ¡å™¨å·²ç»å®‰è£…Dockerï¼‰" class="headerlink" title="ä¸€. Dockeræ‹‰å–é•œåƒï¼ˆç¡®ä¿è‡ªå·±çš„æœåŠ¡å™¨å·²ç»å®‰è£…Dockerï¼‰"></a>ä¸€. Dockeræ‹‰å–é•œåƒï¼ˆç¡®ä¿è‡ªå·±çš„æœåŠ¡å™¨å·²ç»å®‰è£…Dockerï¼‰</h3><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull minio/minio</span><br></pre></td></tr></table></figure><h3 id="äºŒ-å¯åŠ¨ä¸€ä¸ªminiioå®¹å™¨"><a href="#äºŒ-å¯åŠ¨ä¸€ä¸ªminiioå®¹å™¨" class="headerlink" title="äºŒ. å¯åŠ¨ä¸€ä¸ªminiioå®¹å™¨"></a>äºŒ. å¯åŠ¨ä¸€ä¸ªminiioå®¹å™¨</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker run --name minio -p 9090:9000 -p 9999:9999 -d \</span><br><span class="line">--restart=always -e \</span><br><span class="line">&quot;MINIO_ROOT_USER=minio&quot; \</span><br><span class="line">-e &quot;MINIO_ROOT_PASSWORD=minio123&quot; \</span><br><span class="line">-v /home/minio/data:/data \</span><br><span class="line">-v /home/minio/config:/root/.minio minio/minio server /data --console-address &#x27;0.0.0.0:9999&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>è´¦å·æ˜¯minio; å¯†ç æ˜¯minio123</strong></p><h3 id="ä¸‰-è®¿é—®minioç®¡ç†ç•Œé¢"><a href="#ä¸‰-è®¿é—®minioç®¡ç†ç•Œé¢" class="headerlink" title="ä¸‰. è®¿é—®minioç®¡ç†ç•Œé¢"></a>ä¸‰. è®¿é—®minioç®¡ç†ç•Œé¢</h3><p>ç«¯å£<strong>9090</strong>æˆ–<strong>9999</strong>ï¼ˆç¡®ä¿åœ¨æœåŠ¡å™¨æ”¾è¡Œç›¸å…³ç«¯å£å³å¯è®¿é—®ï¼‰</p><p><img src="https://raw.githubusercontent.com/lqs-blog/picgo/main/img/20221118102023.png" alt="image-20221118102023717"></p><p>ç‚¹å‡» create a Bucket åˆ›å»ºä¸€ä¸ªbucket(æ¡¶), è¿™é‡Œçš„Bucket æˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºæ–‡ä»¶å­˜å‚¨çš„ç›®å½•</p><p>è¾“å…¥ bucket name ,ç‚¹å‡»create bucket ã€‚å¯ä»¥é€šè¿‡ upload ä¸Šä¼ æ–‡ä»¶åˆ°bucketä¸­ã€‚</p><h3 id="å››-Java-ä¸Šä¼ æ–‡ä»¶åˆ°minio"><a href="#å››-Java-ä¸Šä¼ æ–‡ä»¶åˆ°minio" class="headerlink" title="å››. Java ä¸Šä¼ æ–‡ä»¶åˆ°minio"></a>å››. Java ä¸Šä¼ æ–‡ä»¶åˆ°minio</h3><ol><li><h4 id="å¯¼å…¥ä¾èµ–"><a href="#å¯¼å…¥ä¾èµ–" class="headerlink" title="å¯¼å…¥ä¾èµ–"></a>å¯¼å…¥ä¾èµ–</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.minio<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>minio<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>7.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>æµ‹è¯•ç±»(éœ€è¦è¾“å…¥è‡ªå·±çš„è´¦å·å¯†ç å’ŒIP)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.minio.MinioClient;</span><br><span class="line"><span class="keyword">import</span> io.minio.ObjectWriteResponse;</span><br><span class="line"><span class="keyword">import</span> io.minio.PutObjectArgs;</span><br><span class="line"><span class="keyword">import</span> io.minio.errors.MinioException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lqs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/11/18 9:53</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MinioTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æ„å»ºä¸€ä¸ªMinioå®¢æˆ·ç«¯</span></span><br><span class="line">            <span class="type">MinioClient</span> <span class="variable">minioClient</span> <span class="operator">=</span> MinioClient.builder()</span><br><span class="line">                    <span class="comment">//åˆ›å»ºå®¹å™¨æ—¶æŒ‡å®šçš„è´¦å·</span></span><br><span class="line">                    .credentials(<span class="string">&quot;è´¦å·&quot;</span>, <span class="string">&quot;å¯†ç &quot;</span>)</span><br><span class="line">                    <span class="comment">//ä¸Šä¼ åœ°å€</span></span><br><span class="line">                    .endpoint(<span class="string">&quot;http://IP:9090&quot;</span>).build();</span><br><span class="line"></span><br><span class="line">            <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;C:\\Users\\coderyeah\\Desktop\\welt.jpg&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="type">PutObjectArgs</span> <span class="variable">putObjectArgs</span> <span class="operator">=</span> PutObjectArgs.builder()</span><br><span class="line">                    .object(<span class="string">&quot;welt.jpg&quot;</span>)    <span class="comment">//æ–‡ä»¶å</span></span><br><span class="line">                    .contentType(<span class="string">&quot;image/jpeg&quot;</span>)    <span class="comment">//æ–‡ä»¶ç±»å‹</span></span><br><span class="line">                    .bucket(<span class="string">&quot;bucket-test&quot;</span>)  <span class="comment">//å­˜å‚¨ç›®å½•å</span></span><br><span class="line">                    .stream(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(file), file.length(), -<span class="number">1</span>).build(); <span class="comment">//æ–‡ä»¶æµï¼Œä»¥åŠå¤§å°ï¼Œ-1ä»£è¡¨ä¸åˆ†ç‰‡</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">//æ‰§è¡Œä¸Šä¼ </span></span><br><span class="line">            <span class="type">ObjectWriteResponse</span> <span class="variable">objectWriteResponse</span> <span class="operator">=</span> minioClient.putObject(putObjectArgs);</span><br><span class="line">            System.out.println(<span class="string">&quot;ä¸Šä¼ ç»“æœ &quot;</span> + objectWriteResponse);</span><br><span class="line">            <span class="comment">//ä¸Šä¼ ä¹‹åçš„æ–‡ä»¶åœ°å€æ˜¯ï¼š</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">filePath</span> <span class="operator">=</span> <span class="string">&quot;http://IP:9090/bucket-test/welt.jpg&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (MinioException e) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Error occurred: &quot;</span> + e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h3 id="äº”-é…ç½®æƒé™"><a href="#äº”-é…ç½®æƒé™" class="headerlink" title="äº”. é…ç½®æƒé™"></a>äº”. é…ç½®æƒé™</h3><p>å¦‚æœæˆ‘ä»¬éœ€è¦æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶å¯ä»¥è¢«åŒ¿åç”¨æˆ·è®¿é—®ï¼Œé‚£ä¹ˆéœ€è¦æ·»åŠ è®¿é—®æƒé™ï¼šæ‰¾åˆ°æ–‡ä»¶å­˜å‚¨ç›®å½•ï¼Œç‚¹å‡»manager</p><p><img src="https://raw.githubusercontent.com/lqs-blog/picgo/main/img/20221118103113.png" alt="image-20221118103113051"></p><p>ç„¶åæ‰¾åˆ°access Rulesæ·»åŠ è®¿é—®è§„åˆ™å¦‚ä¸‹ï¼š</p><p><img src="https://raw.githubusercontent.com/lqs-blog/picgo/main/img/20221118103150.png" alt="image-20221118103150617"></p><p>ç„¶åå†è®¿é—®è·¯å¾„ï¼š<a href="http://IP:9090/bucket-test/welt.jpg">http://IP:9090/bucket-test/welt.jpg</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;ä¸€-Dockeræ‹‰å–é•œåƒï¼ˆç¡®ä¿è‡ªå·±çš„æœåŠ¡å™¨å·²ç»å®‰è£…Dockerï¼‰&quot;&gt;&lt;a href=&quot;#ä¸€-Dockeræ‹‰å–é•œåƒï¼ˆç¡®ä¿è‡ªå·±çš„æœåŠ¡å™¨å·²ç»å®‰è£…Dockerï¼‰&quot; class=&quot;headerlink&quot; title=&quot;ä¸€. Dockeræ‹‰å–é•œåƒï¼ˆç¡®ä¿è‡ªå·±çš„æœåŠ¡å™¨å·²ç»å®‰è£…Do</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>ç”Ÿæˆè®¢å•ç¼–å·çš„å·¥å…·ç±»</title>
    <link href="https://www.fomal.cc/posts/3f7f57de.html"/>
    <id>https://www.fomal.cc/posts/3f7f57de.html</id>
    <published>2025-05-20T08:38:30.623Z</published>
    <updated>2022-09-29T13:46:11.374Z</updated>
    
    <content type="html"><![CDATA[<hr color="red"/><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> io.coderyeah.basic.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.math.BigDecimal;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.Calendar;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CodeGenerateUtils</span> &#123;</span><br><span class="line">   </span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * è·å–å•†å“ç¼–ç </span></span><br><span class="line"><span class="comment">    * å•†å“ç¼–ç è§„åˆ™ï¼šnanoTime(å5ä½)*5ä½éšæœºæ•°(10000~99999)</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">generateProductCode</span><span class="params">()</span>&#123;</span><br><span class="line">      <span class="type">long</span> <span class="variable">nanoPart</span> <span class="operator">=</span> System.nanoTime() % <span class="number">100000L</span>;</span><br><span class="line">      <span class="keyword">if</span>(nanoPart&lt;<span class="number">10000L</span>)&#123;</span><br><span class="line">         nanoPart+=<span class="number">10000L</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="type">long</span> <span class="variable">randomPart</span> <span class="operator">=</span> (<span class="type">long</span>)(Math.random()*(<span class="number">90000</span>)+<span class="number">10000</span>);</span><br><span class="line">      <span class="type">String</span> <span class="variable">code</span> <span class="operator">=</span> <span class="string">&quot;0&quot;</span>+String.valueOf((<span class="keyword">new</span> <span class="title class_">BigDecimal</span>(nanoPart).multiply(<span class="keyword">new</span> <span class="title class_">BigDecimal</span>(randomPart))));</span><br><span class="line">      <span class="keyword">return</span> code.substring(code.length()-<span class="number">10</span>);</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> id: ç”¨æˆ·id</span></span><br><span class="line"><span class="comment">    * ç”Ÿæˆè®¢å•ç¼–å·</span></span><br><span class="line"><span class="comment">    * è®¢å•ç¼–å·è§„åˆ™ï¼š(10ä½)ï¼š(å¹´æœ«å°¾*æœˆï¼Œå–å2ä½)+ï¼ˆç”¨æˆ·ID%3.33*æ—¥å–æ•´å2ä½ï¼‰+(timestamp*10000ä»¥å†…éšæœºæ•°ï¼Œå–å6ä½)</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">generateOrderSn</span><span class="params">(<span class="type">long</span> id)</span>&#123;</span><br><span class="line">      <span class="type">Calendar</span> <span class="variable">calendar</span> <span class="operator">=</span> Calendar.getInstance();</span><br><span class="line">      <span class="type">int</span> <span class="variable">year</span> <span class="operator">=</span> calendar.get(Calendar.YEAR);</span><br><span class="line">      year = year % <span class="number">10</span>;</span><br><span class="line">      <span class="keyword">if</span>(year == <span class="number">0</span>) year = <span class="number">10</span>;</span><br><span class="line">      <span class="type">int</span> <span class="variable">month</span> <span class="operator">=</span> calendar.get(Calendar.MONTH)+<span class="number">1</span>;</span><br><span class="line">      <span class="type">int</span> <span class="variable">yearMonth</span>  <span class="operator">=</span>  year * month;</span><br><span class="line">      <span class="type">String</span> <span class="variable">yearMonthPart</span> <span class="operator">=</span> <span class="string">&quot;0&quot;</span>+yearMonth;</span><br><span class="line">      yearMonthPart = yearMonthPart.substring(yearMonthPart.length() - <span class="number">2</span> );</span><br><span class="line">      </span><br><span class="line">      <span class="type">int</span> <span class="variable">day</span> <span class="operator">=</span> calendar.get(Calendar.DAY_OF_MONTH);</span><br><span class="line">      <span class="type">int</span> <span class="variable">dayNum</span> <span class="operator">=</span> (<span class="type">int</span>)((id % <span class="number">3.33</span>) * day);</span><br><span class="line">      <span class="type">String</span> <span class="variable">dayPart</span> <span class="operator">=</span> <span class="string">&quot;0&quot;</span>+dayNum;</span><br><span class="line">      dayPart = dayPart.substring(dayPart.length() - <span class="number">2</span>);</span><br><span class="line">      </span><br><span class="line">      <span class="type">String</span> <span class="variable">timestampPart</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>+(Math.random() * <span class="number">10000</span>) * (System.currentTimeMillis()/<span class="number">10000</span>);</span><br><span class="line">      timestampPart = timestampPart.replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;E&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">      timestampPart = timestampPart.substring(<span class="number">0</span>,<span class="number">6</span>);</span><br><span class="line">      <span class="keyword">return</span> yearMonthPart+dayPart+timestampPart;</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * ç”Ÿæˆç»Ÿä¸€æ”¯ä»˜å•å·</span></span><br><span class="line"><span class="comment">    * è§„åˆ™ï¼šå¹´(2)æœˆ(2)æ—¥(2)æ—¶(2)åˆ†(2)+timestamp*5ä½éšæœºæ•´æ•°å–å5ä½</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">generateUnionPaySn</span><span class="params">()</span>&#123;</span><br><span class="line">      <span class="type">Calendar</span> <span class="variable">calendar</span> <span class="operator">=</span> Calendar.getInstance();</span><br><span class="line">      <span class="type">SimpleDateFormat</span> <span class="variable">dateFormat</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;yyyyMMddhhmm&quot;</span>);</span><br><span class="line">      <span class="type">String</span> <span class="variable">dateTime</span> <span class="operator">=</span> dateFormat.format(calendar.getTime());</span><br><span class="line">      dateTime = dateTime.substring(<span class="number">2</span>);</span><br><span class="line">      <span class="type">String</span> <span class="variable">timestampPart</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>+(Math.random() * <span class="number">10000</span>) * (System.currentTimeMillis()/<span class="number">10000</span>);</span><br><span class="line">      timestampPart = timestampPart.replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;E&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">      timestampPart = timestampPart.substring(<span class="number">0</span>,<span class="number">5</span>);</span><br><span class="line">      <span class="keyword">return</span> dateTime+timestampPart;</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">long</span> i=<span class="number">0</span>;i&lt;<span class="number">100</span>;i++)</span><br><span class="line">      &#123;</span><br><span class="line">         <span class="comment">//String timestampPart = &quot;&quot;+(Math.random() * 10000) * (System.currentTimeMillis()/10000);</span></span><br><span class="line">         <span class="comment">//System.out.println(timestampPart);</span></span><br><span class="line">         <span class="comment">//System.out.println(generateOrderSn(i));</span></span><br><span class="line">         System.out.println(generateUnionPaySn());</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;hr color=&quot;red&quot;/&gt;

&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/sp</summary>
      
    
    
    
    
    <category term="java" scheme="https://www.fomal.cc/tags/java/"/>
    
  </entry>
  
  <entry>
    <title>è®¾è®¡ä¸€ä¸ªä¸Šä¸‹æ‹–åŠ¨åˆ†å‰²çª—å£</title>
    <link href="https://www.fomal.cc/posts/d78d2689.html"/>
    <id>https://www.fomal.cc/posts/d78d2689.html</id>
    <published>2025-05-20T08:38:30.620Z</published>
    <updated>2023-03-01T02:12:44.864Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ä¸€-æ•ˆæœå±•ç¤º"><a href="#ä¸€-æ•ˆæœå±•ç¤º" class="headerlink" title="ä¸€. æ•ˆæœå±•ç¤º"></a>ä¸€. æ•ˆæœå±•ç¤º</h3><p><img src="F:\blog\coderyeah\source\_posts\img\image-20230301100821417.png" alt="image-20230301100821417"></p><p><img src="F:\blog\coderyeah\source\_posts\img\image-20230301100901413.png" alt="image-20230301100901413"></p><h3 id="äºŒ-è‡ªå®šä¹‰ç»„ä»¶split-spane"><a href="#äºŒ-è‡ªå®šä¹‰ç»„ä»¶split-spane" class="headerlink" title="äºŒ.è‡ªå®šä¹‰ç»„ä»¶split-spane"></a>äºŒ.è‡ªå®šä¹‰ç»„ä»¶<code>split-spane</code></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div ref=&quot;splitPane&quot; class=&quot;split-pane&quot; :class=&quot;direction&quot; :style=&quot;&#123; flexDirection: direction &#125;&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;pane pane-one&quot; :style=&quot;lengthType + &#x27;:&#x27; + paneLengthValue&quot;&gt;</span><br><span class="line">      &lt;slot name=&quot;one&quot; /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;div</span><br><span class="line">      style=&quot;z-index: 2&quot;</span><br><span class="line">      class=&quot;pane-trigger&quot;</span><br><span class="line">      :style=&quot;lengthType + &#x27;:&#x27; + triggerLengthValue&quot;</span><br><span class="line">      @mousedown=&quot;handleMouseDown&quot;</span><br><span class="line">    /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;div class=&quot;pane pane-two&quot; style=&quot;z-index: 2;background-color: white&quot;&gt;</span><br><span class="line">      &lt;slot name=&quot;two&quot; /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  props: &#123;</span><br><span class="line">    direction: &#123;</span><br><span class="line">      type: String,</span><br><span class="line">      default: &#x27;row&#x27;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    min: &#123;</span><br><span class="line">      type: Number,</span><br><span class="line">      default: 10</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    max: &#123;</span><br><span class="line">      type: Number,</span><br><span class="line">      default: 90</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    paneLengthPercent: &#123;</span><br><span class="line">      type: Number,</span><br><span class="line">      default: 50</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    triggerLength: &#123;</span><br><span class="line">      type: Number,</span><br><span class="line">      default: 10</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      triggerLeftOffset: 0 // é¼ æ ‡è·æ»‘åŠ¨å™¨å·¦(é¡¶)ä¾§åç§»é‡</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  computed: &#123;</span><br><span class="line">    lengthType() &#123;</span><br><span class="line">      return this.direction === &#x27;row&#x27; ? &#x27;width&#x27; : &#x27;height&#x27;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    paneLengthValue() &#123;</span><br><span class="line">      return `calc($&#123;this.paneLengthPercent&#125;% - $&#123;this.triggerLength / 2 + &#x27;px&#x27;&#125;)`</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    triggerLengthValue() &#123;</span><br><span class="line">      return this.triggerLength + &#x27;px&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  methods: &#123;</span><br><span class="line">    // æŒ‰ä¸‹æ»‘åŠ¨å™¨</span><br><span class="line">    handleMouseDown(e) &#123;</span><br><span class="line">      document.addEventListener(&#x27;mousemove&#x27;, this.handleMouseMove)</span><br><span class="line">      document.addEventListener(&#x27;mouseup&#x27;, this.handleMouseUp)</span><br><span class="line"></span><br><span class="line">      if (this.direction === &#x27;row&#x27;) &#123;</span><br><span class="line">        this.triggerLeftOffset = e.pageX - e.srcElement.getBoundingClientRect().left</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        this.triggerLeftOffset = e.pageY - e.srcElement.getBoundingClientRect().top</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    // æŒ‰ä¸‹æ»‘åŠ¨å™¨åç§»åŠ¨é¼ æ ‡</span><br><span class="line">    handleMouseMove(e) &#123;</span><br><span class="line">      const clientRect = this.$refs.splitPane.getBoundingClientRect()</span><br><span class="line">      let paneLengthPercent = 0</span><br><span class="line"></span><br><span class="line">      if (this.direction === &#x27;row&#x27;) &#123;</span><br><span class="line">        const offset = e.pageX - clientRect.left - this.triggerLeftOffset + this.triggerLength / 2</span><br><span class="line">        paneLengthPercent = (offset / clientRect.width) * 100</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        const offset = e.pageY - clientRect.top - this.triggerLeftOffset + this.triggerLength / 2</span><br><span class="line">        paneLengthPercent = (offset / clientRect.height) * 100</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      if (paneLengthPercent &lt; this.min) &#123;</span><br><span class="line">        paneLengthPercent = this.min</span><br><span class="line">      &#125;</span><br><span class="line">      if (paneLengthPercent &gt; this.max) &#123;</span><br><span class="line">        paneLengthPercent = this.max</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      this.$emit(&#x27;update:paneLengthPercent&#x27;, paneLengthPercent)</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    // æ¾å¼€æ»‘åŠ¨å™¨</span><br><span class="line">    handleMouseUp() &#123;</span><br><span class="line">      document.removeEventListener(&#x27;mousemove&#x27;, this.handleMouseMove)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">.split-pane &#123;</span><br><span class="line">  //background: palegreen;</span><br><span class="line">  height: 100%;</span><br><span class="line">  display: flex;</span><br><span class="line">  &amp;.row &#123;</span><br><span class="line">    .pane &#123;</span><br><span class="line">      height: 100%;</span><br><span class="line">    &#125;</span><br><span class="line">    .pane-trigger &#123;</span><br><span class="line">      height: 100%;</span><br><span class="line">      cursor: col-resize;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;.column &#123;</span><br><span class="line">    .pane &#123;</span><br><span class="line">      width: 100%;</span><br><span class="line">    &#125;</span><br><span class="line">    .pane-trigger &#123;</span><br><span class="line">      width: 100%;</span><br><span class="line">      cursor: row-resize;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  .pane-one &#123;</span><br><span class="line">    //background: palevioletred;</span><br><span class="line">  &#125;</span><br><span class="line">  .pane-trigger &#123;</span><br><span class="line">    user-select: none;</span><br><span class="line">    background: rgba(241, 241, 241, 0.95);</span><br><span class="line">  &#125;</span><br><span class="line">  .pane-two &#123;</span><br><span class="line">    flex: 1;</span><br><span class="line">    //background: turquoise;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ä¸‰-ä½¿ç”¨ç¤ºä¾‹"><a href="#ä¸‰-ä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="ä¸‰.ä½¿ç”¨ç¤ºä¾‹"></a>ä¸‰.ä½¿ç”¨ç¤ºä¾‹</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;page&quot; style=&quot;height: 800px&quot;&gt;</span><br><span class="line">    &lt;SplitPane</span><br><span class="line">      direction=&quot;column&quot;</span><br><span class="line">      :min=&quot;20&quot;</span><br><span class="line">      :max=&quot;80&quot;</span><br><span class="line">      :triggerLength=&quot;20&quot;</span><br><span class="line">      :paneLengthPercent.sync=&quot;paneLengthPercent&quot;&gt;</span><br><span class="line">      &lt;template v-slot:one&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">          åŒºåŸŸä¸€</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line"></span><br><span class="line">      &lt;template v-slot:two&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">          åŒºåŸŸäºŒ</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/SplitPane&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import SplitPane from &#x27;@/views/quality/split-pane&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;Test&#x27;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    SplitPane</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      paneLengthPercent: 50</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">.page &#123;</span><br><span class="line">  height: 100%;</span><br><span class="line">  padding: 10px;</span><br><span class="line">  //background: #000;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="F:\blog\coderyeah\source\_posts\img\image-20230301101222525.png" alt="image-20230301101222525"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;ä¸€-æ•ˆæœå±•ç¤º&quot;&gt;&lt;a href=&quot;#ä¸€-æ•ˆæœå±•ç¤º&quot; class=&quot;headerlink&quot; title=&quot;ä¸€. æ•ˆæœå±•ç¤º&quot;&gt;&lt;/a&gt;ä¸€. æ•ˆæœå±•ç¤º&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;F:&#92;blog&#92;coderyeah&#92;source&#92;_posts&#92;img&#92;image-</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼ä¹‹é€‚é…å™¨æ¨¡å¼</title>
    <link href="https://www.fomal.cc/posts/796a0e79.html"/>
    <id>https://www.fomal.cc/posts/796a0e79.html</id>
    <published>2025-05-20T08:38:30.616Z</published>
    <updated>2023-01-11T07:17:12.671Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ä¸€-æ¨¡å¼åŠ¨æœº"><a href="#ä¸€-æ¨¡å¼åŠ¨æœº" class="headerlink" title="ä¸€.æ¨¡å¼åŠ¨æœº"></a>ä¸€.æ¨¡å¼åŠ¨æœº</h3><ul><li>åœ¨è½¯ä»¶å¼€å‘ä¸­é‡‡ç”¨ç±»ä¼¼äºç”µæºé€‚é…å™¨çš„è®¾è®¡å’Œç¼–ç æŠ€å·§è¢«ç§°ä¸ºé€‚é…å™¨æ¨¡å¼ã€‚</li><li>é€šå¸¸æƒ…å†µä¸‹ï¼Œå®¢æˆ·ç«¯å¯ä»¥é€šè¿‡ç›®æ ‡ç±»çš„æ¥å£è®¿é—®å®ƒæ‰€æä¾›çš„æœåŠ¡ã€‚æœ‰æ—¶ï¼Œç°æœ‰çš„ç±»å¯ä»¥æ»¡è¶³å®¢æˆ·ç±»çš„åŠŸèƒ½éœ€è¦ï¼Œä½†æ˜¯å®ƒæ‰€æä¾›çš„æ¥å£ä¸ä¸€å®šæ˜¯å®¢æˆ·ç±»æ‰€æœŸæœ›çš„ï¼Œè¿™å¯èƒ½æ˜¯å› ä¸ºç°æœ‰ç±»ä¸­æ–¹æ³•åä¸ç›®æ ‡ç±»ä¸­å®šä¹‰çš„æ–¹æ³•åä¸ä¸€è‡´ç­‰åŸå› æ‰€å¯¼è‡´çš„ã€‚</li><li>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç°æœ‰çš„æ¥å£éœ€è¦è½¬åŒ–ä¸ºå®¢æˆ·ç±»æœŸæœ›çš„æ¥å£ï¼Œè¿™æ ·ä¿è¯äº†å¯¹ç°æœ‰ç±»çš„é‡ç”¨ã€‚å¦‚æœä¸è¿›è¡Œè¿™æ ·çš„è½¬åŒ–ï¼Œå®¢æˆ·ç±»å°±ä¸èƒ½åˆ©ç”¨ç°æœ‰ç±»æ‰€æä¾›çš„åŠŸèƒ½ï¼Œé€‚é…å™¨æ¨¡å¼å¯ä»¥å®Œæˆè¿™æ ·çš„è½¬åŒ–ã€‚</li><li>åœ¨é€‚é…å™¨æ¨¡å¼ä¸­å¯ä»¥å®šä¹‰ä¸€ä¸ªåŒ…è£…ç±»ï¼ŒåŒ…è£…ä¸å…¼å®¹æ¥å£çš„å¯¹è±¡ï¼Œè¿™ä¸ªåŒ…è£…ç±»æŒ‡çš„å°±æ˜¯é€‚é…å™¨(<code>Adapter</code>)ï¼Œå®ƒæ‰€åŒ…è£…çš„å¯¹è±¡å°±æ˜¯é€‚é…è€…(<code>Adaptee</code>)ï¼Œå³è¢«é€‚é…çš„ç±»ã€‚</li><li>é€‚é…å™¨æä¾›å®¢æˆ·ç±»éœ€è¦çš„æ¥å£ï¼Œé€‚é…å™¨çš„å®ç°å°±æ˜¯æŠŠå®¢æˆ·ç±»çš„è¯·æ±‚è½¬åŒ–ä¸ºå¯¹é€‚é…è€…çš„ç›¸åº”æ¥å£çš„è°ƒç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼šå½“å®¢æˆ·ç±»è°ƒç”¨é€‚é…å™¨çš„æ–¹æ³•æ—¶ï¼Œåœ¨é€‚é…å™¨ç±»çš„å†…éƒ¨å°†è°ƒç”¨é€‚é…è€…ç±»çš„æ–¹æ³•ï¼Œè€Œè¿™ä¸ªè¿‡ç¨‹å¯¹å®¢æˆ·ç±»æ˜¯é€æ˜çš„ï¼Œå®¢æˆ·ç±»å¹¶ä¸ç›´æ¥è®¿é—®é€‚é…è€…ç±»ã€‚å› æ­¤ï¼Œé€‚é…å™¨å¯ä»¥ä½¿ç”±äºæ¥å£ä¸å…¼å®¹è€Œä¸èƒ½äº¤äº’çš„ç±»å¯ä»¥ä¸€èµ·å·¥ä½œã€‚è¿™å°±æ˜¯é€‚é…å™¨æ¨¡å¼çš„æ¨¡å¼åŠ¨æœºã€‚</li></ul><h3 id="äºŒ-æ¨¡å¼å®šä¹‰"><a href="#äºŒ-æ¨¡å¼å®šä¹‰" class="headerlink" title="äºŒ.æ¨¡å¼å®šä¹‰"></a>äºŒ.æ¨¡å¼å®šä¹‰</h3><p>é€‚é…å™¨æ¨¡å¼(<code>Adapter Pattern</code>) ï¼šå°†ä¸€ä¸ªæ¥å£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦ä¸€ä¸ªæ¥å£ï¼Œé€‚é…å™¨æ¨¡å¼ä½¿æ¥å£ä¸å…¼å®¹çš„é‚£äº›ç±»å¯ä»¥ä¸€èµ·å·¥ä½œï¼Œå…¶åˆ«åä¸ºåŒ…è£…å™¨(Wrapper)ã€‚é€‚é…å™¨æ¨¡å¼æ—¢å¯ä»¥ä½œä¸ºç±»ç»“æ„å‹æ¨¡å¼ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºå¯¹è±¡ç»“æ„å‹æ¨¡å¼ã€‚</p><h3 id="ä¸‰-æ¨¡å¼ç»“æ„"><a href="#ä¸‰-æ¨¡å¼ç»“æ„" class="headerlink" title="ä¸‰.æ¨¡å¼ç»“æ„"></a>ä¸‰.æ¨¡å¼ç»“æ„</h3><p>é€‚é…å™¨æ¨¡å¼åŒ…å«å¦‚ä¸‹è§’è‰²ï¼š</p><ul><li><code>Target</code>ï¼šç›®æ ‡æŠ½è±¡ç±»</li><li><code>Adapter</code>ï¼šé€‚é…å™¨ç±»</li><li><code>Adaptee</code>ï¼šé€‚é…è€…ç±»</li><li><code>Client</code>ï¼šå®¢æˆ·ç±»</li></ul><p>é€‚é…å™¨æ¨¡å¼æœ‰å¯¹è±¡é€‚é…å™¨å’Œç±»é€‚é…å™¨ä¸¤ç§å®ç°ï¼š</p><p>å¯¹è±¡é€‚é…å™¨ï¼š</p><p><img src="F:\blog\coderyeah\source\_posts\img\image-20230111115432167.png" alt="image-20230111115432167"></p><p>ç±»é€‚é…å™¨ï¼š</p><p><img src="img/image-20230111115719568.png" alt="image-20230111115719568"></p><h3 id="å››-ä»£ç ç¤ºä¾‹"><a href="#å››-ä»£ç ç¤ºä¾‹" class="headerlink" title="å››.ä»£ç ç¤ºä¾‹"></a>å››.ä»£ç ç¤ºä¾‹</h3><h4 id="1-ç±»é€‚é…å™¨"><a href="#1-ç±»é€‚é…å™¨" class="headerlink" title="1.ç±»é€‚é…å™¨"></a>1.ç±»é€‚é…å™¨</h4><p>é€‚é…å™¨ä¸é€‚é…è€…ä¹‹é—´æ˜¯ç»§æ‰¿ï¼ˆæˆ–å®ç°ï¼‰å…³ç³»</p><p>é€‚é…è€…</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.adapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lqs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/1/11 14:39</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Adaptee</span> <span class="keyword">implements</span> <span class="title class_">AdapteeInterface</span> &#123;<span class="comment">// é€‚é…è€…ç±»</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">show</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;é€‚é…è€…ç±»çš„è¡¨æ¼”æ—¶é—´...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">dance</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;é€‚é…è€…ç±»çš„dance...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€‚é…è€…æ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.adapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lqs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/1/11 14:40</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AdapteeInterface</span> &#123; <span class="comment">// é€‚é…è€…è¦å®ç°çš„æ¥å£</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">show</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">dance</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›®æ ‡æ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.adapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lqs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/1/11 14:42</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">TargetInterface</span> &#123;<span class="comment">// ç›®æ ‡æ¥å£</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">capture</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">release</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€‚é…å™¨ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.adapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lqs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/1/11 14:44</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Adaptor</span> <span class="keyword">extends</span> <span class="title class_">Adaptee</span> <span class="keyword">implements</span> <span class="title class_">TargetInterface</span> &#123;<span class="comment">// é€‚é…å™¨--ä½¿æ¥å£ä¸å…¼å®¹çš„ç±»åè°ƒå·¥ä½œ</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">capture</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.dance();</span><br><span class="line">        System.out.println(<span class="string">&quot;targetæ¥å£çš„è·å–æ–¹æ³•...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">release</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.show();</span><br><span class="line">        System.out.println(<span class="string">&quot;targetæ¥å£çš„é‡Šæ”¾æ–¹æ³•...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Adaptor</span> <span class="variable">adaptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Adaptor</span>();</span><br><span class="line">        adaptor.release();</span><br><span class="line">        adaptor.capture();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="img/image-20230111145308227.png" alt="image-20230111145308227"></p><h4 id="2-å¯¹è±¡é€‚é…å™¨"><a href="#2-å¯¹è±¡é€‚é…å™¨" class="headerlink" title="2.å¯¹è±¡é€‚é…å™¨"></a>2.å¯¹è±¡é€‚é…å™¨</h4><p>é€‚é…å™¨ä¸é€‚é…è€…ä¹‹é—´æ˜¯å…³è”å…³ç³»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.adapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lqs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/1/11 14:55</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ObjectAdaptor</span> <span class="keyword">implements</span> <span class="title class_">TargetInterface</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> AdapteeInterface anInterface;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ObjectAdaptor</span><span class="params">(AdapteeInterface anInterface)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.anInterface = anInterface;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">capture</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å¯¹è±¡é€‚é…å™¨ä¿˜è·æ–¹æ³•...&quot;</span>);</span><br><span class="line">        anInterface.dance();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">release</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å¯¹è±¡é€‚é…å™¨é‡Šæ”¾æ–¹æ³•...&quot;</span>);</span><br><span class="line">        anInterface.show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.adapter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lqs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/1/11 14:47</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">/*Adaptor adaptor = new Adaptor();</span></span><br><span class="line"><span class="comment">        adaptor.release();</span></span><br><span class="line"><span class="comment">        adaptor.capture();*/</span></span><br><span class="line"></span><br><span class="line">        <span class="type">AdapteeInterface</span> <span class="variable">adapteeInterface</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Adaptee</span>();</span><br><span class="line">        <span class="type">ObjectAdaptor</span> <span class="variable">objectAdaptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectAdaptor</span>(adapteeInterface);</span><br><span class="line">        objectAdaptor.release();</span><br><span class="line">        objectAdaptor.capture();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="äº”-ä¼˜ç‚¹"><a href="#äº”-ä¼˜ç‚¹" class="headerlink" title="äº”.ä¼˜ç‚¹"></a>äº”.ä¼˜ç‚¹</h3><ul><li>å°†ç›®æ ‡ç±»å’Œé€‚é…è€…ç±»è§£è€¦ï¼Œé€šè¿‡å¼•å…¥ä¸€ä¸ªé€‚é…å™¨ç±»æ¥é‡ç”¨ç°æœ‰çš„é€‚é…è€…ç±»ï¼Œè€Œæ— é¡»ä¿®æ”¹åŸæœ‰ä»£ç ã€‚</li><li>å¢åŠ äº†ç±»çš„é€æ˜æ€§å’Œå¤ç”¨æ€§ï¼Œå°†å…·ä½“çš„å®ç°å°è£…åœ¨é€‚é…è€…ç±»ä¸­ï¼Œå¯¹äºå®¢æˆ·ç«¯ç±»æ¥è¯´æ˜¯é€æ˜çš„ï¼Œè€Œä¸”æé«˜äº†é€‚é…è€…çš„å¤ç”¨æ€§ã€‚</li><li><p>çµæ´»æ€§å’Œæ‰©å±•æ€§éƒ½éå¸¸å¥½ï¼Œé€šè¿‡ä½¿ç”¨é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ›´æ¢é€‚é…å™¨ï¼Œä¹Ÿå¯ä»¥åœ¨ä¸ä¿®æ”¹åŸæœ‰ä»£ç çš„åŸºç¡€ä¸Šå¢åŠ æ–°çš„é€‚é…å™¨ç±»ï¼Œå®Œå…¨ç¬¦åˆâ€œå¼€é—­åŸåˆ™â€ã€‚</p></li><li><p>ç±»é€‚é…å™¨æ¨¡å¼è¿˜å…·æœ‰å¦‚ä¸‹ä¼˜ç‚¹ï¼š</p><p>ç”±äºé€‚é…å™¨ç±»æ˜¯é€‚é…è€…ç±»çš„å­ç±»ï¼Œå› æ­¤å¯ä»¥åœ¨é€‚é…å™¨ç±»ä¸­ç½®æ¢ä¸€äº›é€‚é…è€…çš„æ–¹æ³•ï¼Œä½¿å¾—é€‚é…å™¨çš„çµæ´»æ€§æ›´å¼ºã€‚</p></li><li><p>å¯¹è±¡é€‚é…å™¨æ¨¡å¼è¿˜å…·æœ‰å¦‚ä¸‹ä¼˜ç‚¹ï¼š</p><p>ä¸€ä¸ªå¯¹è±¡é€‚é…å™¨å¯ä»¥æŠŠå¤šä¸ªä¸åŒçš„é€‚é…è€…é€‚é…åˆ°åŒä¸€ä¸ªç›®æ ‡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒåŒä¸€ä¸ªé€‚é…å™¨å¯ä»¥æŠŠé€‚é…è€…ç±»å’Œå®ƒçš„å­ç±»éƒ½é€‚é…åˆ°ç›®æ ‡æ¥å£ã€‚</p></li></ul><h3 id="å…­-ç¼ºç‚¹"><a href="#å…­-ç¼ºç‚¹" class="headerlink" title="å…­.ç¼ºç‚¹"></a>å…­.ç¼ºç‚¹</h3><ul><li><p>ç±»é€‚é…å™¨æ¨¡å¼çš„ç¼ºç‚¹å¦‚ä¸‹ï¼š</p><p>å¯¹äºJavaã€C#ç­‰ä¸æ”¯æŒå¤šé‡ç»§æ‰¿çš„è¯­è¨€ï¼Œä¸€æ¬¡æœ€å¤šåªèƒ½é€‚é…ä¸€ä¸ªé€‚é…è€…ç±»ï¼Œè€Œä¸”ç›®æ ‡æŠ½è±¡ç±»åªèƒ½ä¸ºæŠ½è±¡ç±»ï¼Œä¸èƒ½ä¸ºå…·ä½“ç±»ï¼Œå…¶ä½¿ç”¨æœ‰ä¸€å®šçš„å±€é™æ€§ï¼Œä¸èƒ½å°†ä¸€ä¸ªé€‚é…è€…ç±»å’Œå®ƒçš„å­ç±»éƒ½é€‚é…åˆ°ç›®æ ‡æ¥å£ã€‚</p></li><li><p>å¯¹è±¡é€‚é…å™¨æ¨¡å¼çš„ç¼ºç‚¹å¦‚ä¸‹ï¼š</p><p>ä¸ç±»é€‚é…å™¨æ¨¡å¼ç›¸æ¯”ï¼Œè¦æƒ³ç½®æ¢é€‚é…è€…ç±»çš„æ–¹æ³•å°±ä¸å®¹æ˜“ã€‚å¦‚æœä¸€å®šè¦ç½®æ¢æ‰é€‚é…è€…ç±»çš„ä¸€ä¸ªæˆ–å¤šä¸ªæ–¹æ³•ï¼Œå°±åªå¥½å…ˆåšä¸€ä¸ªé€‚é…è€…ç±»çš„å­ç±»ï¼Œå°†é€‚é…è€…ç±»çš„æ–¹æ³•ç½®æ¢æ‰ï¼Œç„¶åå†æŠŠé€‚é…è€…ç±»çš„å­ç±»å½“åšçœŸæ­£çš„é€‚é…è€…è¿›è¡Œé€‚é…ï¼Œå®ç°è¿‡ç¨‹è¾ƒä¸ºå¤æ‚ã€‚</p></li></ul><h3 id="ä¸ƒ-é€‚ç”¨ç¯å¢ƒ"><a href="#ä¸ƒ-é€‚ç”¨ç¯å¢ƒ" class="headerlink" title="ä¸ƒ.é€‚ç”¨ç¯å¢ƒ"></a>ä¸ƒ.é€‚ç”¨ç¯å¢ƒ</h3><ul><li>ç³»ç»Ÿéœ€è¦ä½¿ç”¨ç°æœ‰çš„ç±»ï¼Œè€Œè¿™äº›ç±»çš„æ¥å£ä¸ç¬¦åˆç³»ç»Ÿçš„éœ€è¦ã€‚</li><li>æƒ³è¦å»ºç«‹ä¸€ä¸ªå¯ä»¥é‡å¤ä½¿ç”¨çš„ç±»ï¼Œç”¨äºä¸ä¸€äº›å½¼æ­¤ä¹‹é—´æ²¡æœ‰å¤ªå¤§å…³è”çš„ä¸€äº›ç±»ï¼ŒåŒ…æ‹¬ä¸€äº›å¯èƒ½åœ¨å°†æ¥å¼•è¿›çš„ç±»ä¸€èµ·å·¥ä½œã€‚</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;ä¸€-æ¨¡å¼åŠ¨æœº&quot;&gt;&lt;a href=&quot;#ä¸€-æ¨¡å¼åŠ¨æœº&quot; class=&quot;headerlink&quot; title=&quot;ä¸€.æ¨¡å¼åŠ¨æœº&quot;&gt;&lt;/a&gt;ä¸€.æ¨¡å¼åŠ¨æœº&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;åœ¨è½¯ä»¶å¼€å‘ä¸­é‡‡ç”¨ç±»ä¼¼äºç”µæºé€‚é…å™¨çš„è®¾è®¡å’Œç¼–ç æŠ€å·§è¢«ç§°ä¸ºé€‚é…å™¨æ¨¡å¼ã€‚&lt;/li&gt;
&lt;li&gt;é€šå¸¸æƒ…å†µä¸‹</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼ä¹‹å»ºé€ è€…æ¨¡å¼</title>
    <link href="https://www.fomal.cc/posts/722e57af.html"/>
    <id>https://www.fomal.cc/posts/722e57af.html</id>
    <published>2025-05-20T08:38:30.613Z</published>
    <updated>2023-01-10T07:27:58.651Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ä¸€-æ¨¡å¼åŠ¨æœº"><a href="#ä¸€-æ¨¡å¼åŠ¨æœº" class="headerlink" title="ä¸€.æ¨¡å¼åŠ¨æœº"></a>ä¸€.æ¨¡å¼åŠ¨æœº</h3><p>æ— è®ºæ˜¯åœ¨ç°å®ä¸–ç•Œä¸­è¿˜æ˜¯åœ¨è½¯ä»¶ç³»ç»Ÿä¸­ï¼Œéƒ½å­˜åœ¨ä¸€äº›å¤æ‚çš„å¯¹è±¡ï¼Œå®ƒä»¬æ‹¥æœ‰å¤šä¸ªç»„æˆéƒ¨åˆ†ï¼Œå¦‚æ±½è½¦ï¼Œå®ƒåŒ…æ‹¬è½¦è½®ã€æ–¹å‘ç›˜ã€å‘é€æœºç­‰å„ç§éƒ¨ä»¶ã€‚è€Œå¯¹äºå¤§å¤šæ•°ç”¨æˆ·è€Œè¨€ï¼Œæ— é¡»çŸ¥é“è¿™äº›éƒ¨ä»¶çš„è£…é…ç»†èŠ‚ï¼Œä¹Ÿå‡ ä¹ä¸ä¼šä½¿ç”¨å•ç‹¬æŸä¸ªéƒ¨ä»¶ï¼Œè€Œæ˜¯ä½¿ç”¨ä¸€è¾†å®Œæ•´çš„æ±½è½¦ï¼Œå¯ä»¥é€šè¿‡å»ºé€ è€…æ¨¡å¼å¯¹å…¶è¿›è¡Œè®¾è®¡ä¸æè¿°ï¼Œå»ºé€ è€…æ¨¡å¼å¯ä»¥å°†éƒ¨ä»¶å’Œå…¶ç»„è£…è¿‡ç¨‹åˆ†å¼€ï¼Œä¸€æ­¥ä¸€æ­¥åˆ›å»ºä¸€ä¸ªå¤æ‚çš„å¯¹è±¡ã€‚ç”¨æˆ·åªéœ€è¦æŒ‡å®šå¤æ‚å¯¹è±¡çš„ç±»å‹å°±å¯ä»¥å¾—åˆ°è¯¥å¯¹è±¡ï¼Œè€Œæ— é¡»çŸ¥é“å…¶å†…éƒ¨çš„å…·ä½“æ„é€ ç»†èŠ‚ã€‚</p><p>åœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œä¹Ÿå­˜åœ¨å¤§é‡ç±»ä¼¼æ±½è½¦ä¸€æ ·çš„å¤æ‚å¯¹è±¡ï¼Œå®ƒä»¬æ‹¥æœ‰ä¸€ç³»åˆ—æˆå‘˜å±æ€§ï¼Œè¿™äº›æˆå‘˜å±æ€§ä¸­æœ‰äº›æ˜¯å¼•ç”¨ç±»å‹çš„æˆå‘˜å¯¹è±¡ã€‚è€Œä¸”åœ¨è¿™äº›å¤æ‚å¯¹è±¡ä¸­ï¼Œè¿˜å¯èƒ½å­˜åœ¨ä¸€äº›é™åˆ¶æ¡ä»¶ï¼Œå¦‚æŸäº›å±æ€§æ²¡æœ‰èµ‹å€¼åˆ™å¤æ‚å¯¹è±¡ä¸èƒ½ä½œä¸ºä¸€ä¸ªå®Œæ•´çš„äº§å“ä½¿ç”¨ï¼›æœ‰äº›å±æ€§çš„èµ‹å€¼å¿…é¡»æŒ‰ç…§æŸä¸ªé¡ºåºï¼Œä¸€ä¸ªå±æ€§æ²¡æœ‰èµ‹å€¼ä¹‹å‰ï¼Œå¦ä¸€ä¸ªå±æ€§å¯èƒ½æ— æ³•èµ‹å€¼ç­‰ã€‚</p><p>å¤æ‚å¯¹è±¡ç›¸å½“äºä¸€è¾†æœ‰å¾…å»ºé€ çš„æ±½è½¦ï¼Œè€Œå¯¹è±¡çš„å±æ€§ç›¸å½“äºæ±½è½¦çš„éƒ¨ä»¶ï¼Œå»ºé€ äº§å“çš„è¿‡ç¨‹å°±ç›¸å½“äºç»„åˆéƒ¨ä»¶çš„è¿‡ç¨‹ã€‚ç”±äºç»„åˆéƒ¨ä»¶çš„è¿‡ç¨‹å¾ˆå¤æ‚ï¼Œå› æ­¤ï¼Œè¿™äº›éƒ¨ä»¶çš„ç»„åˆè¿‡ç¨‹å¾€å¾€è¢«â€œå¤–éƒ¨åŒ–â€åˆ°ä¸€ä¸ªç§°ä½œå»ºé€ è€…çš„å¯¹è±¡é‡Œï¼Œå»ºé€ è€…è¿”è¿˜ç»™å®¢æˆ·ç«¯çš„æ˜¯ä¸€ä¸ªå·²ç»å»ºé€ å®Œæ¯•çš„å®Œæ•´äº§å“å¯¹è±¡ï¼Œè€Œç”¨æˆ·æ— é¡»å…³å¿ƒè¯¥å¯¹è±¡æ‰€åŒ…å«çš„å±æ€§ä»¥åŠå®ƒä»¬çš„ç»„è£…æ–¹å¼ï¼Œè¿™å°±æ˜¯å»ºé€ è€…æ¨¡å¼çš„æ¨¡å¼åŠ¨æœºã€‚</p><h3 id="äºŒ-æ¨¡å¼å®šä¹‰"><a href="#äºŒ-æ¨¡å¼å®šä¹‰" class="headerlink" title="äºŒ.æ¨¡å¼å®šä¹‰"></a>äºŒ.æ¨¡å¼å®šä¹‰</h3><p>å»ºé€ è€…æ¨¡å¼(<code>Builder Pattern</code>)ï¼šå°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„å»ºä¸å®ƒçš„è¡¨ç¤ºåˆ†ç¦»ï¼Œä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤ºã€‚</p><p>å»ºé€ è€…æ¨¡å¼æ˜¯ä¸€æ­¥ä¸€æ­¥åˆ›å»ºä¸€ä¸ªå¤æ‚çš„å¯¹è±¡ï¼Œå®ƒå…è®¸ç”¨æˆ·åªé€šè¿‡æŒ‡å®šå¤æ‚å¯¹è±¡çš„<strong>ç±»å‹å’Œå†…å®¹</strong>å°±å¯ä»¥æ„å»ºå®ƒä»¬ï¼Œç”¨æˆ·ä¸éœ€è¦çŸ¥é“å†…éƒ¨çš„å…·ä½“æ„å»ºç»†èŠ‚ã€‚å»ºé€ è€…æ¨¡å¼å±äºå¯¹è±¡åˆ›å»ºå‹æ¨¡å¼ã€‚æ ¹æ®ä¸­æ–‡ç¿»è¯‘çš„ä¸åŒï¼Œå»ºé€ è€…æ¨¡å¼åˆå¯ä»¥ç§°ä¸º<strong>ç”Ÿæˆå™¨æ¨¡å¼</strong>ã€‚</p><h3 id="ä¸‰-å»ºé€ è€…æ¨¡å¼åŒ…å«å¦‚ä¸‹è§’è‰²ï¼š"><a href="#ä¸‰-å»ºé€ è€…æ¨¡å¼åŒ…å«å¦‚ä¸‹è§’è‰²ï¼š" class="headerlink" title="ä¸‰.å»ºé€ è€…æ¨¡å¼åŒ…å«å¦‚ä¸‹è§’è‰²ï¼š"></a>ä¸‰.å»ºé€ è€…æ¨¡å¼åŒ…å«å¦‚ä¸‹è§’è‰²ï¼š</h3><ul><li><code>Builder</code>ï¼šæŠ½è±¡å»ºé€ è€…</li><li><code>ConcreteBuilder</code>ï¼šå…·ä½“å»ºé€ è€…</li><li><code>Director</code>ï¼šæŒ‡æŒ¥è€…</li><li><code>Product</code>ï¼šäº§å“è§’è‰²</li></ul><p><img src="F:\blog\coderyeah\source\_posts\img\image-20230110144152537.png" alt="image-20230110144152537"></p><h4 id="æ—¶åºå›¾"><a href="#æ—¶åºå›¾" class="headerlink" title="æ—¶åºå›¾"></a>æ—¶åºå›¾</h4><p><img src="F:\blog\coderyeah\source\_posts\img\image-20230110144311165.png" alt="image-20230110144311165"></p><h3 id="å››-ä»£ç å®ä¾‹"><a href="#å››-ä»£ç å®ä¾‹" class="headerlink" title="å››.ä»£ç å®ä¾‹"></a>å››.ä»£ç å®ä¾‹</h3><ol><li><p><code>Builder</code>ï¼šæŠ½è±¡å»ºé€ è€…</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.builder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Builder</span> &#123;</span><br><span class="line">    <span class="comment">// åˆ›å»ºéƒ¨ä»¶ A æ¯”å¦‚åˆ›å»ºæ±½è½¦è½¦è½®</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">buildPartA</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»ºéƒ¨ä»¶ B æ¯”å¦‚åˆ›å»ºæ±½è½¦æ–¹å‘ç›˜</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">buildPartB</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»ºéƒ¨ä»¶ C æ¯”å¦‚åˆ›å»ºæ±½è½¦å‘åŠ¨æœº</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">buildPartC</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿”å›æœ€åç»„è£…æˆå“ç»“æœ (è¿”å›æœ€åè£…é…å¥½çš„æ±½è½¦)</span></span><br><span class="line">    <span class="comment">// æˆå“çš„ç»„è£…è¿‡ç¨‹ä¸åœ¨è¿™é‡Œè¿›è¡Œ,è€Œæ˜¯è½¬ç§»åˆ°ä¸‹é¢çš„ Director ç±»ä¸­è¿›è¡Œ.</span></span><br><span class="line">    <span class="comment">// ä»è€Œå®ç°äº†è§£è€¦è¿‡ç¨‹å’Œéƒ¨ä»¶</span></span><br><span class="line">    Product <span class="title function_">getResult</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><code>ConcreteBuilder</code>ï¼šå…·ä½“å»ºé€ è€…</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.builder;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConcreteBuilder</span> <span class="keyword">implements</span> <span class="title class_">Builder</span> &#123;</span><br><span class="line">    <span class="type">Product</span> <span class="variable">product</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Product</span>();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">buildPartA</span><span class="params">()</span> &#123;</span><br><span class="line">        product.setNo(<span class="keyword">new</span> <span class="title class_">Random</span>().nextInt() + <span class="string">&quot;&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;åˆ›å»ºéƒ¨ä»¶A&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">buildPartB</span><span class="params">()</span> &#123;</span><br><span class="line">        product.setBrand(<span class="string">&quot;åä¸ºåˆ¶é€ &quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;åˆ›å»ºéƒ¨ä»¶B&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">buildPartC</span><span class="params">()</span> &#123;</span><br><span class="line">        product.setName(<span class="string">&quot;æ‚ æ‚ ç±³&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;åˆ›å»ºéƒ¨ä»¶C&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Product <span class="title function_">getResult</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// è¿”å›æœ€åç»„è£…æˆå“ç»“æœ</span></span><br><span class="line">        <span class="keyword">return</span> product;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><code>Product</code>ï¼šäº§å“è§’è‰²</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.builder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Product</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String no; <span class="comment">// ç¼–å·</span></span><br><span class="line">    <span class="keyword">private</span> String brand; <span class="comment">// å“ç‰Œ</span></span><br><span class="line">    <span class="keyword">private</span> String name; <span class="comment">// åç§°</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getNo</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> no;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setNo</span><span class="params">(String no)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.no = no;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getBrand</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> brand;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setBrand</span><span class="params">(String brand)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.brand = brand;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Product&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;no=&#x27;&quot;</span> + no + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, brand=&#x27;&quot;</span> + brand + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><code>Director</code>ï¼šæŒ‡æŒ¥è€…</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.builder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Director</span> &#123;<span class="comment">// ç”¨äºç»„è£…éƒ¨ä»¶</span></span><br><span class="line">    Builder builder;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Director</span><span class="params">(Builder builder)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.builder = builder;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†éƒ¨ä»¶ partA partB partC æœ€åç»„æˆå¤æ‚å¯¹è±¡</span></span><br><span class="line">    <span class="comment">// è¿™é‡Œæ˜¯å°†è½¦è½® æ–¹å‘ç›˜å’Œå‘åŠ¨æœºç»„è£…æˆæ±½è½¦çš„è¿‡ç¨‹</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">construct</span><span class="params">()</span> &#123;</span><br><span class="line">        builder.buildPartA();</span><br><span class="line">        builder.buildPartB();</span><br><span class="line">        builder.buildPartC();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.builder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123; <span class="comment">// builderæ¨¡å¼çš„è°ƒç”¨</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ConcreteBuilder</span> <span class="variable">builder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConcreteBuilder</span>();</span><br><span class="line">        <span class="type">Director</span> <span class="variable">director</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Director</span>(builder);</span><br><span class="line">        director.construct();</span><br><span class="line">        <span class="keyword">final</span> <span class="type">Product</span> <span class="variable">product</span> <span class="operator">=</span> builder.getResult();</span><br><span class="line">        System.out.println(product);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p><img src="img/image-20230110151816133.png" alt="image-20230110151816133"></p><h3 id="äº”-æ¨¡å¼åˆ†æ"><a href="#äº”-æ¨¡å¼åˆ†æ" class="headerlink" title="äº”.æ¨¡å¼åˆ†æ"></a>äº”.æ¨¡å¼åˆ†æ</h3><p>æŠ½è±¡å»ºé€ è€…ç±»ä¸­å®šä¹‰äº†äº§å“çš„åˆ›å»ºæ–¹æ³•å’Œè¿”å›æ–¹æ³•;</p><p>å»ºé€ è€…æ¨¡å¼çš„ç»“æ„ä¸­è¿˜å¼•å…¥äº†ä¸€ä¸ª<strong>æŒ‡æŒ¥è€…ç±»Director</strong>ï¼Œè¯¥ç±»çš„ä½œç”¨ä¸»è¦æœ‰ä¸¤ä¸ªï¼šä¸€æ–¹é¢å®ƒéš”ç¦»äº†å®¢æˆ·ä¸ç”Ÿäº§è¿‡ç¨‹ï¼›å¦ä¸€æ–¹é¢å®ƒè´Ÿè´£æ§åˆ¶äº§å“çš„ç”Ÿæˆè¿‡ç¨‹ã€‚æŒ‡æŒ¥è€…é’ˆå¯¹æŠ½è±¡å»ºé€ è€…ç¼–ç¨‹ï¼Œå®¢æˆ·ç«¯åªéœ€è¦çŸ¥é“å…·ä½“å»ºé€ è€…çš„ç±»å‹ï¼Œå³å¯é€šè¿‡æŒ‡æŒ¥è€…ç±»è°ƒç”¨å»ºé€ è€…çš„ç›¸å…³æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªå®Œæ•´çš„äº§å“å¯¹è±¡</p><p>åœ¨å®¢æˆ·ç«¯ä»£ç ä¸­ï¼Œæ— é¡»å…³å¿ƒäº§å“å¯¹è±¡çš„å…·ä½“ç»„è£…è¿‡ç¨‹ï¼Œåªéœ€ç¡®å®šå…·ä½“å»ºé€ è€…çš„ç±»å‹å³å¯ï¼Œå»ºé€ è€…æ¨¡å¼å°†å¤æ‚å¯¹è±¡çš„æ„å»ºä¸å¯¹è±¡çš„è¡¨ç°åˆ†ç¦»å¼€æ¥ï¼Œè¿™æ ·ä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºå‡ºä¸åŒçš„è¡¨ç°ã€‚</p><h3 id="å…­-ä¼˜ç‚¹"><a href="#å…­-ä¼˜ç‚¹" class="headerlink" title="å…­.ä¼˜ç‚¹"></a>å…­.ä¼˜ç‚¹</h3><ul><li>åœ¨å»ºé€ è€…æ¨¡å¼ä¸­ï¼Œ <strong>å®¢æˆ·ç«¯ä¸å¿…çŸ¥é“äº§å“å†…éƒ¨ç»„æˆçš„ç»†èŠ‚ï¼Œå°†äº§å“æœ¬èº«ä¸äº§å“çš„åˆ›å»ºè¿‡ç¨‹è§£è€¦ï¼Œä½¿å¾—ç›¸åŒçš„åˆ›å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„äº§å“å¯¹è±¡ã€‚</strong></li><li>æ¯ä¸€ä¸ªå…·ä½“å»ºé€ è€…éƒ½ç›¸å¯¹ç‹¬ç«‹ï¼Œè€Œä¸å…¶ä»–çš„å…·ä½“å»ºé€ è€…æ— å…³ï¼Œå› æ­¤å¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ›¿æ¢å…·ä½“å»ºé€ è€…æˆ–å¢åŠ æ–°çš„å…·ä½“å»ºé€ è€…ï¼Œ <strong>ç”¨æˆ·ä½¿ç”¨ä¸åŒçš„å…·ä½“å»ºé€ è€…å³å¯å¾—åˆ°ä¸åŒçš„äº§å“å¯¹è±¡</strong> ã€‚</li><li><strong>å¯ä»¥æ›´åŠ ç²¾ç»†åœ°æ§åˆ¶äº§å“çš„åˆ›å»ºè¿‡ç¨‹</strong> ã€‚å°†å¤æ‚äº§å“çš„åˆ›å»ºæ­¥éª¤åˆ†è§£åœ¨ä¸åŒçš„æ–¹æ³•ä¸­ï¼Œä½¿å¾—åˆ›å»ºè¿‡ç¨‹æ›´åŠ æ¸…æ™°ï¼Œä¹Ÿæ›´æ–¹ä¾¿ä½¿ç”¨ç¨‹åºæ¥æ§åˆ¶åˆ›å»ºè¿‡ç¨‹ã€‚</li><li><strong>å¢åŠ æ–°çš„å…·ä½“å»ºé€ è€…æ— é¡»ä¿®æ”¹åŸæœ‰ç±»åº“çš„ä»£ç ï¼ŒæŒ‡æŒ¥è€…ç±»é’ˆå¯¹æŠ½è±¡å»ºé€ è€…ç±»ç¼–ç¨‹ï¼Œç³»ç»Ÿæ‰©å±•æ–¹ä¾¿ï¼Œç¬¦åˆâ€œå¼€é—­åŸåˆ™â€ã€‚</strong></li></ul><h3 id="ä¸ƒ-ç¼ºç‚¹"><a href="#ä¸ƒ-ç¼ºç‚¹" class="headerlink" title="ä¸ƒ.ç¼ºç‚¹"></a>ä¸ƒ.ç¼ºç‚¹</h3><ul><li>å»ºé€ è€…æ¨¡å¼æ‰€åˆ›å»ºçš„äº§å“ä¸€èˆ¬å…·æœ‰è¾ƒå¤šçš„å…±åŒç‚¹ï¼Œå…¶ç»„æˆéƒ¨åˆ†ç›¸ä¼¼ï¼Œå¦‚æœäº§å“ä¹‹é—´çš„å·®å¼‚æ€§å¾ˆå¤§ï¼Œåˆ™ä¸é€‚åˆä½¿ç”¨å»ºé€ è€…æ¨¡å¼ï¼Œå› æ­¤å…¶ä½¿ç”¨èŒƒå›´å—åˆ°ä¸€å®šçš„é™åˆ¶ã€‚</li><li>å¦‚æœäº§å“çš„å†…éƒ¨å˜åŒ–å¤æ‚ï¼Œå¯èƒ½ä¼šå¯¼è‡´éœ€è¦å®šä¹‰å¾ˆå¤šå…·ä½“å»ºé€ è€…ç±»æ¥å®ç°è¿™ç§å˜åŒ–ï¼Œå¯¼è‡´ç³»ç»Ÿå˜å¾—å¾ˆåºå¤§ã€‚</li></ul><h3 id="å…«-æ¨¡å¼åº”ç”¨"><a href="#å…«-æ¨¡å¼åº”ç”¨" class="headerlink" title="å…«.æ¨¡å¼åº”ç”¨"></a>å…«.æ¨¡å¼åº”ç”¨</h3><p>åœ¨å¾ˆå¤šæ¸¸æˆè½¯ä»¶ä¸­ï¼Œåœ°å›¾åŒ…æ‹¬å¤©ç©ºã€åœ°é¢ã€èƒŒæ™¯ç­‰ç»„æˆéƒ¨åˆ†ï¼Œäººç‰©è§’è‰²åŒ…æ‹¬äººä½“ã€æœè£…ã€è£…å¤‡ç­‰ç»„æˆéƒ¨åˆ†ï¼Œå¯ä»¥ä½¿ç”¨å»ºé€ è€…æ¨¡å¼å¯¹å…¶è¿›è¡Œè®¾è®¡ï¼Œé€šè¿‡ä¸åŒçš„å…·ä½“å»ºé€ è€…åˆ›å»ºä¸åŒç±»å‹çš„åœ°å›¾æˆ–äººç‰©ã€‚</p><h3 id="ä¹-æ¨¡å¼æ‰©å±•"><a href="#ä¹-æ¨¡å¼æ‰©å±•" class="headerlink" title="ä¹.æ¨¡å¼æ‰©å±•"></a>ä¹.æ¨¡å¼æ‰©å±•</h3><p>å»ºé€ è€…æ¨¡å¼çš„ç®€åŒ–:</p><ul><li>çœç•¥æŠ½è±¡å»ºé€ è€…è§’è‰²ï¼šå¦‚æœç³»ç»Ÿä¸­åªéœ€è¦ä¸€ä¸ªå…·ä½“å»ºé€ è€…çš„è¯ï¼Œå¯ä»¥çœç•¥æ‰æŠ½è±¡å»ºé€ è€…ã€‚</li><li>çœç•¥æŒ‡æŒ¥è€…è§’è‰²ï¼šåœ¨å…·ä½“å»ºé€ è€…åªæœ‰ä¸€ä¸ªçš„æƒ…å†µä¸‹ï¼Œå¦‚æœæŠ½è±¡å»ºé€ è€…è§’è‰²å·²ç»è¢«çœç•¥æ‰ï¼Œé‚£ä¹ˆè¿˜å¯ä»¥çœç•¥æŒ‡æŒ¥è€…è§’è‰²ï¼Œè®©Builderè§’è‰²æ‰®æ¼”æŒ‡æŒ¥è€…ä¸å»ºé€ è€…åŒé‡è§’è‰²ã€‚</li></ul><h3 id="å-å»ºé€ è€…æ¨¡å¼ä¸æŠ½è±¡å·¥å‚æ¨¡å¼çš„æ¯”è¾ƒ"><a href="#å-å»ºé€ è€…æ¨¡å¼ä¸æŠ½è±¡å·¥å‚æ¨¡å¼çš„æ¯”è¾ƒ" class="headerlink" title="å.å»ºé€ è€…æ¨¡å¼ä¸æŠ½è±¡å·¥å‚æ¨¡å¼çš„æ¯”è¾ƒ"></a>å.å»ºé€ è€…æ¨¡å¼ä¸æŠ½è±¡å·¥å‚æ¨¡å¼çš„æ¯”è¾ƒ</h3><ul><li>ä¸æŠ½è±¡å·¥å‚æ¨¡å¼ç›¸æ¯”ï¼Œ <strong>å»ºé€ è€…æ¨¡å¼è¿”å›ä¸€ä¸ªç»„è£…å¥½çš„å®Œæ•´äº§å“</strong> ï¼Œè€Œ <strong>æŠ½è±¡å·¥å‚æ¨¡å¼è¿”å›ä¸€ç³»åˆ—ç›¸å…³çš„äº§å“ï¼Œè¿™äº›äº§å“ä½äºä¸åŒçš„äº§å“ç­‰çº§ç»“æ„ï¼Œæ„æˆäº†ä¸€ä¸ªäº§å“æ—ã€‚</strong></li><li>åœ¨æŠ½è±¡å·¥å‚æ¨¡å¼ä¸­ï¼Œå®¢æˆ·ç«¯å®ä¾‹åŒ–å·¥å‚ç±»ï¼Œç„¶åè°ƒç”¨å·¥å‚æ–¹æ³•è·å–æ‰€éœ€äº§å“å¯¹è±¡ï¼Œè€Œåœ¨å»ºé€ è€…æ¨¡å¼ä¸­ï¼Œå®¢æˆ·ç«¯å¯ä»¥ä¸ç›´æ¥è°ƒç”¨å»ºé€ è€…çš„ç›¸å…³æ–¹æ³•ï¼Œè€Œæ˜¯é€šè¿‡æŒ‡æŒ¥è€…ç±»æ¥æŒ‡å¯¼å¦‚ä½•ç”Ÿæˆå¯¹è±¡ï¼ŒåŒ…æ‹¬å¯¹è±¡çš„ç»„è£…è¿‡ç¨‹å’Œå»ºé€ æ­¥éª¤ï¼Œå®ƒä¾§é‡äºä¸€æ­¥æ­¥æ„é€ ä¸€ä¸ªå¤æ‚å¯¹è±¡ï¼Œè¿”å›ä¸€ä¸ªå®Œæ•´çš„å¯¹è±¡ã€‚</li><li>å¦‚æœå°†æŠ½è±¡å·¥å‚æ¨¡å¼çœ‹æˆ <strong>æ±½è½¦é…ä»¶ç”Ÿäº§å·¥å‚</strong> ï¼Œç”Ÿäº§ä¸€ä¸ªäº§å“æ—çš„äº§å“ï¼Œé‚£ä¹ˆå»ºé€ è€…æ¨¡å¼å°±æ˜¯ä¸€ä¸ª <strong>æ±½è½¦ç»„è£…å·¥å‚</strong> ï¼Œé€šè¿‡å¯¹éƒ¨ä»¶çš„ç»„è£…å¯ä»¥è¿”å›ä¸€è¾†å®Œæ•´çš„æ±½è½¦ã€‚</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;ä¸€-æ¨¡å¼åŠ¨æœº&quot;&gt;&lt;a href=&quot;#ä¸€-æ¨¡å¼åŠ¨æœº&quot; class=&quot;headerlink&quot; title=&quot;ä¸€.æ¨¡å¼åŠ¨æœº&quot;&gt;&lt;/a&gt;ä¸€.æ¨¡å¼åŠ¨æœº&lt;/h3&gt;&lt;p&gt;æ— è®ºæ˜¯åœ¨ç°å®ä¸–ç•Œä¸­è¿˜æ˜¯åœ¨è½¯ä»¶ç³»ç»Ÿä¸­ï¼Œéƒ½å­˜åœ¨ä¸€äº›å¤æ‚çš„å¯¹è±¡ï¼Œå®ƒä»¬æ‹¥æœ‰å¤šä¸ªç»„æˆéƒ¨åˆ†ï¼Œå¦‚æ±½è½¦ï¼Œå®ƒåŒ…æ‹¬è½¦è½®ã€æ–¹å‘ç›˜ã€</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼ä¹‹ç®€å•å·¥å‚æ¨¡å¼</title>
    <link href="https://www.fomal.cc/posts/eeb5bd44.html"/>
    <id>https://www.fomal.cc/posts/eeb5bd44.html</id>
    <published>2025-05-20T08:38:30.609Z</published>
    <updated>2023-01-16T05:54:47.972Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ä¸€-æ¨¡å¼åŠ¨æœº"><a href="#ä¸€-æ¨¡å¼åŠ¨æœº" class="headerlink" title="ä¸€.æ¨¡å¼åŠ¨æœº"></a>ä¸€.æ¨¡å¼åŠ¨æœº</h3><p>è€ƒè™‘ä¸€ä¸ªç®€å•çš„è½¯ä»¶åº”ç”¨åœºæ™¯ï¼Œä¸€ä¸ªè½¯ä»¶ç³»ç»Ÿå¯ä»¥æä¾›å¤šä¸ªå¤–è§‚ä¸åŒçš„<strong>æŒ‰é’®</strong>ï¼ˆå¦‚åœ†å½¢æŒ‰é’®ã€çŸ©å½¢æŒ‰é’®ã€è±å½¢æŒ‰é’®ç­‰ï¼‰ï¼Œ è¿™äº›æŒ‰é’®éƒ½æºè‡ªåŒä¸€ä¸ªåŸºç±»ï¼Œä¸è¿‡åœ¨ç»§æ‰¿åŸºç±»åä¸åŒçš„å­ç±»ä¿®æ”¹äº†éƒ¨åˆ†å±æ€§ä»è€Œä½¿å¾—å®ƒä»¬å¯ä»¥å‘ˆç°ä¸åŒçš„å¤–è§‚ï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ›åœ¨ä½¿ç”¨è¿™äº›æŒ‰é’®æ—¶ï¼Œä¸éœ€è¦çŸ¥é“è¿™äº›å…·ä½“æŒ‰é’®ç±»çš„åå­—ï¼Œ<strong>åªéœ€è¦çŸ¥é“è¡¨ç¤ºè¯¥æŒ‰é’®ç±»çš„ä¸€ä¸ªå‚æ•°</strong>ï¼Œå¹¶æä¾›ä¸€ä¸ªè°ƒç”¨æ–¹ä¾¿çš„æ–¹æ³•ï¼ŒæŠŠè¯¥å‚æ•°ä¼ å…¥æ–¹æ³•å³å¯è¿”å›ä¸€ä¸ªç›¸åº”çš„æŒ‰é’®å¯¹è±¡ï¼Œæ­¤æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨ç®€å•å·¥å‚æ¨¡å¼ã€‚</p><h3 id="äºŒ-æ¨¡å¼å®šä¹‰"><a href="#äºŒ-æ¨¡å¼å®šä¹‰" class="headerlink" title="äºŒ.æ¨¡å¼å®šä¹‰"></a>äºŒ.æ¨¡å¼å®šä¹‰</h3><p><strong>ç®€å•å·¥å‚æ¨¡å¼</strong>(Simple Factory Pattern)ï¼šåˆç§°ä¸º<strong>é™æ€å·¥å‚æ–¹æ³•</strong>(Static Factory  Method)æ¨¡å¼ï¼Œå®ƒå±äºç±»åˆ›å»ºå‹æ¨¡å¼ã€‚åœ¨ç®€å•å·¥å‚æ¨¡å¼ä¸­ï¼Œå¯ä»¥æ ¹æ®å‚æ•°çš„ä¸åŒè¿”å›ä¸åŒç±»çš„å®ä¾‹ã€‚ç®€å•å·¥å‚æ¨¡å¼ä¸“é—¨å®šä¹‰ä¸€ä¸ªç±»æ¥è´Ÿè´£åˆ›å»ºå…¶ä»–ç±»çš„å®ä¾‹ï¼Œè¢«åˆ›å»ºçš„<strong>å®ä¾‹</strong>é€šå¸¸éƒ½<strong>å…·æœ‰å…±åŒçš„çˆ¶ç±»</strong>ã€‚</p><h3 id="ä¸‰-æ¨¡å¼ç»“æ„"><a href="#ä¸‰-æ¨¡å¼ç»“æ„" class="headerlink" title="ä¸‰.æ¨¡å¼ç»“æ„"></a>ä¸‰.æ¨¡å¼ç»“æ„</h3><p>ç®€å•å·¥å‚æ¨¡å¼åŒ…å«å¦‚ä¸‹è§’è‰²ï¼š</p><ul><li><p><code>Factory</code>ï¼šå·¥å‚è§’è‰²</p><p>å·¥å‚è§’è‰²è´Ÿè´£å®ç°åˆ›å»ºæ‰€æœ‰å®ä¾‹çš„å†…éƒ¨é€»è¾‘</p></li><li><p><code>Product</code>ï¼šæŠ½è±¡äº§å“è§’è‰²</p><p>æŠ½è±¡äº§å“è§’è‰²æ˜¯æ‰€åˆ›å»ºçš„æ‰€æœ‰å¯¹è±¡çš„çˆ¶ç±»ï¼Œè´Ÿè´£æè¿°æ‰€æœ‰å®ä¾‹æ‰€å…±æœ‰çš„å…¬å…±æ¥å£</p></li><li><p><code>ConcreteProduct</code>ï¼šå…·ä½“äº§å“è§’è‰²</p><p>å…·ä½“äº§å“è§’è‰²æ˜¯åˆ›å»ºç›®æ ‡ï¼Œæ‰€æœ‰åˆ›å»ºçš„å¯¹è±¡éƒ½å……å½“è¿™ä¸ªè§’è‰²çš„æŸä¸ªå…·ä½“ç±»çš„å®ä¾‹ã€‚</p></li></ul><p><img src="img/image-20230109161635485.png" alt="image-20230109161635485"></p><h3 id="å››-å®åºå›¾"><a href="#å››-å®åºå›¾" class="headerlink" title="å››.å®åºå›¾"></a>å››.å®åºå›¾</h3><p><img src="img/image-20230109161759963.png" alt="image-20230109161759963"></p><h3 id="äº”-ä»£ç å®ä¾‹"><a href="#äº”-ä»£ç å®ä¾‹" class="headerlink" title="äº”.ä»£ç å®ä¾‹"></a>äº”.ä»£ç å®ä¾‹</h3><ol><li><h4 id="äº§å“è§’è‰²"><a href="#äº§å“è§’è‰²" class="headerlink" title="äº§å“è§’è‰²"></a>äº§å“è§’è‰²</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.design;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Product</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">use</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><h4 id="å…·ä½“äº§å“è§’è‰²"><a href="#å…·ä½“äº§å“è§’è‰²" class="headerlink" title="å…·ä½“äº§å“è§’è‰²"></a>å…·ä½“äº§å“è§’è‰²</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.design;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lqs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/1/9 16:19</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProductA</span> <span class="keyword">implements</span> <span class="title class_">Product</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">use</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç”Ÿäº§äº§å“A...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.design;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProductB</span> <span class="keyword">implements</span> <span class="title class_">Product</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">use</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç”Ÿäº§äº§å“B...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>å·¥å‚è§’è‰²</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.design;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Objects;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SimpleFactory</span> &#123; <span class="comment">// ç®€å•å·¥å‚</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Product <span class="title function_">createProduct</span><span class="params">(String arg)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (Objects.equals(arg, <span class="string">&quot;A&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ProductA</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (Objects.equals(arg, <span class="string">&quot;B&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ProductB</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h3 id="å…­-æ¨¡å¼åˆ†æ"><a href="#å…­-æ¨¡å¼åˆ†æ" class="headerlink" title="å…­.æ¨¡å¼åˆ†æ"></a>å…­.æ¨¡å¼åˆ†æ</h3><ul><li>å°†å¯¹è±¡çš„åˆ›å»ºå’Œå¯¹è±¡æœ¬èº«ä¸šåŠ¡å¤„ç†åˆ†ç¦»å¯ä»¥<strong>é™ä½ç³»ç»Ÿçš„è€¦åˆåº¦</strong>ï¼Œä½¿å¾—ä¸¤è€…ä¿®æ”¹èµ·æ¥éƒ½ç›¸å¯¹å®¹æ˜“ã€‚</li><li>åœ¨è°ƒç”¨å·¥å‚ç±»çš„å·¥å‚æ–¹æ³•æ—¶ï¼Œç”±äºå·¥å‚æ–¹æ³•æ˜¯é™æ€æ–¹æ³•ï¼Œä½¿ç”¨èµ·æ¥å¾ˆæ–¹ä¾¿ï¼Œå¯é€šè¿‡ç±»åç›´æ¥è°ƒç”¨ï¼Œè€Œä¸”åªéœ€è¦ä¼ å…¥ä¸€ä¸ªç®€å•çš„å‚æ•°å³å¯ï¼Œåœ¨å®é™…å¼€å‘ä¸­ï¼Œè¿˜å¯ä»¥åœ¨è°ƒç”¨æ—¶å°†æ‰€ä¼ å…¥çš„<strong>å‚æ•°ä¿å­˜åœ¨XMLç­‰æ ¼å¼çš„é…ç½®æ–‡ä»¶</strong>ä¸­ï¼Œä¿®æ”¹å‚æ•°æ—¶æ— é¡»ä¿®æ”¹ä»»ä½•æºä»£ç ã€‚</li><li>ç®€å•å·¥å‚æ¨¡å¼æœ€å¤§çš„é—®é¢˜åœ¨äºå·¥å‚ç±»çš„<strong>èŒè´£ç›¸å¯¹è¿‡é‡</strong>ï¼Œå¢åŠ æ–°çš„äº§å“éœ€è¦ä¿®æ”¹å·¥å‚ç±»çš„åˆ¤æ–­é€»è¾‘ï¼Œè¿™ä¸€ç‚¹ä¸å¼€é—­åŸåˆ™æ˜¯ç›¸è¿èƒŒçš„ã€‚</li><li>ç®€å•å·¥å‚æ¨¡å¼çš„è¦ç‚¹åœ¨äºï¼šå½“ä½ éœ€è¦ä»€ä¹ˆï¼Œåªéœ€è¦ä¼ å…¥ä¸€ä¸ªæ­£ç¡®çš„å‚æ•°ï¼Œå°±å¯ä»¥è·å–ä½ æ‰€éœ€è¦çš„å¯¹è±¡ï¼Œè€Œæ— é¡»çŸ¥é“å…¶åˆ›å»ºç»†èŠ‚ã€‚</li></ul><h3 id="ä¸ƒ-ç®€å•å·¥å‚æ¨¡å¼çš„ä¼˜ç‚¹"><a href="#ä¸ƒ-ç®€å•å·¥å‚æ¨¡å¼çš„ä¼˜ç‚¹" class="headerlink" title="ä¸ƒ.ç®€å•å·¥å‚æ¨¡å¼çš„ä¼˜ç‚¹"></a>ä¸ƒ.ç®€å•å·¥å‚æ¨¡å¼çš„ä¼˜ç‚¹</h3><ul><li>å·¥å‚ç±»å«æœ‰å¿…è¦çš„åˆ¤æ–­é€»è¾‘ï¼Œå¯ä»¥å†³å®šåœ¨ä»€ä¹ˆæ—¶å€™åˆ›å»ºå“ªä¸€ä¸ªäº§å“ç±»çš„å®ä¾‹ï¼Œå®¢æˆ·ç«¯å¯ä»¥å…é™¤ç›´æ¥åˆ›å»ºäº§å“å¯¹è±¡çš„è´£ä»»ï¼Œè€Œä»…ä»…â€œæ¶ˆè´¹â€äº§å“ï¼›ç®€å•å·¥å‚æ¨¡å¼é€šè¿‡è¿™ç§åšæ³•å®ç°äº†å¯¹è´£ä»»çš„åˆ†å‰²ï¼Œå®ƒæä¾›äº†ä¸“é—¨çš„å·¥å‚ç±»ç”¨äºåˆ›å»ºå¯¹è±¡ã€‚</li><li>å®¢æˆ·ç«¯æ— é¡»çŸ¥é“æ‰€åˆ›å»ºçš„å…·ä½“äº§å“ç±»çš„ç±»åï¼Œåªéœ€è¦çŸ¥é“å…·ä½“äº§å“ç±»æ‰€å¯¹åº”çš„å‚æ•°å³å¯ï¼Œå¯¹äºä¸€äº›å¤æ‚çš„ç±»åï¼Œé€šè¿‡ç®€å•å·¥å‚æ¨¡å¼å¯ä»¥å‡å°‘ä½¿ç”¨è€…çš„è®°å¿†é‡ã€‚</li><li>é€šè¿‡å¼•å…¥é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥åœ¨ä¸ä¿®æ”¹ä»»ä½•å®¢æˆ·ç«¯ä»£ç çš„æƒ…å†µä¸‹æ›´æ¢å’Œå¢åŠ æ–°çš„å…·ä½“äº§å“ç±»ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Š<strong>æé«˜äº†ç³»ç»Ÿçš„çµæ´»</strong>æ€§ã€‚</li></ul><h3 id="å…«-ç®€å•å·¥å‚æ¨¡å¼çš„ç¼ºç‚¹"><a href="#å…«-ç®€å•å·¥å‚æ¨¡å¼çš„ç¼ºç‚¹" class="headerlink" title="å…«.ç®€å•å·¥å‚æ¨¡å¼çš„ç¼ºç‚¹"></a>å…«.ç®€å•å·¥å‚æ¨¡å¼çš„ç¼ºç‚¹</h3><ul><li>ç”±äºå·¥å‚ç±»é›†ä¸­äº†æ‰€æœ‰äº§å“åˆ›å»ºé€»è¾‘ï¼Œä¸€æ—¦ä¸èƒ½æ­£å¸¸å·¥ä½œï¼Œæ•´ä¸ªç³»ç»Ÿéƒ½è¦å—åˆ°å½±å“ã€‚</li><li>ä½¿ç”¨ç®€å•å·¥å‚æ¨¡å¼å°†ä¼šå¢åŠ ç³»ç»Ÿä¸­ç±»çš„ä¸ªæ•°ï¼Œåœ¨ä¸€å®šç¨‹åºä¸Šå¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚åº¦å’Œç†è§£éš¾åº¦ã€‚</li><li>ç³»ç»Ÿæ‰©å±•å›°éš¾ï¼Œä¸€æ—¦æ·»åŠ æ–°äº§å“å°±ä¸å¾—ä¸ä¿®æ”¹å·¥å‚é€»è¾‘ï¼Œåœ¨äº§å“ç±»å‹è¾ƒå¤šæ—¶ï¼Œæœ‰å¯èƒ½é€ æˆå·¥å‚é€»è¾‘è¿‡äºå¤æ‚ï¼Œä¸åˆ©äºç³»ç»Ÿçš„æ‰©å±•å’Œç»´æŠ¤ã€‚</li><li>ç®€å•å·¥å‚æ¨¡å¼ç”±äºä½¿ç”¨äº†é™æ€å·¥å‚æ–¹æ³•ï¼Œé€ æˆå·¥å‚è§’è‰²æ— æ³•å½¢æˆåŸºäºç»§æ‰¿çš„ç­‰çº§ç»“æ„ã€‚</li></ul><h3 id="ä¹-é€‚ç”¨ç¯å¢ƒ"><a href="#ä¹-é€‚ç”¨ç¯å¢ƒ" class="headerlink" title="ä¹.é€‚ç”¨ç¯å¢ƒ"></a>ä¹.é€‚ç”¨ç¯å¢ƒ</h3><ul><li>å·¥å‚ç±»è´Ÿè´£åˆ›å»ºçš„å¯¹è±¡æ¯”è¾ƒå°‘ï¼šç”±äºåˆ›å»ºçš„å¯¹è±¡è¾ƒå°‘ï¼Œä¸ä¼šé€ æˆå·¥å‚æ–¹æ³•ä¸­çš„ä¸šåŠ¡é€»è¾‘å¤ªè¿‡å¤æ‚ã€‚</li><li>å®¢æˆ·ç«¯åªçŸ¥é“ä¼ å…¥å·¥å‚ç±»çš„å‚æ•°ï¼Œå¯¹äºå¦‚ä½•åˆ›å»ºå¯¹è±¡ä¸å…³å¿ƒï¼šå®¢æˆ·ç«¯æ—¢ä¸éœ€è¦å…³å¿ƒåˆ›å»ºç»†èŠ‚ï¼Œç”šè‡³è¿ç±»åéƒ½ä¸éœ€è¦è®°ä½ï¼Œåªéœ€è¦çŸ¥é“ç±»å‹æ‰€å¯¹åº”çš„å‚æ•°ã€‚</li></ul><h3 id="å-æ¨¡å¼åº”ç”¨"><a href="#å-æ¨¡å¼åº”ç”¨" class="headerlink" title="å.æ¨¡å¼åº”ç”¨"></a>å.æ¨¡å¼åº”ç”¨</h3><ol><li>JDKç±»åº“ä¸­å¹¿æ³›ä½¿ç”¨äº†ç®€å•å·¥å‚æ¨¡å¼ï¼Œå¦‚å·¥å…·ç±»java.text.DateFormatï¼Œå®ƒç”¨äºæ ¼å¼åŒ–ä¸€ä¸ªæœ¬åœ°æ—¥æœŸæˆ–è€…æ—¶é—´ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> DateFormat <span class="title function_">getDateInstance</span><span class="params">()</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> DateFormat <span class="title function_">getDateInstance</span><span class="params">(<span class="type">int</span> style)</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> DateFormat <span class="title function_">getDateInstance</span><span class="params">(<span class="type">int</span> style,Locale locale)</span>;</span><br></pre></td></tr></table></figure><ol><li>JavaåŠ å¯†æŠ€æœ¯</li></ol><p>è·å–ä¸åŒåŠ å¯†ç®—æ³•çš„å¯†é’¥ç”Ÿæˆå™¨:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">KeyGenerator</span> <span class="variable">keyGen</span> <span class="operator">=</span> KeyGenerator.getInstance(<span class="string">&quot;DESede&quot;</span>);</span><br></pre></td></tr></table></figure><ol><li><p>åˆ›å»ºå¯†ç å™¨:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cipher cp=Cipher.getInstance(<span class="string">&quot;DESede&quot;</span>);</span><br></pre></td></tr></table></figure></li></ol><h3 id="åä¸€-æ€»ç»“"><a href="#åä¸€-æ€»ç»“" class="headerlink" title="åä¸€.æ€»ç»“"></a>åä¸€.æ€»ç»“</h3><ul><li>åˆ›å»ºå‹æ¨¡å¼å¯¹ç±»çš„å®ä¾‹åŒ–è¿‡ç¨‹è¿›è¡Œäº†æŠ½è±¡ï¼Œèƒ½å¤Ÿå°†å¯¹è±¡çš„åˆ›å»ºä¸å¯¹è±¡çš„ä½¿ç”¨è¿‡ç¨‹åˆ†ç¦»ã€‚</li><li>ç®€å•å·¥å‚æ¨¡å¼åˆç§°ä¸ºé™æ€å·¥å‚æ–¹æ³•æ¨¡å¼ï¼Œå®ƒå±äº<strong>ç±»åˆ›å»ºå‹æ¨¡å¼</strong>ã€‚åœ¨ç®€å•å·¥å‚æ¨¡å¼ä¸­ï¼Œå¯ä»¥æ ¹æ®å‚æ•°çš„ä¸åŒè¿”å›ä¸åŒç±»çš„å®ä¾‹ã€‚ç®€å•å·¥å‚æ¨¡å¼ä¸“é—¨å®šä¹‰ä¸€ä¸ªç±»æ¥è´Ÿè´£åˆ›å»ºå…¶ä»–ç±»çš„å®ä¾‹ï¼Œè¢«åˆ›å»ºçš„å®ä¾‹é€šå¸¸éƒ½å…·æœ‰å…±åŒçš„çˆ¶ç±»ã€‚</li><li>ç®€å•å·¥å‚æ¨¡å¼åŒ…å«ä¸‰ä¸ªè§’è‰²ï¼š<strong>å·¥å‚è§’è‰²</strong>è´Ÿè´£å®ç°åˆ›å»ºæ‰€æœ‰å®ä¾‹çš„å†…éƒ¨é€»è¾‘ï¼›<strong>æŠ½è±¡äº§å“è§’è‰²</strong>æ˜¯æ‰€åˆ›å»ºçš„æ‰€æœ‰å¯¹è±¡çš„çˆ¶ç±»ï¼Œè´Ÿè´£æè¿°æ‰€æœ‰å®ä¾‹æ‰€å…±æœ‰çš„å…¬å…±æ¥å£ï¼›<strong>å…·ä½“äº§å“è§’è‰²</strong>æ˜¯åˆ›å»ºç›®æ ‡ï¼Œæ‰€æœ‰åˆ›å»ºçš„å¯¹è±¡éƒ½å……å½“è¿™ä¸ªè§’è‰²çš„æŸä¸ªå…·ä½“ç±»çš„å®ä¾‹ã€‚</li><li>ç®€å•å·¥å‚æ¨¡å¼çš„è¦ç‚¹åœ¨äºï¼šå½“ä½ éœ€è¦ä»€ä¹ˆï¼Œåªéœ€è¦ä¼ å…¥ä¸€ä¸ªæ­£ç¡®çš„å‚æ•°ï¼Œå°±å¯ä»¥è·å–ä½ æ‰€éœ€è¦çš„å¯¹è±¡ï¼Œè€Œæ— é¡»çŸ¥é“å…¶åˆ›å»ºç»†èŠ‚ã€‚</li><li>ç®€å•å·¥å‚æ¨¡å¼æœ€å¤§çš„ä¼˜ç‚¹åœ¨äºå®ç°å¯¹è±¡çš„åˆ›å»ºå’Œå¯¹è±¡çš„ä½¿ç”¨åˆ†ç¦»ï¼Œå°†å¯¹è±¡çš„åˆ›å»ºäº¤ç»™ä¸“é—¨çš„å·¥å‚ç±»è´Ÿè´£ï¼Œä½†æ˜¯å…¶æœ€å¤§çš„ç¼ºç‚¹åœ¨äºå·¥å‚ç±»<strong>ä¸å¤Ÿçµæ´»</strong>ï¼Œå¢åŠ æ–°çš„å…·ä½“äº§å“éœ€è¦ä¿®æ”¹å·¥å‚ç±»çš„åˆ¤æ–­é€»è¾‘ä»£ç ï¼Œè€Œä¸”äº§å“è¾ƒå¤šæ—¶ï¼Œå·¥å‚æ–¹æ³•ä»£ç å°†ä¼šéå¸¸å¤æ‚ã€‚</li><li>ç®€å•å·¥å‚æ¨¡å¼é€‚ç”¨æƒ…å†µåŒ…æ‹¬ï¼šå·¥å‚ç±»è´Ÿè´£åˆ›å»ºçš„å¯¹è±¡æ¯”è¾ƒå°‘ï¼›å®¢æˆ·ç«¯åªçŸ¥é“ä¼ å…¥å·¥å‚ç±»çš„å‚æ•°ï¼Œå¯¹äºå¦‚ä½•åˆ›å»ºå¯¹è±¡ä¸å…³å¿ƒã€‚</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;ä¸€-æ¨¡å¼åŠ¨æœº&quot;&gt;&lt;a href=&quot;#ä¸€-æ¨¡å¼åŠ¨æœº&quot; class=&quot;headerlink&quot; title=&quot;ä¸€.æ¨¡å¼åŠ¨æœº&quot;&gt;&lt;/a&gt;ä¸€.æ¨¡å¼åŠ¨æœº&lt;/h3&gt;&lt;p&gt;è€ƒè™‘ä¸€ä¸ªç®€å•çš„è½¯ä»¶åº”ç”¨åœºæ™¯ï¼Œä¸€ä¸ªè½¯ä»¶ç³»ç»Ÿå¯ä»¥æä¾›å¤šä¸ªå¤–è§‚ä¸åŒçš„&lt;strong&gt;æŒ‰é’®&lt;/strong&gt;ï¼ˆå¦‚åœ†å½¢</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼ä¹‹å·¥å‚æ–¹æ³•æ¨¡å¼</title>
    <link href="https://www.fomal.cc/posts/cdd7d3fd.html"/>
    <id>https://www.fomal.cc/posts/cdd7d3fd.html</id>
    <published>2025-05-20T08:38:30.606Z</published>
    <updated>2023-01-10T01:52:42.345Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ä¸€-æ¨¡å¼åŠ¨æœº"><a href="#ä¸€-æ¨¡å¼åŠ¨æœº" class="headerlink" title="ä¸€.æ¨¡å¼åŠ¨æœº"></a>ä¸€.æ¨¡å¼åŠ¨æœº</h3><p>ç°åœ¨å¯¹è¯¥ç³»ç»Ÿè¿›è¡Œä¿®æ”¹ï¼Œä¸å†è®¾è®¡ä¸€ä¸ªæŒ‰é’®å·¥å‚ç±»æ¥ç»Ÿä¸€è´Ÿè´£æ‰€æœ‰äº§å“çš„åˆ›å»ºï¼Œè€Œæ˜¯å°†å…·ä½“æŒ‰é’®çš„åˆ›å»ºè¿‡ç¨‹äº¤ç»™ä¸“é—¨çš„<strong>å·¥å‚å­ç±»</strong>å»å®Œæˆï¼Œæˆ‘ä»¬å…ˆå®šä¹‰ä¸€ä¸ªæŠ½è±¡çš„æŒ‰é’®å·¥å‚ç±»ï¼Œå†å®šä¹‰å…·ä½“çš„å·¥å‚ç±»æ¥ç”Ÿæˆåœ†å½¢æŒ‰é’®ã€çŸ©å½¢æŒ‰é’®ã€è±å½¢æŒ‰é’®ç­‰ï¼Œå®ƒä»¬å®ç°åœ¨æŠ½è±¡æŒ‰é’®å·¥å‚ç±»ä¸­å®šä¹‰çš„æ–¹æ³•ã€‚è¿™ç§æŠ½è±¡åŒ–çš„ç»“æœä½¿è¿™ç§ç»“æ„å¯ä»¥åœ¨ä¸ä¿®æ”¹å…·ä½“å·¥å‚ç±»çš„æƒ…å†µä¸‹å¼•è¿›æ–°çš„äº§å“ï¼Œå¦‚æœå‡ºç°æ–°çš„æŒ‰é’®ç±»å‹ï¼Œåªéœ€è¦ä¸ºè¿™ç§æ–°ç±»å‹çš„æŒ‰é’®åˆ›å»ºä¸€ä¸ªå…·ä½“çš„å·¥å‚ç±»å°±å¯ä»¥è·å¾—è¯¥æ–°æŒ‰é’®çš„å®ä¾‹ï¼Œè¿™ä¸€ç‰¹ç‚¹æ— ç–‘ä½¿å¾—å·¥å‚æ–¹æ³•æ¨¡å¼å…·æœ‰è¶…è¶Šç®€å•å·¥å‚æ¨¡å¼çš„ä¼˜è¶Šæ€§ï¼Œæ›´åŠ ç¬¦åˆ<strong>â€œå¼€é—­åŸåˆ™(OCP: Open-Closed Principleï¼‰ï¼šä¸€ä¸ªè½¯ä»¶çš„å®ä½“åº”å½“å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­)</strong>ã€‚</p><h3 id="äºŒ-æ¨¡å¼å®šä¹‰"><a href="#äºŒ-æ¨¡å¼å®šä¹‰" class="headerlink" title="äºŒ.æ¨¡å¼å®šä¹‰"></a>äºŒ.æ¨¡å¼å®šä¹‰</h3><p><strong>å·¥å‚æ–¹æ³•æ¨¡å¼</strong>(Factory Method Pattern)åˆç§°ä¸ºå·¥å‚æ¨¡å¼ï¼Œä¹Ÿå«è™šæ‹Ÿæ„é€ å™¨(Virtual  Constructor)æ¨¡å¼æˆ–è€…<strong>å¤šæ€å·¥å‚</strong>(Polymorphic  Factory)æ¨¡å¼ï¼Œå®ƒå±äº<strong>ç±»åˆ›å»ºå‹æ¨¡å¼</strong>ã€‚åœ¨å·¥å‚æ–¹æ³•æ¨¡å¼ä¸­ï¼Œå·¥å‚çˆ¶ç±»è´Ÿè´£å®šä¹‰åˆ›å»ºäº§å“å¯¹è±¡çš„å…¬å…±æ¥å£ï¼Œè€Œå·¥å‚å­ç±»åˆ™è´Ÿè´£ç”Ÿæˆå…·ä½“çš„äº§å“å¯¹è±¡ï¼Œè¿™æ ·åšçš„ç›®çš„æ˜¯å°†äº§å“ç±»çš„å®ä¾‹åŒ–æ“ä½œå»¶è¿Ÿåˆ°å·¥å‚å­ç±»ä¸­å®Œæˆï¼Œå³é€šè¿‡å·¥å‚å­ç±»æ¥ç¡®å®šç©¶ç«Ÿåº”è¯¥å®ä¾‹åŒ–å“ªä¸€ä¸ªå…·ä½“äº§å“ç±»ã€‚</p><h3 id="ä¸‰-æ¨¡å¼ç»“æ„"><a href="#ä¸‰-æ¨¡å¼ç»“æ„" class="headerlink" title="ä¸‰.æ¨¡å¼ç»“æ„"></a>ä¸‰.æ¨¡å¼ç»“æ„</h3><p>å·¥å‚æ–¹æ³•æ¨¡å¼åŒ…å«å¦‚ä¸‹è§’è‰²ï¼š</p><ul><li><code>Product</code>ï¼šæŠ½è±¡äº§å“</li><li><code>ConcreteProduct</code>ï¼šå…·ä½“äº§å“</li><li><code>Factory</code>ï¼šæŠ½è±¡å·¥å‚</li><li><code>ConcreteFactory</code>ï¼šå…·ä½“å·¥å‚</li></ul><p><img src="img/image-20230109171501106.png" alt="image-20230109171501106"></p><h3 id="å››-ä»£ç å®ä¾‹"><a href="#å››-ä»£ç å®ä¾‹" class="headerlink" title="å››.ä»£ç å®ä¾‹"></a>å››.ä»£ç å®ä¾‹</h3><ol><li><p>æŠ½è±¡äº§å“</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.factorymethod;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Product</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">use</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>å…·ä½“äº§å“</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.factorymethod;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProductA</span> <span class="keyword">implements</span> <span class="title class_">Product</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">use</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;åˆ¶é€ ProductA...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æŠ½è±¡å·¥å‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.factorymethod;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Factory</span> &#123; <span class="comment">// å·¥å‚æ–¹æ³•</span></span><br><span class="line">    Product <span class="title function_">create</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>å…·ä½“å·¥å‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.factorymethod;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lqs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/1/10 9:09</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FactoryA</span> <span class="keyword">implements</span> <span class="title class_">Factory</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Product <span class="title function_">create</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ProductA</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h3 id="äº”-æ¨¡å¼åˆ†æ"><a href="#äº”-æ¨¡å¼åˆ†æ" class="headerlink" title="äº”.æ¨¡å¼åˆ†æ"></a>äº”.æ¨¡å¼åˆ†æ</h3><p>å·¥å‚æ–¹æ³•æ¨¡å¼æ˜¯ç®€å•å·¥å‚æ¨¡å¼çš„è¿›ä¸€æ­¥æŠ½è±¡å’Œæ¨å¹¿ã€‚ç”±äºä½¿ç”¨äº†é¢å‘å¯¹è±¡çš„å¤šæ€æ€§ï¼Œå·¥å‚æ–¹æ³•æ¨¡å¼ä¿æŒäº†ç®€å•å·¥å‚æ¨¡å¼çš„ä¼˜ç‚¹ï¼Œè€Œä¸”å…‹æœäº†å®ƒçš„ç¼ºç‚¹ã€‚åœ¨å·¥å‚æ–¹æ³•æ¨¡å¼ä¸­ï¼Œ<strong>æ ¸å¿ƒçš„å·¥å‚ç±»ä¸å†è´Ÿè´£æ‰€æœ‰äº§å“çš„åˆ›å»º</strong>ï¼Œè€Œæ˜¯å°†å…·ä½“åˆ›å»ºå·¥ä½œäº¤ç»™å­ç±»å»åšã€‚è¿™ä¸ªæ ¸å¿ƒç±»ä»…ä»…è´Ÿè´£ç»™å‡ºå…·ä½“å·¥å‚å¿…é¡»å®ç°çš„æ¥å£ï¼Œè€Œä¸è´Ÿè´£å“ªä¸€ä¸ªäº§å“ç±»è¢«å®ä¾‹åŒ–è¿™ç§ç»†èŠ‚ï¼Œè¿™ä½¿å¾—å·¥å‚æ–¹æ³•æ¨¡å¼å¯ä»¥å…è®¸ç³»ç»Ÿåœ¨ä¸ä¿®æ”¹å·¥å‚è§’è‰²çš„æƒ…å†µä¸‹å¼•è¿›æ–°äº§å“ã€‚</p><h3 id="å…­-å·¥å‚æ–¹æ³•æ¨¡å¼ä¼˜ç‚¹"><a href="#å…­-å·¥å‚æ–¹æ³•æ¨¡å¼ä¼˜ç‚¹" class="headerlink" title="å…­.å·¥å‚æ–¹æ³•æ¨¡å¼ä¼˜ç‚¹"></a>å…­.å·¥å‚æ–¹æ³•æ¨¡å¼ä¼˜ç‚¹</h3><ul><li>åœ¨å·¥å‚æ–¹æ³•æ¨¡å¼ä¸­ï¼Œå·¥å‚æ–¹æ³•ç”¨æ¥åˆ›å»ºå®¢æˆ·æ‰€éœ€è¦çš„äº§å“ï¼ŒåŒæ—¶è¿˜å‘å®¢æˆ·éšè—äº†å“ªç§å…·ä½“äº§å“ç±»å°†è¢«å®ä¾‹åŒ–è¿™ä¸€ç»†èŠ‚ï¼Œç”¨æˆ·åªéœ€è¦å…³å¿ƒæ‰€éœ€äº§å“<strong>å¯¹åº”çš„å·¥å‚</strong>ï¼Œæ— é¡»å…³å¿ƒåˆ›å»ºç»†èŠ‚ï¼Œç”šè‡³æ— é¡»çŸ¥é“å…·ä½“äº§å“ç±»çš„ç±»åã€‚</li><li>åŸºäº<strong>å·¥å‚è§’è‰²</strong>å’Œ<strong>äº§å“è§’è‰²</strong>çš„<strong>å¤šæ€</strong>æ€§è®¾è®¡æ˜¯å·¥å‚æ–¹æ³•æ¨¡å¼çš„å…³é”®ã€‚å®ƒèƒ½å¤Ÿä½¿å·¥å‚å¯ä»¥è‡ªä¸»ç¡®å®šåˆ›å»ºä½•ç§äº§å“å¯¹è±¡ï¼Œè€Œå¦‚ä½•åˆ›å»ºè¿™ä¸ªå¯¹è±¡çš„ç»†èŠ‚åˆ™å®Œå…¨å°è£…åœ¨å…·ä½“å·¥å‚å†…éƒ¨ã€‚å·¥å‚æ–¹æ³•æ¨¡å¼ä¹‹æ‰€ä»¥åˆè¢«ç§°ä¸ºå¤šæ€å·¥å‚æ¨¡å¼ï¼Œæ˜¯å› ä¸ºæ‰€æœ‰çš„å…·ä½“å·¥å‚ç±»éƒ½å…·æœ‰åŒä¸€æŠ½è±¡çˆ¶ç±»ã€‚</li><li>ä½¿ç”¨å·¥å‚æ–¹æ³•æ¨¡å¼çš„å¦ä¸€ä¸ªä¼˜ç‚¹æ˜¯åœ¨ç³»ç»Ÿä¸­åŠ å…¥æ–°äº§å“æ—¶ï¼Œæ— é¡»ä¿®æ”¹æŠ½è±¡å·¥å‚å’ŒæŠ½è±¡äº§å“æä¾›çš„æ¥å£ï¼Œæ— é¡»ä¿®æ”¹å®¢æˆ·ç«¯ï¼Œä¹Ÿæ— é¡»ä¿®æ”¹å…¶ä»–çš„å…·ä½“å·¥å‚å’Œå…·ä½“äº§å“ï¼Œè€Œåªè¦<strong>æ·»åŠ ä¸€ä¸ªå…·ä½“å·¥å‚å’Œå…·ä½“äº§å“</strong>å°±å¯ä»¥äº†ã€‚è¿™æ ·ï¼Œç³»ç»Ÿçš„å¯æ‰©å±•æ€§ä¹Ÿå°±å˜å¾—éå¸¸å¥½ï¼Œå®Œå…¨ç¬¦åˆâ€œå¼€é—­åŸåˆ™â€ã€‚</li></ul><h3 id="ä¸ƒ-å·¥å‚æ–¹æ³•æ¨¡å¼çš„ç¼ºç‚¹"><a href="#ä¸ƒ-å·¥å‚æ–¹æ³•æ¨¡å¼çš„ç¼ºç‚¹" class="headerlink" title="ä¸ƒ.å·¥å‚æ–¹æ³•æ¨¡å¼çš„ç¼ºç‚¹"></a>ä¸ƒ.å·¥å‚æ–¹æ³•æ¨¡å¼çš„ç¼ºç‚¹</h3><ul><li>åœ¨æ·»åŠ æ–°äº§å“æ—¶ï¼Œéœ€è¦ç¼–å†™æ–°çš„å…·ä½“äº§å“ç±»ï¼Œè€Œä¸”è¿˜è¦æä¾›ä¸ä¹‹å¯¹åº”çš„å…·ä½“å·¥å‚ç±»ï¼Œ<strong>ç³»ç»Ÿä¸­ç±»çš„ä¸ªæ•°å°†æˆå¯¹å¢åŠ </strong>ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šå¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚åº¦ï¼Œæœ‰æ›´å¤šçš„ç±»éœ€è¦ç¼–è¯‘å’Œè¿è¡Œï¼Œä¼šç»™ç³»ç»Ÿå¸¦æ¥ä¸€äº›é¢å¤–çš„å¼€é”€ã€‚</li><li>ç”±äºè€ƒè™‘åˆ°ç³»ç»Ÿçš„å¯æ‰©å±•æ€§ï¼Œéœ€è¦å¼•å…¥æŠ½è±¡å±‚ï¼Œåœ¨å®¢æˆ·ç«¯ä»£ç ä¸­å‡ä½¿ç”¨æŠ½è±¡å±‚è¿›è¡Œå®šä¹‰ï¼Œå¢åŠ äº†ç³»ç»Ÿçš„æŠ½è±¡æ€§å’Œç†è§£éš¾åº¦ï¼Œä¸”åœ¨å®ç°æ—¶å¯èƒ½éœ€è¦ç”¨åˆ°DOMã€åå°„ç­‰æŠ€æœ¯ï¼Œå¢åŠ äº†ç³»ç»Ÿçš„å®ç°éš¾åº¦ã€‚</li></ul><h3 id="å…«-æ¨¡å¼åº”ç”¨"><a href="#å…«-æ¨¡å¼åº”ç”¨" class="headerlink" title="å…«.æ¨¡å¼åº”ç”¨"></a>å…«.æ¨¡å¼åº”ç”¨</h3><p>JDBCä¸­çš„å·¥å‚æ–¹æ³•:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(<span class="string">&quot;jdbc:microsoft:sqlserver://localhost:1433;DatabaseName=DB;user=sa;password=&quot;</span>);</span><br><span class="line">Statement statement=conn.createStatement();</span><br><span class="line">ResultSet rs=statement.executeQuery(<span class="string">&quot;select * from UserInfo&quot;</span>);</span><br></pre></td></tr></table></figure><h3 id="ä¹-æ€»ç»“"><a href="#ä¹-æ€»ç»“" class="headerlink" title="ä¹.æ€»ç»“"></a>ä¹.æ€»ç»“</h3><ul><li>å·¥å‚æ–¹æ³•æ¨¡å¼åˆç§°ä¸º<strong>å·¥å‚æ¨¡å¼</strong>ï¼Œå®ƒå±äº<strong>ç±»åˆ›å»ºå‹æ¨¡å¼</strong>ã€‚åœ¨å·¥å‚æ–¹æ³•æ¨¡å¼ä¸­ï¼Œ<strong>å·¥å‚çˆ¶ç±»è´Ÿè´£å®šä¹‰åˆ›å»ºäº§å“å¯¹è±¡çš„å…¬å…±æ¥å£</strong>ï¼Œè€Œ<strong>å·¥å‚å­ç±»åˆ™è´Ÿè´£ç”Ÿæˆå…·ä½“çš„äº§å“å¯¹è±¡</strong>ï¼Œè¿™æ ·åšçš„ç›®çš„æ˜¯å°†äº§å“ç±»çš„å®ä¾‹åŒ–æ“ä½œå»¶è¿Ÿåˆ°å·¥å‚å­ç±»ä¸­å®Œæˆï¼Œå³é€šè¿‡å·¥å‚å­ç±»æ¥ç¡®å®šç©¶ç«Ÿåº”è¯¥å®ä¾‹åŒ–å“ªä¸€ä¸ªå…·ä½“äº§å“ç±»ã€‚</li><li>å·¥å‚æ–¹æ³•æ¨¡å¼åŒ…å«å››ä¸ªè§’è‰²ï¼šæŠ½è±¡äº§å“æ˜¯å®šä¹‰äº§å“çš„æ¥å£ï¼Œæ˜¯å·¥å‚æ–¹æ³•æ¨¡å¼æ‰€åˆ›å»ºå¯¹è±¡çš„è¶…ç±»å‹ï¼Œå³äº§å“å¯¹è±¡çš„å…±åŒçˆ¶ç±»æˆ–æ¥å£ï¼›å…·ä½“äº§å“å®ç°äº†æŠ½è±¡äº§å“æ¥å£ï¼ŒæŸç§ç±»å‹çš„å…·ä½“äº§å“ç”±ä¸“é—¨çš„å…·ä½“å·¥å‚åˆ›å»ºï¼Œå®ƒä»¬ä¹‹é—´å¾€å¾€ä¸€ä¸€å¯¹åº”ï¼›æŠ½è±¡å·¥å‚ä¸­å£°æ˜äº†å·¥å‚æ–¹æ³•ï¼Œç”¨äºè¿”å›ä¸€ä¸ªäº§å“ï¼Œå®ƒæ˜¯å·¥å‚æ–¹æ³•æ¨¡å¼çš„æ ¸å¿ƒï¼Œä»»ä½•åœ¨æ¨¡å¼ä¸­åˆ›å»ºå¯¹è±¡çš„å·¥å‚ç±»éƒ½å¿…é¡»å®ç°è¯¥æ¥å£ï¼›å…·ä½“å·¥å‚æ˜¯æŠ½è±¡å·¥å‚ç±»çš„å­ç±»ï¼Œå®ç°äº†æŠ½è±¡å·¥å‚ä¸­å®šä¹‰çš„å·¥å‚æ–¹æ³•ï¼Œå¹¶å¯ç”±å®¢æˆ·è°ƒç”¨ï¼Œè¿”å›ä¸€ä¸ªå…·ä½“äº§å“ç±»çš„å®ä¾‹ã€‚</li><li>å·¥å‚æ–¹æ³•æ¨¡å¼æ˜¯ç®€å•å·¥å‚æ¨¡å¼çš„è¿›ä¸€æ­¥æŠ½è±¡å’Œæ¨å¹¿ã€‚ç”±äºä½¿ç”¨äº†é¢å‘å¯¹è±¡çš„å¤šæ€æ€§ï¼Œå·¥å‚æ–¹æ³•æ¨¡å¼ä¿æŒäº†ç®€å•å·¥å‚æ¨¡å¼çš„ä¼˜ç‚¹ï¼Œè€Œä¸”å…‹æœäº†å®ƒçš„ç¼ºç‚¹ã€‚åœ¨å·¥å‚æ–¹æ³•æ¨¡å¼ä¸­ï¼Œ<strong>æ ¸å¿ƒçš„å·¥å‚ç±»ä¸å†è´Ÿè´£æ‰€æœ‰äº§å“çš„åˆ›å»ºï¼Œè€Œæ˜¯å°†å…·ä½“åˆ›å»ºå·¥ä½œäº¤ç»™å­ç±»å»åš</strong>ã€‚è¿™ä¸ªæ ¸å¿ƒç±»ä»…ä»…è´Ÿè´£ç»™å‡ºå…·ä½“å·¥å‚å¿…é¡»å®ç°çš„æ¥å£ï¼Œè€Œä¸è´Ÿè´£äº§å“ç±»è¢«å®ä¾‹åŒ–è¿™ç§ç»†èŠ‚ï¼Œè¿™ä½¿å¾—å·¥å‚æ–¹æ³•æ¨¡å¼å¯ä»¥å…è®¸ç³»ç»Ÿåœ¨ä¸ä¿®æ”¹å·¥å‚è§’è‰²çš„æƒ…å†µä¸‹å¼•è¿›æ–°äº§å“ã€‚</li><li>å·¥å‚æ–¹æ³•æ¨¡å¼çš„ä¸»è¦ä¼˜ç‚¹æ˜¯å¢åŠ æ–°çš„äº§å“ç±»æ—¶æ— é¡»ä¿®æ”¹ç°æœ‰ç³»ç»Ÿï¼Œå¹¶å°è£…äº†äº§å“å¯¹è±¡çš„åˆ›å»ºç»†èŠ‚ï¼Œç³»ç»Ÿå…·æœ‰è‰¯å¥½çš„çµæ´»æ€§å’Œå¯æ‰©å±•æ€§ï¼›å…¶ç¼ºç‚¹åœ¨äºå¢åŠ æ–°äº§å“çš„åŒæ—¶éœ€è¦å¢åŠ æ–°çš„å·¥å‚ï¼Œå¯¼è‡´ç³»ç»Ÿç±»çš„ä¸ªæ•°æˆå¯¹å¢åŠ ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šå¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚æ€§ã€‚</li><li>å·¥å‚æ–¹æ³•æ¨¡å¼é€‚ç”¨æƒ…å†µåŒ…æ‹¬ï¼šä¸€ä¸ªç±»ä¸çŸ¥é“å®ƒæ‰€éœ€è¦çš„å¯¹è±¡çš„ç±»ï¼›ä¸€ä¸ªç±»é€šè¿‡å…¶å­ç±»æ¥æŒ‡å®šåˆ›å»ºå“ªä¸ªå¯¹è±¡ï¼›å°†åˆ›å»ºå¯¹è±¡çš„ä»»åŠ¡å§”æ‰˜ç»™å¤šä¸ªå·¥å‚å­ç±»ä¸­çš„æŸä¸€ä¸ªï¼Œå®¢æˆ·ç«¯åœ¨ä½¿ç”¨æ—¶å¯ä»¥æ— é¡»å…³å¿ƒæ˜¯å“ªä¸€ä¸ªå·¥å‚å­ç±»åˆ›å»ºäº§å“å­ç±»ï¼Œéœ€è¦æ—¶å†åŠ¨æ€æŒ‡å®šã€‚</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;ä¸€-æ¨¡å¼åŠ¨æœº&quot;&gt;&lt;a href=&quot;#ä¸€-æ¨¡å¼åŠ¨æœº&quot; class=&quot;headerlink&quot; title=&quot;ä¸€.æ¨¡å¼åŠ¨æœº&quot;&gt;&lt;/a&gt;ä¸€.æ¨¡å¼åŠ¨æœº&lt;/h3&gt;&lt;p&gt;ç°åœ¨å¯¹è¯¥ç³»ç»Ÿè¿›è¡Œä¿®æ”¹ï¼Œä¸å†è®¾è®¡ä¸€ä¸ªæŒ‰é’®å·¥å‚ç±»æ¥ç»Ÿä¸€è´Ÿè´£æ‰€æœ‰äº§å“çš„åˆ›å»ºï¼Œè€Œæ˜¯å°†å…·ä½“æŒ‰é’®çš„åˆ›å»ºè¿‡ç¨‹äº¤ç»™ä¸“é—¨çš„&lt;s</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼ä¹‹å•ä¾‹æ¨¡å¼</title>
    <link href="https://www.fomal.cc/posts/1a4b62fe.html"/>
    <id>https://www.fomal.cc/posts/1a4b62fe.html</id>
    <published>2025-05-20T08:38:30.601Z</published>
    <updated>2023-01-10T08:17:24.480Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ä¸€-æ¨¡å¼åŠ¨æœº"><a href="#ä¸€-æ¨¡å¼åŠ¨æœº" class="headerlink" title="ä¸€.æ¨¡å¼åŠ¨æœº"></a>ä¸€.æ¨¡å¼åŠ¨æœº</h3><p>å¯¹äºç³»ç»Ÿä¸­çš„æŸäº›ç±»æ¥è¯´ï¼Œ<strong>åªæœ‰ä¸€ä¸ªå®ä¾‹</strong>å¾ˆé‡è¦ï¼Œä¾‹å¦‚ï¼Œä¸€ä¸ªç³»ç»Ÿä¸­å¯ä»¥å­˜åœ¨å¤šä¸ªæ‰“å°ä»»åŠ¡ï¼Œä½†æ˜¯åªèƒ½æœ‰ä¸€ä¸ªæ­£åœ¨å·¥ä½œçš„ä»»åŠ¡ï¼›ä¸€ä¸ªç³»ç»Ÿåªèƒ½æœ‰ä¸€ä¸ªçª—å£ç®¡ç†å™¨æˆ–æ–‡ä»¶ç³»ç»Ÿï¼›ä¸€ä¸ªç³»ç»Ÿåªèƒ½æœ‰ä¸€ä¸ªè®¡æ—¶å·¥å…·æˆ–IDï¼ˆåºå·ï¼‰ç”Ÿæˆå™¨ã€‚</p><p>å¦‚ä½•ä¿è¯ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹å¹¶ä¸”è¿™ä¸ªå®ä¾‹æ˜“äºè¢«è®¿é—®å‘¢ï¼Ÿå®šä¹‰ä¸€ä¸ªå…¨å±€å˜é‡å¯ä»¥ç¡®ä¿å¯¹è±¡éšæ—¶éƒ½å¯ä»¥è¢«è®¿é—®ï¼Œä½†ä¸èƒ½é˜²æ­¢æˆ‘ä»¬å®ä¾‹åŒ–å¤šä¸ªå¯¹è±¡ã€‚</p><p>ä¸€ä¸ªæ›´å¥½çš„è§£å†³åŠæ³•æ˜¯è®©ç±»è‡ªèº«è´Ÿè´£ä¿å­˜å®ƒçš„å”¯ä¸€å®ä¾‹ã€‚è¿™ä¸ªç±»å¯ä»¥ä¿è¯æ²¡æœ‰å…¶ä»–å®ä¾‹è¢«åˆ›å»ºï¼Œå¹¶ä¸”å®ƒå¯ä»¥æä¾›ä¸€ä¸ªè®¿é—®è¯¥å®ä¾‹çš„æ–¹æ³•ã€‚è¿™å°±æ˜¯å•ä¾‹æ¨¡å¼çš„æ¨¡å¼åŠ¨æœºã€‚</p><h3 id="äºŒ-æ¨¡å¼å®šä¹‰"><a href="#äºŒ-æ¨¡å¼å®šä¹‰" class="headerlink" title="äºŒ.æ¨¡å¼å®šä¹‰"></a>äºŒ.æ¨¡å¼å®šä¹‰</h3><p>å•ä¾‹æ¨¡å¼(Singleton Pattern)ï¼š<strong>å•ä¾‹æ¨¡å¼ç¡®ä¿æŸä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹</strong>ï¼Œè€Œä¸”è‡ªè¡Œå®ä¾‹åŒ–å¹¶å‘æ•´ä¸ªç³»ç»Ÿæä¾›è¿™ä¸ªå®ä¾‹ï¼Œè¿™ä¸ªç±»ç§°ä¸ºå•ä¾‹ç±»ï¼Œå®ƒæä¾›å…¨å±€è®¿é—®çš„æ–¹æ³•ã€‚</p><p>å•ä¾‹æ¨¡å¼çš„è¦ç‚¹æœ‰ä¸‰ä¸ªï¼š<strong>ä¸€æ˜¯æŸä¸ªç±»åªèƒ½æœ‰ä¸€ä¸ªå®ä¾‹ï¼›äºŒæ˜¯å®ƒå¿…é¡»è‡ªè¡Œåˆ›å»ºè¿™ä¸ªå®ä¾‹ï¼›ä¸‰æ˜¯å®ƒå¿…é¡»è‡ªè¡Œå‘æ•´ä¸ªç³»ç»Ÿæä¾›è¿™ä¸ªå®ä¾‹</strong>ã€‚å•ä¾‹æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡åˆ›å»ºå‹æ¨¡å¼ã€‚å•ä¾‹æ¨¡å¼åˆåå•ä»¶æ¨¡å¼æˆ–å•æ€æ¨¡å¼ã€‚</p><h3 id="ä¸‰-æ¨¡å¼ç»“æ„"><a href="#ä¸‰-æ¨¡å¼ç»“æ„" class="headerlink" title="ä¸‰.æ¨¡å¼ç»“æ„"></a>ä¸‰.æ¨¡å¼ç»“æ„</h3><p>å•ä¾‹æ¨¡å¼åŒ…å«å¦‚ä¸‹è§’è‰²ï¼š</p><ul><li>Singletonï¼šå•ä¾‹</li></ul><p><img src="F:\blog\coderyeah\source\_posts\img\image-20230110153503088.png" alt="image-20230110153503088"></p><h3 id="å››-ä»£ç ç¤ºä¾‹"><a href="#å››-ä»£ç ç¤ºä¾‹" class="headerlink" title="å››.ä»£ç ç¤ºä¾‹"></a>å››.ä»£ç ç¤ºä¾‹</h3><ol><li><p>å•ä¾‹æ¨¡å¼-é¥¿æ±‰æ¨¡å¼</p><p>é¥¿æ±‰å¼åœ¨ç±»åˆ›å»ºçš„åŒæ—¶å°±å·²ç»åˆ›å»ºå¥½ä¸€ä¸ªé™æ€çš„å¯¹è±¡ä¾›ç³»ç»Ÿä½¿ç”¨ï¼Œä¸å†æ”¹å˜ï¼Œæ˜¯<strong>çº¿ç¨‹å®‰å…¨</strong>çš„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.singleton;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Singleton</span> &#123;<span class="comment">// å•ä¾‹è®¾è®¡æ¨¡å¼</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Singleton</span> <span class="variable">singleton</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Singleton</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ„é€ æ–¹æ³•ç§æœ‰åŒ–</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Singleton</span><span class="params">()</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> singleton;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>å•ä¾‹æ¨¡å¼-æ‡’æ±‰æ¨¡å¼ï¼ˆçº¿ç¨‹ä¸å®‰å…¨ï¼‰</p><p>â‘  åœ¨<code>getInstance2</code>æ–¹æ³•ä¸ŠåŠ åŒæ­¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.singleton;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Singleton2</span> &#123;<span class="comment">// æ‡’åŠ è½½å•ä¾‹æ¨¡å¼</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Singleton2</span><span class="params">()</span> &#123;&#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Singleton2</span> <span class="variable">singleton2</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">static</span> Singleton2 <span class="title function_">getInstance2</span><span class="params">()</span> &#123;<span class="comment">// é˜²æ­¢é«˜å¹¶å‘åˆ›å»ºå¤šä¸ªå®ä¾‹</span></span><br><span class="line">        <span class="keyword">if</span> (singleton2 == <span class="literal">null</span>) &#123;</span><br><span class="line">            singleton2 = <span class="keyword">new</span> <span class="title class_">Singleton2</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> singleton2;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â‘¡ åŒé‡é”é‰´å®š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.singleton;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lqs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/1/10 15:55</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Singleton</span> &#123; <span class="comment">//æ‡’æ±‰å•ä¾‹æ¨¡å¼</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Singleton</span> <span class="variable">SINGLETON</span> <span class="operator">=</span> <span class="literal">null</span>; <span class="comment">// å”¯ä¸€å®ä¾‹</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ„é€ æ–¹æ³•ç§æœ‰åŒ–</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Singleton</span><span class="params">()</span> &#123;&#125;</span><br><span class="line">    <span class="comment">// åˆ›å»ºå®ä¾‹é™æ€æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (SINGLETON == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (Singleton.class) &#123;</span><br><span class="line">                <span class="keyword">if</span> (SINGLETON == <span class="literal">null</span>) &#123;</span><br><span class="line">                    SINGLETON = <span class="keyword">new</span> <span class="title class_">Singleton</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> SINGLETON;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â‘¢ é™æ€å†…éƒ¨ç±»ï¼ˆåœ¨ä½¿ç”¨æ—¶æ‰ä¼šè¢«åŠ è½½ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.singleton;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lqs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/1/10 16:02</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Singleton</span> &#123; <span class="comment">// é™æ€å†…éƒ¨ç±»è§£å†³å•ä¾‹æ‡’æ±‰æ¨¡å¼çš„çº¿ç¨‹å®‰å…¨é—®é¢˜</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">LazyLoad</span> &#123;</span><br><span class="line">        <span class="comment">// å”¯ä¸€å®ä¾‹å¯¹è±¡</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Singleton</span> <span class="variable">SINGLETON</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Singleton</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ„é€ æ–¹æ³•ç§æœ‰åŒ–</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Singleton</span><span class="params">()</span>&#123;&#125;</span><br><span class="line">    <span class="comment">// é™æ€æ–¹æ³•è·å–å®ä¾‹å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> LazyLoad.SINGLETON;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h3 id="äº”-æ¨¡å¼åˆ†æ"><a href="#äº”-æ¨¡å¼åˆ†æ" class="headerlink" title="äº”.æ¨¡å¼åˆ†æ"></a>äº”.æ¨¡å¼åˆ†æ</h3><p>å•ä¾‹æ¨¡å¼çš„ç›®çš„æ˜¯ä¿è¯<strong>ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹</strong>ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„<strong>å…¨å±€è®¿é—®ç‚¹</strong>ã€‚å•ä¾‹æ¨¡å¼åŒ…å«çš„è§’è‰²åªæœ‰ä¸€ä¸ªï¼Œå°±æ˜¯å•ä¾‹ç±»â€”â€”<strong>Singleton</strong>ã€‚å•ä¾‹ç±»æ‹¥æœ‰ä¸€ä¸ª<strong>ç§æœ‰æ„é€ å‡½æ•°</strong>ï¼Œç¡®ä¿ç”¨æˆ·æ— æ³•é€šè¿‡newå…³é”®å­—ç›´æ¥å®ä¾‹åŒ–å®ƒã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¯¥æ¨¡å¼ä¸­åŒ…å«ä¸€ä¸ª<strong>é™æ€ç§æœ‰æˆå‘˜å˜é‡ä¸é™æ€å…¬æœ‰çš„å·¥å‚æ–¹æ³•</strong>ï¼Œè¯¥å·¥å‚æ–¹æ³•è´Ÿè´£æ£€éªŒå®ä¾‹çš„å­˜åœ¨æ€§å¹¶å®ä¾‹åŒ–è‡ªå·±ï¼Œç„¶åå­˜å‚¨åœ¨é™æ€æˆå‘˜å˜é‡ä¸­ï¼Œä»¥ç¡®ä¿åªæœ‰ä¸€ä¸ªå®ä¾‹è¢«åˆ›å»ºã€‚</p><p>åœ¨å•ä¾‹æ¨¡å¼çš„å®ç°è¿‡ç¨‹ä¸­ï¼Œéœ€è¦æ³¨æ„å¦‚ä¸‹ä¸‰ç‚¹ï¼š</p><ul><li>å•ä¾‹ç±»çš„æ„é€ å‡½æ•°ä¸ºç§æœ‰ï¼›</li><li>æä¾›ä¸€ä¸ªè‡ªèº«çš„é™æ€ç§æœ‰æˆå‘˜å˜é‡ï¼›</li><li>æä¾›ä¸€ä¸ªå…¬æœ‰çš„é™æ€å·¥å‚æ–¹æ³•ã€‚</li></ul><h3 id="å…­-ä¼˜ç‚¹"><a href="#å…­-ä¼˜ç‚¹" class="headerlink" title="å…­.ä¼˜ç‚¹"></a>å…­.ä¼˜ç‚¹</h3><ul><li>æä¾›äº†å¯¹å”¯ä¸€å®ä¾‹çš„å—æ§è®¿é—®ã€‚å› ä¸ºå•ä¾‹ç±»å°è£…äº†å®ƒçš„å”¯ä¸€å®ä¾‹ï¼Œæ‰€ä»¥å®ƒå¯ä»¥ä¸¥æ ¼æ§åˆ¶å®¢æˆ·æ€æ ·ä»¥åŠä½•æ—¶è®¿é—®å®ƒï¼Œå¹¶ä¸ºè®¾è®¡åŠå¼€å‘å›¢é˜Ÿæä¾›äº†<strong>å…±äº«</strong>çš„æ¦‚å¿µã€‚</li><li>ç”±äºåœ¨ç³»ç»Ÿå†…å­˜ä¸­åªå­˜åœ¨ä¸€ä¸ªå¯¹è±¡ï¼Œå› æ­¤å¯ä»¥<strong>èŠ‚çº¦ç³»ç»Ÿèµ„æº</strong>ï¼Œå¯¹äºä¸€äº›éœ€è¦é¢‘ç¹åˆ›å»ºå’Œé”€æ¯çš„å¯¹è±¡ï¼Œå•ä¾‹æ¨¡å¼æ— ç–‘å¯ä»¥æé«˜ç³»ç»Ÿçš„æ€§èƒ½ã€‚</li><li>å…è®¸å¯å˜æ•°ç›®çš„å®ä¾‹ã€‚æˆ‘ä»¬å¯ä»¥åŸºäºå•ä¾‹æ¨¡å¼è¿›è¡Œæ‰©å±•ï¼Œä½¿ç”¨ä¸å•ä¾‹æ§åˆ¶ç›¸ä¼¼çš„æ–¹æ³•æ¥è·å¾—æŒ‡å®šä¸ªæ•°çš„å¯¹è±¡å®ä¾‹ã€‚</li></ul><h3 id="ä¸ƒ-ç¼ºç‚¹"><a href="#ä¸ƒ-ç¼ºç‚¹" class="headerlink" title="ä¸ƒ.ç¼ºç‚¹"></a>ä¸ƒ.ç¼ºç‚¹</h3><ul><li>ç”±äºå•ä¾‹æ¨¡å¼ä¸­æ²¡æœ‰æŠ½è±¡å±‚ï¼Œå› æ­¤å•ä¾‹ç±»çš„æ‰©å±•æœ‰å¾ˆå¤§çš„å›°éš¾ã€‚</li><li>å•ä¾‹ç±»çš„èŒè´£è¿‡é‡ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šè¿èƒŒäº†â€œ<strong>å•ä¸€èŒè´£åŸåˆ™</strong>â€ã€‚å› ä¸ºå•ä¾‹ç±»æ—¢å……å½“äº†å·¥å‚è§’è‰²ï¼Œæä¾›äº†å·¥å‚æ–¹æ³•ï¼ŒåŒæ—¶åˆå……å½“äº†äº§å“è§’è‰²ï¼ŒåŒ…å«ä¸€äº›ä¸šåŠ¡æ–¹æ³•ï¼Œå°†äº§å“çš„åˆ›å»ºå’Œäº§å“çš„æœ¬èº«çš„åŠŸèƒ½èåˆåˆ°ä¸€èµ·ã€‚</li><li>æ»¥ç”¨å•ä¾‹å°†å¸¦æ¥ä¸€äº›è´Ÿé¢é—®é¢˜ï¼Œå¦‚ä¸ºäº†èŠ‚çœèµ„æºå°†æ•°æ®åº“è¿æ¥æ± å¯¹è±¡è®¾è®¡ä¸ºå•ä¾‹ç±»ï¼Œå¯èƒ½ä¼šå¯¼è‡´å…±äº«è¿æ¥æ± å¯¹è±¡çš„ç¨‹åºè¿‡å¤šè€Œå‡ºç°è¿æ¥æ± æº¢å‡ºï¼›ç°åœ¨å¾ˆå¤šé¢å‘å¯¹è±¡è¯­è¨€(å¦‚Javaã€C#)çš„è¿è¡Œç¯å¢ƒéƒ½æä¾›äº†è‡ªåŠ¨åƒåœ¾å›æ”¶çš„æŠ€æœ¯ï¼Œå› æ­¤ï¼Œå¦‚æœå®ä¾‹åŒ–çš„å¯¹è±¡é•¿æ—¶é—´ä¸è¢«åˆ©ç”¨ï¼Œç³»ç»Ÿä¼šè®¤ä¸ºå®ƒæ˜¯åƒåœ¾ï¼Œä¼šè‡ªåŠ¨é”€æ¯å¹¶å›æ”¶èµ„æºï¼Œä¸‹æ¬¡åˆ©ç”¨æ—¶åˆå°†é‡æ–°å®ä¾‹åŒ–ï¼Œè¿™å°†å¯¼è‡´å¯¹è±¡çŠ¶æ€çš„ä¸¢å¤±ã€‚</li></ul><h3 id="å…«-é€‚ç”¨ç¯å¢ƒ"><a href="#å…«-é€‚ç”¨ç¯å¢ƒ" class="headerlink" title="å…«.é€‚ç”¨ç¯å¢ƒ"></a>å…«.é€‚ç”¨ç¯å¢ƒ</h3><p>åœ¨ä»¥ä¸‹æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨å•ä¾‹æ¨¡å¼ï¼š</p><ul><li>ç³»ç»Ÿåªéœ€è¦ä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼Œå¦‚ç³»ç»Ÿè¦æ±‚æä¾›ä¸€ä¸ªå”¯ä¸€çš„åºåˆ—å·ç”Ÿæˆå™¨ï¼Œæˆ–è€…éœ€è¦è€ƒè™‘èµ„æºæ¶ˆè€—å¤ªå¤§è€Œåªå…è®¸åˆ›å»ºä¸€ä¸ªå¯¹è±¡ã€‚</li><li>å®¢æˆ·è°ƒç”¨ç±»çš„å•ä¸ªå®ä¾‹åªå…è®¸ä½¿ç”¨ä¸€ä¸ªå…¬å…±è®¿é—®ç‚¹ï¼Œé™¤äº†è¯¥å…¬å…±è®¿é—®ç‚¹ï¼Œä¸èƒ½é€šè¿‡å…¶ä»–é€”å¾„è®¿é—®è¯¥å®ä¾‹ã€‚</li><li>åœ¨ä¸€ä¸ªç³»ç»Ÿä¸­è¦æ±‚ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹æ—¶æ‰åº”å½“ä½¿ç”¨å•ä¾‹æ¨¡å¼ã€‚åè¿‡æ¥ï¼Œå¦‚æœä¸€ä¸ªç±»å¯ä»¥æœ‰å‡ ä¸ªå®ä¾‹å…±å­˜ï¼Œå°±éœ€è¦å¯¹å•ä¾‹æ¨¡å¼è¿›è¡Œæ”¹è¿›ï¼Œä½¿ä¹‹æˆä¸ºå¤šä¾‹æ¨¡å¼ã€‚</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;ä¸€-æ¨¡å¼åŠ¨æœº&quot;&gt;&lt;a href=&quot;#ä¸€-æ¨¡å¼åŠ¨æœº&quot; class=&quot;headerlink&quot; title=&quot;ä¸€.æ¨¡å¼åŠ¨æœº&quot;&gt;&lt;/a&gt;ä¸€.æ¨¡å¼åŠ¨æœº&lt;/h3&gt;&lt;p&gt;å¯¹äºç³»ç»Ÿä¸­çš„æŸäº›ç±»æ¥è¯´ï¼Œ&lt;strong&gt;åªæœ‰ä¸€ä¸ªå®ä¾‹&lt;/strong&gt;å¾ˆé‡è¦ï¼Œä¾‹å¦‚ï¼Œä¸€ä¸ªç³»ç»Ÿä¸­å¯ä»¥å­˜åœ¨å¤šä¸ªæ‰“</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼ä¹‹æŠ½è±¡å·¥å‚æ¨¡å¼</title>
    <link href="https://www.fomal.cc/posts/1ef33906.html"/>
    <id>https://www.fomal.cc/posts/1ef33906.html</id>
    <published>2025-05-20T08:38:30.598Z</published>
    <updated>2023-01-30T09:32:36.143Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ä¸€-æ¨¡å¼åŠ¨æœº"><a href="#ä¸€-æ¨¡å¼åŠ¨æœº" class="headerlink" title="ä¸€.æ¨¡å¼åŠ¨æœº"></a>ä¸€.æ¨¡å¼åŠ¨æœº</h3><ul><li><p>åœ¨å·¥å‚æ–¹æ³•æ¨¡å¼ä¸­å…·ä½“å·¥å‚è´Ÿè´£ç”Ÿäº§å…·ä½“çš„äº§å“ï¼Œæ¯ä¸€ä¸ªå…·ä½“å·¥å‚å¯¹åº”ä¸€ç§å…·ä½“äº§å“ï¼Œå·¥å‚æ–¹æ³•ä¹Ÿå…·æœ‰å”¯ä¸€æ€§ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸€ä¸ªå…·ä½“å·¥å‚ä¸­åªæœ‰ä¸€ä¸ªå·¥å‚æ–¹æ³•æˆ–è€…ä¸€ç»„é‡è½½çš„å·¥å‚æ–¹æ³•ã€‚ä½†æ˜¯æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦<strong>ä¸€ä¸ªå·¥å‚å¯ä»¥æä¾›å¤šä¸ªäº§å“å¯¹è±¡</strong>ï¼Œè€Œä¸æ˜¯å•ä¸€çš„äº§å“å¯¹è±¡ã€‚</p><blockquote><p>ä¸ºäº†æ›´æ¸…æ™°åœ°ç†è§£å·¥å‚æ–¹æ³•æ¨¡å¼ï¼Œéœ€è¦å…ˆå¼•å…¥ä¸¤ä¸ªæ¦‚å¿µï¼š</p><ul><li><strong>äº§å“ç­‰çº§ç»“æ„</strong> ï¼šäº§å“ç­‰çº§ç»“æ„å³äº§å“çš„ç»§æ‰¿ç»“æ„ï¼Œå¦‚ä¸€ä¸ªæŠ½è±¡ç±»æ˜¯ç”µè§†æœºï¼Œå…¶å­ç±»æœ‰æµ·å°”ç”µè§†æœºã€æµ·ä¿¡ç”µè§†æœºã€TCLç”µè§†æœºï¼Œåˆ™æŠ½è±¡ç”µè§†æœºä¸å…·ä½“å“ç‰Œçš„ç”µè§†æœºä¹‹é—´æ„æˆäº†ä¸€ä¸ªäº§å“ç­‰çº§ç»“æ„ï¼Œ<strong>æŠ½è±¡ç”µè§†æœºæ˜¯çˆ¶ç±»ï¼Œè€Œå…·ä½“å“ç‰Œçš„ç”µè§†æœºæ˜¯å…¶å­ç±»</strong>ã€‚</li><li><strong>äº§å“æ—</strong> ï¼šåœ¨æŠ½è±¡å·¥å‚æ¨¡å¼ä¸­ï¼Œ<strong>äº§å“æ—æ˜¯æŒ‡ç”±åŒä¸€ä¸ªå·¥å‚ç”Ÿäº§çš„</strong>ï¼Œä½äºä¸åŒäº§å“ç­‰çº§ç»“æ„ä¸­çš„ä¸€ç»„äº§å“ï¼Œå¦‚æµ·å°”ç”µå™¨å·¥å‚ç”Ÿäº§çš„æµ·å°”ç”µè§†æœºã€æµ·å°”ç”µå†°ç®±ï¼Œæµ·å°”ç”µè§†æœºä½äºç”µè§†æœºäº§å“ç­‰çº§ç»“æ„ä¸­ï¼Œæµ·å°”ç”µå†°ç®±ä½äºç”µå†°ç®±äº§å“ç­‰çº§ç»“æ„ä¸­ã€‚</li></ul></blockquote></li><li><p>å½“ç³»ç»Ÿæ‰€æä¾›çš„å·¥å‚æ‰€éœ€ç”Ÿäº§çš„å…·ä½“äº§å“å¹¶ä¸æ˜¯ä¸€ä¸ªç®€å•çš„å¯¹è±¡ï¼Œè€Œæ˜¯å¤šä¸ªä½äºä¸åŒäº§å“ç­‰çº§ç»“æ„ä¸­å±äºä¸åŒç±»å‹çš„å…·ä½“äº§å“æ—¶éœ€è¦ä½¿ç”¨æŠ½è±¡å·¥å‚æ¨¡å¼ã€‚</p></li><li><p>æŠ½è±¡å·¥å‚æ¨¡å¼æ˜¯æ‰€æœ‰å½¢å¼çš„å·¥å‚æ¨¡å¼ä¸­æœ€ä¸ºæŠ½è±¡å’Œæœ€å…·ä¸€èˆ¬æ€§çš„ä¸€ç§å½¢æ€ã€‚</p><ul><li>æŠ½è±¡å·¥å‚æ¨¡å¼ä¸å·¥å‚æ–¹æ³•æ¨¡å¼æœ€å¤§çš„åŒºåˆ«åœ¨äºï¼Œ<strong>å·¥å‚æ–¹æ³•æ¨¡å¼é’ˆå¯¹çš„æ˜¯ä¸€ä¸ªäº§å“ç­‰çº§ç»“æ„ï¼Œè€ŒæŠ½è±¡å·¥å‚æ¨¡å¼åˆ™éœ€è¦é¢å¯¹å¤šä¸ªäº§å“ç­‰çº§ç»“æ„ï¼Œä¸€ä¸ªå·¥å‚ç­‰çº§ç»“æ„å¯ä»¥è´Ÿè´£å¤šä¸ªä¸åŒäº§å“ç­‰çº§ç»“æ„ä¸­çš„äº§å“å¯¹è±¡çš„åˆ›å»º</strong> ã€‚å½“ä¸€ä¸ªå·¥å‚ç­‰çº§ç»“æ„å¯ä»¥åˆ›å»ºå‡ºåˆ†å±äºä¸åŒäº§å“ç­‰çº§ç»“æ„çš„ä¸€ä¸ªäº§å“æ—ä¸­çš„æ‰€æœ‰å¯¹è±¡æ—¶ï¼ŒæŠ½è±¡å·¥å‚æ¨¡å¼æ¯”å·¥å‚æ–¹æ³•æ¨¡å¼æ›´ä¸ºç®€å•ã€æœ‰æ•ˆç‡ã€‚</li></ul></li></ul><h3 id="äºŒ-æ¨¡å¼å®šä¹‰"><a href="#äºŒ-æ¨¡å¼å®šä¹‰" class="headerlink" title="äºŒ.æ¨¡å¼å®šä¹‰"></a>äºŒ.æ¨¡å¼å®šä¹‰</h3><p>æŠ½è±¡å·¥å‚æ¨¡å¼(Abstract Factory Pattern)ï¼šæä¾›ä¸€ä¸ªåˆ›å»ºä¸€ç³»åˆ—ç›¸å…³æˆ–ç›¸äº’ä¾èµ–å¯¹è±¡çš„æ¥å£ï¼Œè€Œæ— é¡»æŒ‡å®šå®ƒä»¬å…·ä½“çš„ç±»ã€‚æŠ½è±¡å·¥å‚æ¨¡å¼åˆç§°ä¸ºKitæ¨¡å¼ï¼Œå±äºå¯¹è±¡åˆ›å»ºå‹æ¨¡å¼ã€‚</p><h3 id="ä¸‰-æ¨¡å¼ç»“æ„"><a href="#ä¸‰-æ¨¡å¼ç»“æ„" class="headerlink" title="ä¸‰.æ¨¡å¼ç»“æ„"></a>ä¸‰.æ¨¡å¼ç»“æ„</h3><p>æŠ½è±¡å·¥å‚æ¨¡å¼åŒ…å«å¦‚ä¸‹è§’è‰²ï¼š</p><ul><li><code>AbstractFactory</code>ï¼šæŠ½è±¡å·¥å‚æ¨¡å¼çš„æ ¸å¿ƒï¼ŒåŒ…å«å¯¹å¤šä¸ªäº§å“ç­‰çº§ç»“æ„çš„å£°æ˜ï¼Œä»»ä½•å·¥å‚ç±»éƒ½å¿…é¡»å®ç°è¿™ä¸ªæ¥å£ã€‚</li><li><code>ConcreteFactory</code>ï¼šå…·ä½“å·¥å‚ç±»æ˜¯æŠ½è±¡å·¥å‚çš„ä¸€ä¸ªå®ç°ï¼Œè´Ÿè´£å®ä¾‹åŒ–æŸä¸ªäº§å“æ—ä¸­çš„äº§å“å¯¹è±¡ã€‚</li><li><code>AbstractProduct</code>ï¼šæŠ½è±¡æ¨¡å¼æ‰€åˆ›å»ºçš„æ‰€æœ‰å¯¹è±¡çš„çˆ¶ç±»ï¼Œæˆ–å£°æ˜æ‰€æœ‰å…·ä½“äº§å“æ‰€å…±æœ‰çš„å…¬å…±æ¥å£ã€‚</li><li><code>Product</code>ï¼šæŠ½è±¡å·¥å‚æ¨¡å¼æ‰€åˆ›å»ºçš„çœŸæ­£å®ä¾‹ã€‚</li></ul><p><img src="img/image-20230110101800602.png" alt="image-20230110101800602"></p><h3 id="å››-å®åºå›¾"><a href="#å››-å®åºå›¾" class="headerlink" title="å››.å®åºå›¾"></a>å››.å®åºå›¾</h3><p><img src="img/image-20230110102043096.png" alt="image-20230110102043096"></p><h3 id="äº”-ä»£ç å®ä¾‹"><a href="#äº”-ä»£ç å®ä¾‹" class="headerlink" title="äº”.ä»£ç å®ä¾‹"></a>äº”.ä»£ç å®ä¾‹</h3><h4 id="æ¶æ„å›¾"><a href="#æ¶æ„å›¾" class="headerlink" title="æ¶æ„å›¾"></a>æ¶æ„å›¾</h4><p><img src="img/image-20230110141525649.png" alt="image-20230110141525649"></p><ol><li><p><code>AbstractFactory</code>æŠ½è±¡å·¥å‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.abstractFactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lqs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/1/10 11:17</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ProductFactory</span> &#123; <span class="comment">// ç”Ÿäº§äº§å“çš„å·¥å‚ å°±æ˜¯æŠ½è±¡å·¥å‚</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºPhoneå®ä¾‹çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Phone <span class="title function_">createPhone</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºComputerå®ä¾‹çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Computer <span class="title function_">createComputer</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><code>ConcreteFactory</code>å…·ä½“å·¥å‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.abstractFactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lqs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/1/10 11:36</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HuaWeiFactory</span> <span class="keyword">implements</span> <span class="title class_">ProductFactory</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Phone <span class="title function_">createPhone</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">HuaWeiPhone</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Computer <span class="title function_">createComputer</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">HuaWeiComputer</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><code>Product</code>æŠ½è±¡å·¥å‚æ¨¡å¼æ‰€åˆ›å»ºçš„çœŸæ­£å®ä¾‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.abstractFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HuaWeiComputer</span> <span class="keyword">implements</span> <span class="title class_">Computer</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">showPhone</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;this is a HUAWEI Computer...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.abstractFactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lqs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/1/10 11:40</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HuaWeiPhone</span> <span class="keyword">implements</span> <span class="title class_">Phone</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">showPhone</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;this is a HUAWEI Phone...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><code>AbstractProduct</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.abstractFactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lqs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/1/10 11:18</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Computer</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">showPhone</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.abstractFactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lqs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/1/10 11:18</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Phone</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">showPhone</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æµ‹è¯•(å¯ä»¥è‡ªå»ºXiaoMiFactoryç±»å¹¶å®ç°å·¥å‚æ¥å£ï¼Œåˆ›é€ å‡ºå°ç±³äº§å“)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lqs.abstractFactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lqs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/1/10 14:00</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ProductFactory</span> <span class="variable">huaWeiFactory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HuaWeiFactory</span>(); <span class="comment">// å‘ä¸Šè½¬å‹</span></span><br><span class="line">        huaWeiFactory.createPhone().showPhone();<span class="comment">// this is a HUAWEI Phone...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h3 id="å…­-ä¼˜ç‚¹"><a href="#å…­-ä¼˜ç‚¹" class="headerlink" title="å…­.ä¼˜ç‚¹"></a>å…­.ä¼˜ç‚¹</h3><ul><li>æŠ½è±¡å·¥å‚æ¨¡å¼éš”ç¦»äº†å…·ä½“ç±»çš„ç”Ÿæˆï¼Œä½¿å¾—å®¢æˆ·å¹¶ä¸éœ€è¦çŸ¥é“ä»€ä¹ˆè¢«åˆ›å»ºã€‚ç”±äºè¿™ç§éš”ç¦»ï¼Œæ›´æ¢ä¸€ä¸ªå…·ä½“å·¥å‚å°±å˜å¾—ç›¸å¯¹å®¹æ˜“ã€‚æ‰€æœ‰çš„å…·ä½“å·¥å‚éƒ½å®ç°äº†æŠ½è±¡å·¥å‚ä¸­å®šä¹‰çš„é‚£äº›å…¬å…±æ¥å£ï¼Œå› æ­¤åªéœ€æ”¹å˜å…·ä½“å·¥å‚çš„å®ä¾‹ï¼Œå°±å¯ä»¥åœ¨æŸç§ç¨‹åº¦ä¸Šæ”¹å˜æ•´ä¸ªè½¯ä»¶ç³»ç»Ÿçš„è¡Œä¸ºã€‚å¦å¤–ï¼Œåº”ç”¨æŠ½è±¡å·¥å‚æ¨¡å¼å¯ä»¥å®ç°<strong>é«˜å†…èšä½è€¦åˆ</strong>çš„è®¾è®¡ç›®çš„ï¼Œå› æ­¤æŠ½è±¡å·¥å‚æ¨¡å¼å¾—åˆ°äº†å¹¿æ³›çš„åº”ç”¨ã€‚</li><li>å½“ä¸€ä¸ªäº§å“æ—ä¸­çš„å¤šä¸ªå¯¹è±¡è¢«è®¾è®¡æˆä¸€èµ·å·¥ä½œæ—¶ï¼Œå®ƒèƒ½å¤Ÿä¿è¯å®¢æˆ·ç«¯å§‹ç»ˆåªä½¿ç”¨åŒä¸€ä¸ªäº§å“æ—ä¸­çš„å¯¹è±¡ã€‚è¿™å¯¹ä¸€äº›éœ€è¦æ ¹æ®å½“å‰ç¯å¢ƒæ¥å†³å®šå…¶è¡Œä¸ºçš„è½¯ä»¶ç³»ç»Ÿæ¥è¯´ï¼Œæ˜¯ä¸€ç§éå¸¸å®ç”¨çš„è®¾è®¡æ¨¡å¼ã€‚</li><li>å¢åŠ æ–°çš„å…·ä½“å·¥å‚å’Œäº§å“ æ—å¾ˆæ–¹ä¾¿ï¼Œæ— é¡»ä¿®æ”¹å·²æœ‰ç³»ç»Ÿï¼Œç¬¦åˆâ€œå¼€é—­åŸåˆ™â€ã€‚</li></ul><h3 id="ä¸ƒ-ç¼ºç‚¹"><a href="#ä¸ƒ-ç¼ºç‚¹" class="headerlink" title="ä¸ƒ.ç¼ºç‚¹"></a>ä¸ƒ.ç¼ºç‚¹</h3><ul><li>åœ¨æ·»åŠ æ–°çš„äº§å“å¯¹è±¡æ—¶ï¼Œéš¾ä»¥æ‰©å±•æŠ½è±¡å·¥å‚æ¥ç”Ÿäº§æ–°ç§ç±»çš„äº§å“ï¼Œè¿™æ˜¯å› ä¸ºåœ¨æŠ½è±¡å·¥å‚è§’è‰²ä¸­è§„å®šäº†æ‰€æœ‰å¯èƒ½è¢«åˆ›å»ºçš„äº§å“é›†åˆï¼Œè¦æ”¯æŒæ–°ç§ç±»çš„äº§å“å°±æ„å‘³ç€è¦å¯¹è¯¥æ¥å£è¿›è¡Œæ‰©å±•ï¼Œè€Œè¿™å°†æ¶‰åŠåˆ°å¯¹æŠ½è±¡å·¥å‚è§’è‰²åŠå…¶æ‰€æœ‰å­ç±»çš„ä¿®æ”¹ï¼Œæ˜¾ç„¶ä¼šå¸¦æ¥è¾ƒå¤§çš„ä¸ä¾¿ã€‚</li><li>å¼€é—­åŸåˆ™çš„å€¾æ–œæ€§ï¼ˆå¢åŠ æ–°çš„å·¥å‚å’Œäº§å“æ—å®¹æ˜“ï¼Œå¢åŠ æ–°çš„äº§å“ç­‰çº§ç»“æ„éº»çƒ¦ï¼‰ã€‚</li></ul><h3 id="å…«-æ€»ç»“"><a href="#å…«-æ€»ç»“" class="headerlink" title="å…«.æ€»ç»“"></a>å…«.æ€»ç»“</h3><ul><li>æŠ½è±¡å·¥å‚æ¨¡å¼æä¾›ä¸€ä¸ª<strong>åˆ›å»ºä¸€ç³»åˆ—ç›¸å…³æˆ–ç›¸äº’ä¾èµ–å¯¹è±¡çš„æ¥å£</strong>ï¼Œè€Œæ— é¡»æŒ‡å®šå®ƒä»¬å…·ä½“çš„ç±»ã€‚æŠ½è±¡å·¥å‚æ¨¡å¼åˆç§°ä¸ºKitæ¨¡å¼ï¼Œå±äºå¯¹è±¡åˆ›å»ºå‹æ¨¡å¼ã€‚</li><li>æŠ½è±¡å·¥å‚æ¨¡å¼åŒ…å«å››ä¸ªè§’è‰²ï¼š<strong>æŠ½è±¡å·¥å‚</strong>ç”¨äºå£°æ˜ç”ŸæˆæŠ½è±¡äº§å“çš„æ–¹æ³•ï¼›<strong>å…·ä½“å·¥å‚</strong>å®ç°äº†æŠ½è±¡å·¥å‚å£°æ˜çš„ç”ŸæˆæŠ½è±¡äº§å“çš„æ–¹æ³•ï¼Œç”Ÿæˆä¸€ç»„å…·ä½“äº§å“ï¼Œè¿™äº›äº§å“æ„æˆäº†ä¸€ä¸ª<strong>äº§å“æ—</strong>ï¼Œæ¯ä¸€ä¸ªäº§å“éƒ½ä½äºæŸä¸ª<strong>äº§å“ç­‰çº§</strong>ç»“æ„ä¸­ï¼›<strong>æŠ½è±¡äº§å“</strong>ä¸ºæ¯ç§äº§å“å£°æ˜æ¥å£ï¼Œåœ¨æŠ½è±¡äº§å“ä¸­å®šä¹‰äº†äº§å“çš„æŠ½è±¡ä¸šåŠ¡æ–¹æ³•ï¼›<strong>å…·ä½“äº§å“</strong>å®šä¹‰å…·ä½“å·¥å‚ç”Ÿäº§çš„å…·ä½“äº§å“å¯¹è±¡ï¼Œå®ç°æŠ½è±¡äº§å“æ¥å£ä¸­å®šä¹‰çš„ä¸šåŠ¡æ–¹æ³•ã€‚</li><li>æŠ½è±¡å·¥å‚æ¨¡å¼æ˜¯æ‰€æœ‰å½¢å¼çš„å·¥å‚æ¨¡å¼ä¸­æœ€ä¸ºæŠ½è±¡å’Œæœ€å…·ä¸€èˆ¬æ€§çš„ä¸€ç§å½¢æ€ã€‚æŠ½è±¡å·¥å‚æ¨¡å¼ä¸å·¥å‚æ–¹æ³•æ¨¡å¼æœ€å¤§çš„åŒºåˆ«åœ¨äºï¼Œ<strong>å·¥å‚æ–¹æ³•æ¨¡å¼é’ˆå¯¹çš„æ˜¯ä¸€ä¸ªäº§å“ç­‰çº§ç»“æ„ï¼Œè€ŒæŠ½è±¡å·¥å‚æ¨¡å¼åˆ™éœ€è¦é¢å¯¹å¤šä¸ªäº§å“ç­‰çº§ç»“æ„</strong>ã€‚</li><li>æŠ½è±¡å·¥å‚æ¨¡å¼çš„ä¸»è¦ä¼˜ç‚¹æ˜¯éš”ç¦»äº†å…·ä½“ç±»çš„ç”Ÿæˆï¼Œä½¿å¾—å®¢æˆ·å¹¶ä¸éœ€è¦çŸ¥é“ä»€ä¹ˆè¢«åˆ›å»ºï¼Œè€Œä¸”æ¯æ¬¡å¯ä»¥é€šè¿‡å…·ä½“å·¥å‚ç±»åˆ›å»ºä¸€ä¸ªäº§å“æ—ä¸­çš„å¤šä¸ªå¯¹è±¡ï¼Œå¢åŠ æˆ–è€…æ›¿æ¢äº§å“æ—æ¯”è¾ƒæ–¹ä¾¿ï¼Œå¢åŠ æ–°çš„å…·ä½“å·¥å‚å’Œäº§å“æ—å¾ˆæ–¹ä¾¿ï¼›ä¸»è¦ç¼ºç‚¹åœ¨äºå¢åŠ æ–°çš„äº§å“ç­‰çº§ç»“æ„å¾ˆå¤æ‚ï¼Œéœ€è¦ä¿®æ”¹æŠ½è±¡å·¥å‚å’Œæ‰€æœ‰çš„å…·ä½“å·¥å‚ç±»ï¼Œå¯¹â€œå¼€é—­åŸåˆ™â€çš„æ”¯æŒå‘ˆç°å€¾æ–œæ€§ã€‚</li><li>æŠ½è±¡å·¥å‚æ¨¡å¼é€‚ç”¨æƒ…å†µåŒ…æ‹¬ï¼šä¸€ä¸ªç³»ç»Ÿä¸åº”å½“ä¾èµ–äºäº§å“ç±»å®ä¾‹å¦‚ä½•è¢«åˆ›å»ºã€ç»„åˆå’Œè¡¨è¾¾çš„ç»†èŠ‚ï¼›ç³»ç»Ÿä¸­æœ‰å¤šäºä¸€ä¸ªçš„äº§å“æ—ï¼Œè€Œæ¯æ¬¡åªä½¿ç”¨å…¶ä¸­æŸä¸€äº§å“æ—ï¼›å±äºåŒä¸€ä¸ªäº§å“æ—çš„äº§å“å°†åœ¨ä¸€èµ·ä½¿ç”¨ï¼›ç³»ç»Ÿæä¾›ä¸€ä¸ªäº§å“ç±»çš„åº“ï¼Œæ‰€æœ‰çš„äº§å“ä»¥åŒæ ·çš„æ¥å£å‡ºç°ï¼Œä»è€Œä½¿å®¢æˆ·ç«¯ä¸ä¾èµ–äºå…·ä½“å®ç°ã€‚</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;ä¸€-æ¨¡å¼åŠ¨æœº&quot;&gt;&lt;a href=&quot;#ä¸€-æ¨¡å¼åŠ¨æœº&quot; class=&quot;headerlink&quot; title=&quot;ä¸€.æ¨¡å¼åŠ¨æœº&quot;&gt;&lt;/a&gt;ä¸€.æ¨¡å¼åŠ¨æœº&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;åœ¨å·¥å‚æ–¹æ³•æ¨¡å¼ä¸­å…·ä½“å·¥å‚è´Ÿè´£ç”Ÿäº§å…·ä½“çš„äº§å“ï¼Œæ¯ä¸€ä¸ªå…·ä½“å·¥å‚å¯¹åº”ä¸€ç§å…·ä½“äº§å“ï¼Œå·¥å‚æ–¹æ³•ä¹Ÿå…·æœ‰</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ç™¾åº¦åœ°å›¾APIè¿›è¡Œåœ°ç†ä½ç½®é€‰æ‹©ï¼Ÿ</title>
    <link href="https://www.fomal.cc/posts/5d0387a1.html"/>
    <id>https://www.fomal.cc/posts/5d0387a1.html</id>
    <published>2025-05-20T08:38:30.594Z</published>
    <updated>2022-09-28T11:52:23.655Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ä¸€-é¡¹ç›®éœ€æ±‚ï¼ˆä¸¾ä¾‹ï¼‰"><a href="#ä¸€-é¡¹ç›®éœ€æ±‚ï¼ˆä¸¾ä¾‹ï¼‰" class="headerlink" title="ä¸€. é¡¹ç›®éœ€æ±‚ï¼ˆä¸¾ä¾‹ï¼‰"></a>ä¸€. é¡¹ç›®éœ€æ±‚ï¼ˆä¸¾ä¾‹ï¼‰</h3><p>å¯»ä¸»åŠŸèƒ½éœ€è¦æ¨é€ç¦»ç”¨æˆ·æœ€è¿‘çš„çº¿ä¸‹é—¨åº—ï¼Œç³»ç»Ÿéœ€è¦å°†ç”¨æˆ·çš„è¾“å…¥çš„åœ°å€è§£æä¸ºç»çº¬åº¦ã€‚å†é€šè¿‡ç»çº¬åº¦è®¡ç®—å“ªä¸€å®¶åº—é“ºç¦»ç”¨æˆ·åœ°å€æœ€è¿‘ã€‚</p><p>å®ç°åœ°å€è¾“å…¥æç¤ºï¼Œæ‰‹åŠ¨è¾“å…¥çš„åœ°å€ä¸å®Œæ•´ã€‚</p><h3 id="äºŒ-ç™¾åº¦åœ°å›¾å¼€å‘å¹³å°"><a href="#äºŒ-ç™¾åº¦åœ°å›¾å¼€å‘å¹³å°" class="headerlink" title="äºŒ.  ç™¾åº¦åœ°å›¾å¼€å‘å¹³å°"></a>äºŒ.  ç™¾åº¦åœ°å›¾å¼€å‘å¹³å°</h3><p>ç™¾åº¦åœ°å›¾æä¾›äº†å¾ˆå¤šå¼€å‘çš„apiï¼Œæ–¹ä¾¿å¼€å‘è€…æ¥å…¥åˆ°è‡ªå·±åº”ç”¨ä¸­ã€‚æˆ‘ä»¬æ ¹æ®ç”¨æˆ·æ³¨å†Œçš„åœ°å€ï¼Œåœ¨ç™¾åº¦åœ°å›¾è¿›è¡Œæ ‡æ³¨ï¼Œæ–¹ä¾¿ç³»ç»Ÿç®¡ç†å‘˜ç®¡ç†</p><p>ä¸»ç«™åœ°å€ï¼š<a href="http://lbsyun.baidu.com/">http://lbsyun.baidu.com/</a></p><ul><li><p>æ³¨å†ŒæˆåŠŸç”³è¯·æˆä¸ºå¼€å‘è€…åï¼Œåˆ›å»ºåº”ç”¨-ç”³è¯·AK</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">åº”ç”¨åç§°ï¼šé¡¹ç›®å</span><br><span class="line">åº”ç”¨ç±»å‹ï¼šæµè§ˆå™¨ç«¯</span><br><span class="line">å¯ç”¨æœåŠ¡ï¼šå…¨é€‰ï¼Œç‰¹åˆ«æ˜¯é€†åœ°å€</span><br><span class="line">ç™½åå•ï¼š* - è¡¨ç¤ºæ‰€æœ‰ç½‘å€éƒ½å¯ä»¥è®¿é—®</span><br></pre></td></tr></table></figure></li><li><p>æµ‹è¯•åœ°å›¾åŠŸèƒ½</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html; charset=utf-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;initial-scale=1.0, user-scalable=no&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">body</span>, <span class="selector-tag">html</span>&#123;<span class="attribute">width</span>: <span class="number">100%</span>;<span class="attribute">height</span>: <span class="number">100%</span>;<span class="attribute">margin</span>:<span class="number">0</span>;<span class="attribute">font-family</span>:<span class="string">&quot;å¾®è½¯é›…é»‘&quot;</span>;<span class="attribute">font-size</span>:<span class="number">14px</span>;&#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-id">#l-map</span>&#123;<span class="attribute">height</span>:<span class="number">300px</span>;<span class="attribute">width</span>:<span class="number">100%</span>;&#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-id">#r-result</span>&#123;<span class="attribute">width</span>:<span class="number">100%</span>;&#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;//api.map.baidu.com/api?v=2.0&amp;ak=LSNHTIDvIKtkv7UgAUKfStSz4QU74osS&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>å…³é”®å­—è¾“å…¥æç¤ºè¯æ¡<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;l-map&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;r-result&quot;</span>&gt;</span>è¯·è¾“å…¥:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;suggestId&quot;</span> <span class="attr">size</span>=<span class="string">&quot;20&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ç™¾åº¦&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width:150px;&quot;</span> /&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;searchResultPanel&quot;</span> <span class="attr">style</span>=<span class="string">&quot;border:1px solid #C0C0C0;width:150px;height:auto; display:none;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// ç™¾åº¦åœ°å›¾APIåŠŸèƒ½</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">G</span>(<span class="params">id</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(id);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;l-map&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// map.centerAndZoom(&quot;æˆéƒ½&quot;,12);     // åˆå§‹åŒ–åœ°å›¾,è®¾ç½®åŸå¸‚å’Œåœ°å›¾çº§åˆ«ã€‚</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> ac = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Autocomplete</span>(    <span class="comment">//å»ºç«‹ä¸€ä¸ªè‡ªåŠ¨å®Œæˆçš„å¯¹è±¡</span></span></span><br><span class="line"><span class="language-javascript">        &#123;<span class="string">&quot;input&quot;</span> : <span class="string">&quot;suggestId&quot;</span></span></span><br><span class="line"><span class="language-javascript">            ,<span class="string">&quot;location&quot;</span> : map</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    ac.<span class="title function_">addEventListener</span>(<span class="string">&quot;onhighlight&quot;</span>, <span class="keyword">function</span>(<span class="params">e</span>) &#123;  <span class="comment">//é¼ æ ‡æ”¾åœ¨ä¸‹æ‹‰åˆ—è¡¨ä¸Šçš„äº‹ä»¶</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> str = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> _value = e.<span class="property">fromitem</span>.<span class="property">value</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> value = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (e.<span class="property">fromitem</span>.<span class="property">index</span> &gt; -<span class="number">1</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            value = _value.<span class="property">province</span> +  _value.<span class="property">city</span> +  _value.<span class="property">district</span> +  _value.<span class="property">street</span> +  _value.<span class="property">business</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        str = <span class="string">&quot;FromItem&lt;br /&gt;index = &quot;</span> + e.<span class="property">fromitem</span>.<span class="property">index</span> + <span class="string">&quot;&lt;br /&gt;value = &quot;</span> + value;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        value = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (e.<span class="property">toitem</span>.<span class="property">index</span> &gt; -<span class="number">1</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            _value = e.<span class="property">toitem</span>.<span class="property">value</span>;</span></span><br><span class="line"><span class="language-javascript">            value = _value.<span class="property">province</span> +  _value.<span class="property">city</span> +  _value.<span class="property">district</span> +  _value.<span class="property">street</span> +  _value.<span class="property">business</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        str += <span class="string">&quot;&lt;br /&gt;ToItem&lt;br /&gt;index = &quot;</span> + e.<span class="property">toitem</span>.<span class="property">index</span> + <span class="string">&quot;&lt;br /&gt;value = &quot;</span> + value;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">G</span>(<span class="string">&quot;searchResultPanel&quot;</span>).<span class="property">innerHTML</span> = str;</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> myValue;</span></span><br><span class="line"><span class="language-javascript">    ac.<span class="title function_">addEventListener</span>(<span class="string">&quot;onconfirm&quot;</span>, <span class="keyword">function</span>(<span class="params">e</span>) &#123;    <span class="comment">//é¼ æ ‡ç‚¹å‡»ä¸‹æ‹‰åˆ—è¡¨åçš„äº‹ä»¶</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> _value = e.<span class="property">item</span>.<span class="property">value</span>;</span></span><br><span class="line"><span class="language-javascript">        myValue = _value.<span class="property">province</span> +  _value.<span class="property">city</span> +  _value.<span class="property">district</span> +  _value.<span class="property">street</span> +  _value.<span class="property">business</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">G</span>(<span class="string">&quot;searchResultPanel&quot;</span>).<span class="property">innerHTML</span> =<span class="string">&quot;onconfirm&lt;br /&gt;index = &quot;</span> + e.<span class="property">item</span>.<span class="property">index</span> + <span class="string">&quot;&lt;br /&gt;myValue = &quot;</span> + myValue;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">setPlace</span>();</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">setPlace</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        map.<span class="title function_">clearOverlays</span>();    <span class="comment">//æ¸…é™¤åœ°å›¾ä¸Šæ‰€æœ‰è¦†ç›–ç‰©</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">function</span> <span class="title function_">myFun</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">var</span> pp = local.<span class="title function_">getResults</span>().<span class="title function_">getPoi</span>(<span class="number">0</span>).<span class="property">point</span>;    <span class="comment">//è·å–ç¬¬ä¸€ä¸ªæ™ºèƒ½æœç´¢çš„ç»“æœ</span></span></span><br><span class="line"><span class="language-javascript">            map.<span class="title function_">centerAndZoom</span>(pp, <span class="number">18</span>);</span></span><br><span class="line"><span class="language-javascript">            map.<span class="title function_">addOverlay</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Marker</span>(pp));    <span class="comment">//æ·»åŠ æ ‡æ³¨</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> local = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">LocalSearch</span>(map, &#123; <span class="comment">//æ™ºèƒ½æœç´¢</span></span></span><br><span class="line"><span class="language-javascript">            <span class="attr">onSearchComplete</span>: myFun</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">        local.<span class="title function_">search</span>(myValue);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="ä¸‰-vueé›†æˆç™¾åº¦åœ°å›¾api"><a href="#ä¸‰-vueé›†æˆç™¾åº¦åœ°å›¾api" class="headerlink" title="ä¸‰. vueé›†æˆç™¾åº¦åœ°å›¾api"></a>ä¸‰. vueé›†æˆç™¾åº¦åœ°å›¾api</h3><h4 id="1-å®‰è£…ç™¾åº¦åœ°å›¾-åœ¨å½“å‰é¡¹ç›®è·¯å¾„ä¸‹å®‰è£…"><a href="#1-å®‰è£…ç™¾åº¦åœ°å›¾-åœ¨å½“å‰é¡¹ç›®è·¯å¾„ä¸‹å®‰è£…" class="headerlink" title="1. å®‰è£…ç™¾åº¦åœ°å›¾(åœ¨å½“å‰é¡¹ç›®è·¯å¾„ä¸‹å®‰è£…)"></a>1. å®‰è£…ç™¾åº¦åœ°å›¾(åœ¨å½“å‰é¡¹ç›®è·¯å¾„ä¸‹å®‰è£…)</h4><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">npm</span> install --save vue-baidu-map</span><br></pre></td></tr></table></figure><h4 id="2-å…¨å±€å¼•å…¥ç™¾åº¦åœ°å›¾"><a href="#2-å…¨å±€å¼•å…¥ç™¾åº¦åœ°å›¾" class="headerlink" title="2. å…¨å±€å¼•å…¥ç™¾åº¦åœ°å›¾"></a>2. å…¨å±€å¼•å…¥ç™¾åº¦åœ°å›¾</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">åœ¨main.<span class="property">js</span>ä¸­å¼•å…¥ï¼š</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">BaiduMap</span> <span class="keyword">from</span> <span class="string">&#x27;vue-baidu-map&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">BaiduMap</span>, &#123;</span><br><span class="line">    <span class="comment">/* Visit http://lbsyun.baidu.com/apiconsole/key for details about app key. */</span></span><br><span class="line">    <span class="attr">ak</span>: <span class="string">&#x27;4RWmQlKQkGgdOUuDqaVbkjBg2IY3sjh0&#x27;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="3-åœ°å›¾å±•ç¤ºæ¡†"><a href="#3-åœ°å›¾å±•ç¤ºæ¡†" class="headerlink" title="3. åœ°å›¾å±•ç¤ºæ¡†"></a>3. åœ°å›¾å±•ç¤ºæ¡†</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">      &lt;el-form-item prop=&quot;address&quot; label=&quot;åº—é“ºåœ°å€&quot;&gt;</span><br><span class="line">        &lt;el-input type=&quot;text&quot; v-model=&quot;shop.address&quot; auto-complete=&quot;off&quot; placeholder=&quot;è¯·è¾“å…¥åœ°å€ï¼&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;el-button size=&quot;small&quot; type=&quot;primary&quot; @click=&quot;selectAddress&quot;&gt;é€‰æ‹©&lt;/el-button&gt;</span><br><span class="line">      &lt;/el-form-item&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--ç™¾åº¦åœ°å›¾--&gt;</span><br><span class="line">&lt;el-dialog</span><br><span class="line">    title=&quot;é€‰æ‹©åœ°å€&quot;</span><br><span class="line">    :visible.sync=&quot;dialogVisable&quot;</span><br><span class="line">    width=&quot;30%&quot;&gt;</span><br><span class="line">  &lt;baidu-map :center=&quot;&#123;lng: 104.06, lat: 30.67&#125;&quot; :zoom=&quot;11&quot;&gt;</span><br><span class="line">    &lt;bm-view class=&quot;map&quot;&gt;&lt;/bm-view&gt;</span><br><span class="line">    &lt;bm-control :offset=&quot;&#123;width: &#x27;10px&#x27;, height: &#x27;10px&#x27;&#125;&quot;&gt;</span><br><span class="line">      &lt;bm-auto-complete v-model=&quot;keyword&quot; :sugStyle=&quot;&#123;zIndex: 2100&#125;&quot;&gt;</span><br><span class="line">        &lt;div style=&quot;margin-bottom:10px&quot;&gt;</span><br><span class="line">          &lt;input id=&quot;searchInput&quot; type=&quot;text&quot; placeholder=&quot;è¯·è¾“å…¥å…³é”®å­—&quot; class=&quot;searchinput&quot;/&gt;</span><br><span class="line">          &lt;el-button type=&quot;success&quot; @click=&quot;selectAddressConfirm&quot;&gt;ç¡®å®š&lt;/el-button&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/bm-auto-complete&gt;</span><br><span class="line">    &lt;/bm-control&gt;</span><br><span class="line">    &lt;bm-local-search :keyword=&quot;keyword&quot; :auto-viewport=&quot;true&quot; &gt;&lt;/bm-local-search&gt;</span><br><span class="line">  &lt;/baidu-map&gt;</span><br><span class="line">  &lt;span slot=&quot;footer&quot; class=&quot;dialog-footer&quot;&gt;</span><br><span class="line">    &lt;el-button @click=&quot;dialogVisable=false&quot;&gt;å– æ¶ˆ&lt;/el-button&gt;</span><br><span class="line">    &lt;el-button type=&quot;primary&quot; @click=&quot;selectAddressConfirm&quot;&gt;ç¡® å®š&lt;/el-button&gt;</span><br><span class="line">  &lt;/span&gt;</span><br><span class="line">&lt;/el-dialog&gt;</span><br></pre></td></tr></table></figure><h4 id="4-ä¸šåŠ¡ä»£ç "><a href="#4-ä¸šåŠ¡ä»£ç " class="headerlink" title="4. ä¸šåŠ¡ä»£ç "></a>4. ä¸šåŠ¡ä»£ç </h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç™¾åº¦åœ°å€çš„ä¸šåŠ¡é€»è¾‘</span></span><br><span class="line"><span class="title function_">selectAddressConfirm</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">//è·å–å€¼æœç´¢æ¡†å€¼,è®¾ç½®ç»™åœ°å€</span></span><br><span class="line">  <span class="keyword">var</span> searchInputV = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;searchInput&quot;</span>).<span class="property">value</span>;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">shop</span>.<span class="property">address</span> = searchInputV;</span><br><span class="line">  <span class="comment">//å…³é—­å¯¹è¯æ¡†</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">dialogVisable</span> = <span class="literal">false</span>;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="title function_">selectAddress</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">dialogVisable</span> = <span class="literal">true</span>;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h3 id="å››-HTMLé¡µé¢è¾“å…¥åœ°å€è‡ªåŠ¨æç¤º"><a href="#å››-HTMLé¡µé¢è¾“å…¥åœ°å€è‡ªåŠ¨æç¤º" class="headerlink" title="å››. HTMLé¡µé¢è¾“å…¥åœ°å€è‡ªåŠ¨æç¤º"></a>å››. HTMLé¡µé¢è¾“å…¥åœ°å€è‡ªåŠ¨æç¤º</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- å¼•å…¥ç™¾åº¦åœ°å›¾ --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;//api.map.baidu.com/api?v=2.0&amp;ak=LSNHTIDvIKtkv7UgAUKfStSz4QU74osS&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">&lt;!-- å¼•å…¥vueå’Œaxios --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/plugins/vue/dist/vue.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/plugins/axios/dist/axios.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">&lt;!-- axioså…¨å±€é…ç½® --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/common.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>å¼•å…¥jsæ–‡ä»¶</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// ç™¾åº¦åœ°å›¾APIåŠŸèƒ½</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">G</span>(<span class="params">id</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(id);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Map</span>(<span class="string">&quot;&quot;</span>); <span class="comment">//æ²¡æœ‰1-mapå°±åˆ é™¤æ‰ï¼Œä½†æ˜¯å¿…é¡»ä¼ é€’ä¸€ä¸ªå€¼ï¼Œç©ºå­—ç¬¦ä¸²éƒ½è¡Œ</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//map.centerAndZoom(&quot;åŒ—äº¬&quot;,12);                   // åˆå§‹åŒ–åœ°å›¾,è®¾ç½®åŸå¸‚å’Œåœ°å›¾çº§åˆ«ã€‚</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> ac = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Autocomplete</span>(    <span class="comment">//å»ºç«‹ä¸€ä¸ªè‡ªåŠ¨å®Œæˆçš„å¯¹è±¡</span></span></span><br><span class="line"><span class="language-javascript">        &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="string">&quot;input&quot;</span>: <span class="string">&quot;suggestId&quot;</span></span></span><br><span class="line"><span class="language-javascript">            , <span class="string">&quot;location&quot;</span>: map</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    ac.<span class="title function_">addEventListener</span>(<span class="string">&quot;onhighlight&quot;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;  <span class="comment">//é¼ æ ‡æ”¾åœ¨ä¸‹æ‹‰åˆ—è¡¨ä¸Šçš„äº‹ä»¶</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> str = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> _value = e.<span class="property">fromitem</span>.<span class="property">value</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> value = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (e.<span class="property">fromitem</span>.<span class="property">index</span> &gt; -<span class="number">1</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            value = _value.<span class="property">province</span> + _value.<span class="property">city</span> + _value.<span class="property">district</span> + _value.<span class="property">street</span> + _value.<span class="property">business</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        str = <span class="string">&quot;FromItem&lt;br /&gt;index = &quot;</span> + e.<span class="property">fromitem</span>.<span class="property">index</span> + <span class="string">&quot;&lt;br /&gt;value = &quot;</span> + value;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        value = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (e.<span class="property">toitem</span>.<span class="property">index</span> &gt; -<span class="number">1</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            _value = e.<span class="property">toitem</span>.<span class="property">value</span>;</span></span><br><span class="line"><span class="language-javascript">            value = _value.<span class="property">province</span> + _value.<span class="property">city</span> + _value.<span class="property">district</span> + _value.<span class="property">street</span> + _value.<span class="property">business</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        str += <span class="string">&quot;&lt;br /&gt;ToItem&lt;br /&gt;index = &quot;</span> + e.<span class="property">toitem</span>.<span class="property">index</span> + <span class="string">&quot;&lt;br /&gt;value = &quot;</span> + value;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//G(&quot;searchResultPanel&quot;).innerHTML = str;</span></span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> myValue;</span></span><br><span class="line"><span class="language-javascript">    ac.<span class="title function_">addEventListener</span>(<span class="string">&quot;onconfirm&quot;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;    <span class="comment">//é¼ æ ‡ç‚¹å‡»ä¸‹æ‹‰åˆ—è¡¨åçš„äº‹ä»¶</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> _value = e.<span class="property">item</span>.<span class="property">value</span>;</span></span><br><span class="line"><span class="language-javascript">        myValue = _value.<span class="property">province</span> + _value.<span class="property">city</span> + _value.<span class="property">district</span> + _value.<span class="property">street</span> + _value.<span class="property">business</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//G(&quot;searchResultPanel&quot;).innerHTML =&quot;onconfirm&lt;br /&gt;index = &quot; + e.item.index + &quot;&lt;br /&gt;myValue = &quot; + myValue;</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//å°†ç™¾åº¦åœ°å›¾çš„åœ°å€èµ‹å€¼ç»™ æ•°æ®æ¨¡å‹</span></span></span><br><span class="line"><span class="language-javascript">        vue.<span class="property">searchMasterMsg</span>.<span class="property">address</span> = myValue;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">setPlace</span>();</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">setPlace</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        map.<span class="title function_">clearOverlays</span>();    <span class="comment">//æ¸…é™¤åœ°å›¾ä¸Šæ‰€æœ‰è¦†ç›–ç‰©</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">function</span> <span class="title function_">myFun</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">var</span> pp = local.<span class="title function_">getResults</span>().<span class="title function_">getPoi</span>(<span class="number">0</span>).<span class="property">point</span>;    <span class="comment">//è·å–ç¬¬ä¸€ä¸ªæ™ºèƒ½æœç´¢çš„ç»“æœ</span></span></span><br><span class="line"><span class="language-javascript">            map.<span class="title function_">centerAndZoom</span>(pp, <span class="number">18</span>);</span></span><br><span class="line"><span class="language-javascript">            map.<span class="title function_">addOverlay</span>(<span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">Marker</span>(pp));    <span class="comment">//æ·»åŠ æ ‡æ³¨</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> local = <span class="keyword">new</span> <span class="title class_">BMap</span>.<span class="title class_">LocalSearch</span>(map, &#123; <span class="comment">//æ™ºèƒ½æœç´¢</span></span></span><br><span class="line"><span class="language-javascript">            <span class="attr">onSearchComplete</span>: myFun</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">        local.<span class="title function_">search</span>(myValue);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¾“å…¥æ¡†å®šä¹‰<code>suggestId</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;am-form-group&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;suggestId&quot;</span> <span class="attr">class</span>=<span class="string">&quot;am-form-label&quot;</span>&gt;</span>åœ°å€<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;am-form-content&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;suggestId&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;searchMasterMsg.address&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;è¯·è¾“å…¥åœ°å€&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;info-btn&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;am-btn am-btn-danger&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;publish&quot;</span>&gt;</span>å‘å¸ƒ<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">publish</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">//string - booleanä¸è¡Œ  é‚£å°±string - int - booleanå°±å¯ä»¥äº† 1==trueï¼Œ0==false</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">searchMasterMsg</span>.<span class="property">gender</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">searchMasterMsg</span>.<span class="property">gender</span> = <span class="built_in">parseInt</span>(<span class="variable language_">this</span>.<span class="property">searchMasterMsg</span>.<span class="property">gender</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">$http</span>.<span class="title function_">post</span>(<span class="string">&quot;/searchMasterMsg/publish&quot;</span>, <span class="variable language_">this</span>.<span class="property">searchMasterMsg</span>).<span class="title function_">then</span>(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">//å‘å¸ƒæˆåŠŸåå°±è·³è½¬åˆ°ä¸»é¡µ</span></span><br><span class="line">        result = result.<span class="property">data</span>;</span><br><span class="line">        <span class="keyword">if</span> (result.<span class="property">success</span>) &#123;</span><br><span class="line">            <span class="title function_">alert</span>(<span class="string">&quot;å‘å¸ƒæˆåŠŸï¼&quot;</span>);</span><br><span class="line">            location.<span class="property">href</span> = <span class="string">&quot;/index.html&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="title function_">alert</span>(result.<span class="property">msg</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&quot;ç³»ç»Ÿé”™è¯¯&quot;</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>addEventListeneræ–¹æ³•ä¸­æ·»åŠ ä¸€å¥ä»£ç ï¼Œè¿™æ ·åœ°å€æ‰èƒ½ä¼ é€’åˆ°åç«¯</p><p><code>vue.searchMasterMsg.address = myValue;</code></p></li><li><p>è¦æ³¨é‡Šç‚¹G(â€œsearchResultPanelâ€),è¿™ä¸ªæ˜¯ç”¨æ¥æ˜¾ç¤ºåœ°å›¾çš„ï¼Œæ²¡æœ‰è¿™ä¸ªidå±æ€§</p></li></ul><p><strong>vueæŒ‚åœ¨å®ä¾‹</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> vue = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">    <span class="attr">el</span>: <span class="string">&quot;#myDiv&quot;</span>,</span><br><span class="line">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">loginInfo</span>: <span class="literal">null</span>,</span><br><span class="line">            <span class="attr">searchMasterMsg</span>: &#123;</span><br><span class="line">                <span class="attr">name</span>: <span class="string">&#x27;å°ä¸ƒ&#x27;</span>,</span><br><span class="line">                <span class="attr">price</span>: <span class="number">10</span>,</span><br><span class="line">                <span class="attr">age</span>: <span class="number">3</span>,</span><br><span class="line">                <span class="attr">gender</span>: <span class="number">1</span>,</span><br><span class="line">                <span class="attr">coatColor</span>: <span class="string">&#x27;é»‘è‰²&#x27;</span>,</span><br><span class="line">                <span class="attr">resources</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">petType</span>: <span class="number">1</span>,</span><br><span class="line">                <span class="attr">address</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">title</span>: <span class="string">&#x27;äºŒå“ˆå¯»ä¸»&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">methods</span>: &#123;</span><br><span class="line">        <span class="title function_">publish</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="comment">//string - booleanä¸è¡Œ  é‚£å°±string - int - booleanå°±å¯ä»¥äº† 1==trueï¼Œ0==false</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">searchMasterMsg</span>.<span class="property">gender</span>) &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">searchMasterMsg</span>.<span class="property">gender</span> = <span class="built_in">parseInt</span>(<span class="variable language_">this</span>.<span class="property">searchMasterMsg</span>.<span class="property">gender</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">$http</span>.<span class="title function_">post</span>(<span class="string">&quot;/searchMasterMsg/publish&quot;</span>, <span class="variable language_">this</span>.<span class="property">searchMasterMsg</span>).<span class="title function_">then</span>(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="comment">//å‘å¸ƒæˆåŠŸåå°±è·³è½¬åˆ°ä¸»é¡µ</span></span><br><span class="line">                result = result.<span class="property">data</span>;</span><br><span class="line">                <span class="keyword">if</span> (result.<span class="property">success</span>) &#123;</span><br><span class="line">                    <span class="title function_">alert</span>(<span class="string">&quot;å‘å¸ƒæˆåŠŸï¼&quot;</span>);</span><br><span class="line">                    location.<span class="property">href</span> = <span class="string">&quot;/index.html&quot;</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="title function_">alert</span>(result.<span class="property">msg</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="title function_">alert</span>(<span class="string">&quot;ç³»ç»Ÿé”™è¯¯&quot;</span>);</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> loginInfo = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;loginInfo&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (loginInfo) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">loginInfo</span> = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(loginInfo);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="äº”-å·¥å…·ç±»"><a href="#äº”-å·¥å…·ç±»" class="headerlink" title="äº”.  å·¥å…·ç±»"></a>äº”.  å·¥å…·ç±»</h3><h4 id="1-è§£æåœ°å€ç»çº¬åº¦"><a href="#1-è§£æåœ°å€ç»çº¬åº¦" class="headerlink" title="1. è§£æåœ°å€ç»çº¬åº¦"></a>1. è§£æåœ°å€ç»çº¬åº¦</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> io.coderyeah.basic.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å­˜æ”¾ç»çº¬åº¦</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Point</span> &#123;</span><br><span class="line">    <span class="comment">//ç»åº¦</span></span><br><span class="line">    <span class="keyword">private</span> Double lng;</span><br><span class="line">    <span class="comment">//ç»´åº¦</span></span><br><span class="line">    <span class="keyword">private</span> Double lat;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-ä½ç½®å·¥å…·ç±»"><a href="#2-ä½ç½®å·¥å…·ç±»" class="headerlink" title="2. ä½ç½®å·¥å…·ç±»"></a>2. ä½ç½®å·¥å…·ç±»</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> io.coderyeah.basic.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.coderyeah.org.domain.Shop;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.net.HttpURLConnection;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä½ç½®ç›¸å…³å·¥å…·ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DistanceUtils</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç»™ä¸€ä¸ªåœ°å€ - ç®—å‡ºè¿™ä¸ªåœ°å€çš„ç»çº¬åº¦</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Point <span class="title function_">getPoint</span><span class="params">(String address)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">Application_ID</span> <span class="operator">=</span> <span class="string">&quot;PQ9FAt6qg7taDWj6LLABYO7u6bSETXhD&quot;</span>;<span class="comment">//é…ç½®ä¸Šè‡ªå·±çš„ç™¾åº¦åœ°å›¾åº”ç”¨çš„AK</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            String sCurrentLine;</span><br><span class="line">            String sTotalString;</span><br><span class="line">            sCurrentLine = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            sTotalString = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            InputStream l_urlStream;</span><br><span class="line">            <span class="type">URL</span> <span class="variable">l_url</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(<span class="string">&quot;http://api.map.baidu.com/geocoding/v3/?address=&quot;</span> + address + <span class="string">&quot;&amp;output=json&amp;ak=&quot;</span> + Application_ID + <span class="string">&quot;&amp;callback=showLocation&quot;</span>);</span><br><span class="line">            <span class="type">HttpURLConnection</span> <span class="variable">l_connection</span> <span class="operator">=</span> (HttpURLConnection) l_url.openConnection();</span><br><span class="line">            l_connection.connect();</span><br><span class="line">            l_urlStream = l_connection.getInputStream();</span><br><span class="line">            java.io.<span class="type">BufferedReader</span> <span class="variable">l_reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">java</span>.io.BufferedReader(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(l_urlStream));</span><br><span class="line">            <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> l_reader.readLine();</span><br><span class="line">            System.out.println(str);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//ç”¨ç»åº¦åˆ†å‰²è¿”å›çš„ç½‘é¡µä»£ç </span></span><br><span class="line">            <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> <span class="string">&quot;,&quot;</span> + <span class="string">&quot;\&quot;&quot;</span> + <span class="string">&quot;lat&quot;</span> + <span class="string">&quot;\&quot;&quot;</span> + <span class="string">&quot;:&quot;</span>;</span><br><span class="line">            String strs[] = str.split(s, <span class="number">2</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">s1</span> <span class="operator">=</span> <span class="string">&quot;\&quot;&quot;</span> + <span class="string">&quot;lng&quot;</span> + <span class="string">&quot;\&quot;&quot;</span> + <span class="string">&quot;:&quot;</span>;</span><br><span class="line">            String a[] = strs[<span class="number">0</span>].split(s1, <span class="number">2</span>);</span><br><span class="line">            s1 = <span class="string">&quot;&#125;&quot;</span> + <span class="string">&quot;,&quot;</span> + <span class="string">&quot;\&quot;&quot;</span>;</span><br><span class="line">            String a1[] = strs[<span class="number">1</span>].split(s1, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="type">Point</span> <span class="variable">point</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Point</span>();</span><br><span class="line">            point.setLng(Double.valueOf(a[<span class="number">1</span>]));</span><br><span class="line">            point.setLat(Double.valueOf(a1[<span class="number">0</span>]));</span><br><span class="line">            <span class="keyword">return</span> point;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åœ°çƒåŠå¾„,è¿›è¡Œç»çº¬åº¦è¿ç®—éœ€è¦ç”¨åˆ°çš„æ•°æ®ä¹‹ä¸€</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">double</span> <span class="variable">EARTH_RADIUS</span> <span class="operator">=</span> <span class="number">6378137</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ ¹æ®åæ ‡ç‚¹è·å–å¼§åº¦</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">double</span> <span class="title function_">rad</span><span class="params">(<span class="type">double</span> d)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> d * Math.PI / <span class="number">180.0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®ä¸¤ç‚¹é—´ç»çº¬åº¦åæ ‡ï¼ˆdoubleå€¼ï¼‰ï¼Œè®¡ç®—ä¸¤ç‚¹é—´è·ç¦»ï¼Œå•ä½ä¸ºç±³</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> point1 Aç‚¹åæ ‡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> point2 Bç‚¹åæ ‡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">double</span> <span class="title function_">getDistance</span><span class="params">(Point point1, Point point2)</span> &#123;</span><br><span class="line">        <span class="type">double</span> <span class="variable">radLat1</span> <span class="operator">=</span> rad(point1.getLat());</span><br><span class="line">        <span class="type">double</span> <span class="variable">radLat2</span> <span class="operator">=</span> rad(point2.getLat());</span><br><span class="line">        <span class="type">double</span> <span class="variable">a</span> <span class="operator">=</span> radLat1 - radLat2;</span><br><span class="line">        <span class="type">double</span> <span class="variable">b</span> <span class="operator">=</span> rad(point1.getLng()) - rad(point2.getLng());</span><br><span class="line">        <span class="type">double</span> <span class="variable">s</span> <span class="operator">=</span> <span class="number">2</span> * Math.asin(Math.sqrt(Math.pow(Math.sin(a / <span class="number">2</span>), <span class="number">2</span>) +</span><br><span class="line">                Math.cos(radLat1) * Math.cos(radLat2) * Math.pow(Math.sin(b / <span class="number">2</span>), <span class="number">2</span>)));</span><br><span class="line">        s = s * EARTH_RADIUS;</span><br><span class="line">        s = Math.round(s * <span class="number">10000</span>) / <span class="number">10000</span>;</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®ä¸¤ç‚¹é—´ç»çº¬åº¦åæ ‡ï¼ˆdoubleå€¼ï¼‰ï¼Œè®¡ç®—ä¸¤ç‚¹é—´è·ç¦»ï¼Œå•ä½ä¸ºç±³</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> point ç”¨æˆ·æŒ‡å®šçš„åœ°å€åæ ‡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> shops å•†åº—</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Shop <span class="title function_">getNearestShop</span><span class="params">(Point point, List&lt;Shop&gt; shops)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¦‚æœä¼ è¿‡æ¥çš„é›†åˆåªæœ‰ä¸€å®¶åº—é“º,é‚£ä¹ˆç›´æ¥å°†è¿™å®¶åº—é“ºçš„ä¿¡æ¯è¿”å›å°±æ˜¯æœ€è¿‘çš„åº—é“ºäº†</span></span><br><span class="line">        <span class="type">Shop</span> <span class="variable">shop</span> <span class="operator">=</span> shops.get(<span class="number">0</span>);</span><br><span class="line">        <span class="comment">//è·å–é›†åˆä¸­ç¬¬ä¸€å®¶åº—é“ºåˆ°æŒ‡å®šåœ°ç‚¹çš„è·ç¦»</span></span><br><span class="line">        <span class="type">double</span> <span class="variable">distance</span> <span class="operator">=</span> getDistance(point, getPoint(shops.get(<span class="number">0</span>).getAddress()));</span><br><span class="line">        <span class="type">double</span> <span class="variable">minDistance</span> <span class="operator">=</span> distance;</span><br><span class="line">        <span class="comment">//å¦‚æœæœ‰å¤šå®¶åº—é“º,é‚£ä¹ˆå°±å’Œç¬¬ä¸€å®¶åº—é“ºåˆ°æŒ‡å®šåœ°ç‚¹çš„è·ç¦»åšæ¯”è¾ƒ</span></span><br><span class="line">        <span class="keyword">if</span> (shops.size() &gt; <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; shops.size(); i++) &#123;</span><br><span class="line">                <span class="type">double</span> <span class="variable">distanceTmp</span> <span class="operator">=</span> getDistance(point, getPoint(shops.get(i).getAddress()));</span><br><span class="line">                <span class="keyword">if</span> (distanceTmp &lt; minDistance) &#123;</span><br><span class="line">                    shop = shops.get(i);</span><br><span class="line">                    minDistance = distanceTmp;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (minDistance &gt; <span class="number">50000</span>) &#123; <span class="comment">//å¤§äº50å…¬é‡Œï¼Œæ²¡æœ‰åˆé€‚çš„åº—é“º</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> shop;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        System.out.println(getPoint(<span class="string">&quot;æˆéƒ½å¸‚å¤©åºœå¹¿åœº&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-ä¸šåŠ¡ä»£ç ï¼ˆç¤ºä¾‹ï¼‰"><a href="#3-ä¸šåŠ¡ä»£ç ï¼ˆç¤ºä¾‹ï¼‰" class="headerlink" title="3. ä¸šåŠ¡ä»£ç ï¼ˆç¤ºä¾‹ï¼‰"></a>3. ä¸šåŠ¡ä»£ç ï¼ˆç¤ºä¾‹ï¼‰</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> io.coderyeah.search.service.impl;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> coderyeah</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> é’ˆå¯¹è¡¨ã€t_search_master_msgã€‘çš„æ•°æ®åº“æ“ä½œServiceå®ç°</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@createDate</span> 2022-09-28 10:43:32</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SearchMasterMsgServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;SearchMasterMsgMapper, SearchMasterMsg&gt; <span class="keyword">implements</span> <span class="title class_">SearchMasterMsgService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> EmployeeMapper employeeMapper;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> SearchMasterMsgMapper searchMasterMsgMapper;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> BaiduAiAuditService baiduAiAuditService;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> SearchMasterMsgAuditLogMapper logMapper;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> ShopMapper shopMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Transactional</span><span class="comment">// å¼€å¯äº‹åŠ¡</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">publish</span><span class="params">(SearchMasterMsg searchMasterMsg, HttpServletRequest req)</span> &#123;</span><br><span class="line">        <span class="comment">// å‚æ•°æ ¡éªŒ</span></span><br><span class="line">        <span class="keyword">if</span> (StrUtil.isBlank(searchMasterMsg.getAddress()) || StrUtil.isBlank(searchMasterMsg.getName())) &#123;</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;å‚æ•°é”™è¯¯&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è·å–å½“å‰å¯»ä¸»æ¶ˆæ¯å‘å¸ƒäºº</span></span><br><span class="line">        <span class="type">LoginInfo</span> <span class="variable">loginInfo</span> <span class="operator">=</span> LoginContext.getLoginInfo(req);</span><br><span class="line">        <span class="comment">// æ‰¾åˆ°å½“å‰loginInfoçš„userå¯¹è±¡</span></span><br><span class="line">        <span class="keyword">assert</span> loginInfo != <span class="literal">null</span>;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userMapper.selectOne(<span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;User&gt;()</span><br><span class="line">                .eq(User::getLogininfoId, loginInfo.getId()));</span><br><span class="line">        <span class="comment">// ä¿å­˜å¯»ä¸»æ¶ˆæ¯</span></span><br><span class="line">        searchMasterMsg.setUserId(user.getId());</span><br><span class="line">        searchMasterMsgMapper.insert(searchMasterMsg);</span><br><span class="line">        <span class="comment">// ç™¾åº¦aiæ™ºèƒ½å®¡æ ¸</span></span><br><span class="line">        <span class="comment">// å®¡æ ¸æ–‡æœ¬å†…å®¹</span></span><br><span class="line">        <span class="keyword">final</span> <span class="type">Boolean</span> <span class="variable">bool1</span> <span class="operator">=</span> baiduAiAuditService.textAudit(searchMasterMsg.getName() + searchMasterMsg.getTitle() + searchMasterMsg.getCoatColor());</span><br><span class="line">        <span class="comment">// å®¡æ ¸å›¾ç‰‡</span></span><br><span class="line">        <span class="keyword">final</span> <span class="type">Boolean</span> <span class="variable">bool2</span> <span class="operator">=</span> baiduAiAuditService.imageAudit(searchMasterMsg.getResources());</span><br><span class="line">        <span class="comment">// æäº¤å®¡æ ¸æ—¥å¿—</span></span><br><span class="line">        <span class="keyword">final</span> <span class="type">SearchMasterMsgAuditLog</span> <span class="variable">log</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SearchMasterMsgAuditLog</span>();</span><br><span class="line">        log.setMsgId(searchMasterMsg.getId());</span><br><span class="line">        <span class="keyword">if</span> (bool1 &amp;&amp; bool2) &#123;</span><br><span class="line">            <span class="comment">// å‘å¸ƒæ¶ˆæ¯å®¡æ ¸æˆåŠŸ 0-1</span></span><br><span class="line">            searchMasterMsg.setState(<span class="number">1</span>);</span><br><span class="line">            <span class="comment">// æŸ¥è¯¢æ‰€æœ‰åº—é“º</span></span><br><span class="line">            <span class="keyword">final</span> List&lt;Shop&gt; shops = shopMapper.selectList(<span class="keyword">new</span> <span class="title class_">LambdaUpdateWrapper</span>&lt;&gt;());</span><br><span class="line">            <span class="comment">// è·å–å‘å¸ƒäººä½ç½®çš„ç»çº¬åº¦</span></span><br><span class="line">            <span class="keyword">final</span> <span class="type">Point</span> <span class="variable">point</span> <span class="operator">=</span> DistanceUtils.getPoint(searchMasterMsg.getAddress());</span><br><span class="line">            <span class="comment">// è·å–è·ç¦»æœ€è¿‘çš„åº—é“º</span></span><br><span class="line">            <span class="keyword">final</span> <span class="type">Shop</span> <span class="variable">nearestShop</span> <span class="operator">=</span> DistanceUtils.getNearestShop(point, shops);</span><br><span class="line">            <span class="keyword">if</span> (nearestShop != <span class="literal">null</span>) &#123;</span><br><span class="line">                searchMasterMsg.setState(<span class="number">2</span>);</span><br><span class="line">                searchMasterMsg.setShopId(nearestShop.getId());</span><br><span class="line">                <span class="comment">// æ›´æ–°å‘å¸ƒä¿¡æ¯</span></span><br><span class="line">                searchMasterMsgMapper.updateById(searchMasterMsg);</span><br><span class="line">                <span class="comment">// å‘é€çŸ­ä¿¡é€šçŸ¥åº—é“ºç®¡ç†å‘˜</span></span><br><span class="line">                <span class="comment">// é€šè¿‡shopIdæŸ¥æ‰¾åº—é“ºç®¡ç†å‘˜</span></span><br><span class="line">                <span class="keyword">final</span> <span class="type">Employee</span> <span class="variable">employee</span> <span class="operator">=</span> employeeMapper.selectOne(<span class="keyword">new</span> <span class="title class_">LambdaUpdateWrapper</span>&lt;Employee&gt;().eq(Employee::getShopId, nearestShop.getId()));</span><br><span class="line"><span class="comment">//                SmsUtils.sendSms(employee.getPhone(), &quot;æ‚¨æœ‰æ–°çš„è®¢å•å•¦ï¼è¯·å‰å¾€&quot; + searchMasterMsg.getAddress() + &quot;å®Œæˆæ”¶è´­ï¼&quot;);</span></span><br><span class="line">                System.out.println(<span class="string">&quot;æ‚¨æœ‰æ–°çš„è®¢å•å•¦ï¼è¯·å‰å¾€&quot;</span> + searchMasterMsg.getAddress() + <span class="string">&quot;å®Œæˆæ”¶è´­ï¼&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// æ”¾å…¥å¯»ä¸»æ± </span></span><br><span class="line">                searchMasterMsg.setState(<span class="number">3</span>);</span><br><span class="line">                <span class="comment">// æ›´æ–°å‘å¸ƒä¿¡æ¯</span></span><br><span class="line">                searchMasterMsgMapper.updateById(searchMasterMsg);</span><br><span class="line">            &#125;</span><br><span class="line">            log.setState(<span class="number">1</span>); <span class="comment">// å®¡æ ¸æˆåŠŸ</span></span><br><span class="line">            log.setNote(<span class="string">&quot;AIå®¡æ ¸é€šè¿‡&quot;</span>);</span><br><span class="line">            <span class="comment">// ä¿å­˜å®¡æ ¸æ—¥å¿—</span></span><br><span class="line">            logMapper.insert(log);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// å®¡æ ¸å¤±è´¥</span></span><br><span class="line">            log.setState(<span class="number">0</span>); <span class="comment">// å®¡æ ¸æˆåŠŸ</span></span><br><span class="line">            log.setNote(<span class="string">&quot;AIå®¡æ ¸æœªé€šè¿‡&quot;</span>);</span><br><span class="line">            logMapper.insert(log);</span><br><span class="line">              <span class="comment">// åˆ é™¤å¯»ä¸»æ¶ˆæ¯ é¿å…å¤šæ¬¡æ·»åŠ </span></span><br><span class="line">            searchMasterMsgMapper.deleteById(searchMasterMsg.getId());</span><br><span class="line"><span class="comment">//            SmsUtils.sendSms(user.getPhone(),&quot;å®¡æ ¸æœªé€šè¿‡,è¯·é‡æ–°ç¼–è¾‘å†…å®¹åä¸Šä¼ ï¼ï¼ï¼&quot;);</span></span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;å‘å¸ƒå¤±è´¥,è¯·ä¿®æ”¹ä¿¡æ¯åå†æ¬¡æäº¤&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> Result.success(<span class="string">&quot;å‘å¸ƒæˆåŠŸ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;ä¸€-é¡¹ç›®éœ€æ±‚ï¼ˆä¸¾ä¾‹ï¼‰&quot;&gt;&lt;a href=&quot;#ä¸€-é¡¹ç›®éœ€æ±‚ï¼ˆä¸¾ä¾‹ï¼‰&quot; class=&quot;headerlink&quot; title=&quot;ä¸€. é¡¹ç›®éœ€æ±‚ï¼ˆä¸¾ä¾‹ï¼‰&quot;&gt;&lt;/a&gt;ä¸€. é¡¹ç›®éœ€æ±‚ï¼ˆä¸¾ä¾‹ï¼‰&lt;/h3&gt;&lt;p&gt;å¯»ä¸»åŠŸèƒ½éœ€è¦æ¨é€ç¦»ç”¨æˆ·æœ€è¿‘çš„çº¿ä¸‹é—¨åº—ï¼Œç³»ç»Ÿéœ€è¦å°†ç”¨æˆ·çš„è¾“å…¥çš„åœ°å€è§£æä¸ºç»</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•ä½¿ç”¨çŸ­ä¿¡éªŒè¯ç å®Œæˆæ³¨å†ŒåŠŸèƒ½</title>
    <link href="https://www.fomal.cc/posts/d57e0a92.html"/>
    <id>https://www.fomal.cc/posts/d57e0a92.html</id>
    <published>2025-05-20T08:38:30.590Z</published>
    <updated>2022-09-15T15:57:07.975Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ä¸€-MD5åŠ å¯†å·¥å…·ç±»"><a href="#ä¸€-MD5åŠ å¯†å·¥å…·ç±»" class="headerlink" title="ä¸€. MD5åŠ å¯†å·¥å…·ç±»"></a>ä¸€. MD5åŠ å¯†å·¥å…·ç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.security.MessageDigest;</span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¯†ç åŠ å¯†å·¥å…·</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Md5Utils</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŠ å¯†</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> context</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">encrypByMd5</span><span class="params">(String context)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">MessageDigest</span> <span class="variable">md</span> <span class="operator">=</span> MessageDigest.getInstance(<span class="string">&quot;MD5&quot;</span>);</span><br><span class="line">            md.update(context.getBytes());<span class="comment">//updateå¤„ç†  </span></span><br><span class="line">            <span class="type">byte</span> [] encryContext = md.digest();<span class="comment">//è°ƒç”¨è¯¥æ–¹æ³•å®Œæˆè®¡ç®—  </span></span><br><span class="line"></span><br><span class="line">            <span class="type">int</span> i;</span><br><span class="line">            <span class="type">StringBuffer</span> <span class="variable">buf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">offset</span> <span class="operator">=</span> <span class="number">0</span>; offset &lt; encryContext.length; offset++) &#123;<span class="comment">//åšç›¸åº”çš„è½¬åŒ–ï¼ˆåå…­è¿›åˆ¶ï¼‰  </span></span><br><span class="line">                i = encryContext[offset];</span><br><span class="line">                <span class="keyword">if</span> (i &lt; <span class="number">0</span>) i += <span class="number">256</span>;</span><br><span class="line">                <span class="keyword">if</span> (i &lt; <span class="number">16</span>) buf.append(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">                buf.append(Integer.toHexString(i));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> buf.toString();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block  </span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span>  <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h3 id="äºŒ-çŸ­ä¿¡æœåŠ¡"><a href="#äºŒ-çŸ­ä¿¡æœåŠ¡" class="headerlink" title="äºŒ. çŸ­ä¿¡æœåŠ¡"></a>äºŒ. çŸ­ä¿¡æœåŠ¡</h3><p>çŸ­ä¿¡éªŒè¯ï¼Œåªæœ‰ä¸‰å¤§è¿è¥å•†å…·æœ‰çŸ­ä¿¡å‘é€çš„èƒ½åŠ›ã€‚è¦å‘é€çŸ­ä¿¡åªæœ‰æ‰¾ä¸‰å¤§è¿è¥ï¼Œæˆ–è€…ä¸­é—´å•†ã€‚ç®€å•è¯´å°±æ˜¯è¦æ‰¾ç¬¬ä¸‰æ–¹çš„çŸ­ä¿¡å¹³å°ã€‚å¸¸è§çš„æœ‰é˜¿é‡Œäº‘ï¼Œäº¬ä¸œæ™ºè”äº‘ï¼Œä¹è®¯é€šç­‰ç­‰éå¸¸å¤šã€‚ä¸¾ä¾‹ä½¿ç”¨ç½‘å»ºçŸ­ä¿¡é€šï¼š<a href="http://www.smschinese.cn/">http://www.smschinese.cn/</a></p><ol><li><p>æ“ä½œæµç¨‹</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ç‚¹å‡»å·¦ä¸Šè§’é¦–é¡µ -&gt; APIæ¥å£ -&gt; ç½‘å»ºSMSçŸ­ä¿¡é€šAPIæ¥å£åœ°å€ -&gt; UTF<span class="number">-8</span>ç¼–ç å‘é€çŸ­ä¿¡æ¥å£ï¼š</span><br><span class="line">http:<span class="comment">//utf8.api.smschinese.cn/?Uid=æœ¬ç«™ç”¨æˆ·å&amp;Key=æ¥å£çŸ­ä¿¡å¯†é’¥&amp;smsMob=æ‰‹æœºå·ç &amp;smsText=éªŒè¯ç :8888</span></span><br><span class="line">æœ¬ç«™ç”¨æˆ·åUidï¼šæ³¨å†Œæ—¶ç”¨æˆ·å</span><br><span class="line">æ¥å£å®‰å…¨å¯†é’¥keyï¼šåˆšåˆšçœ‹åˆ°çš„å¯†é’¥</span><br><span class="line">æ‰‹æœºå·ç smsMobï¼šæ‰‹æœºå·ç </span><br><span class="line">çŸ­ä¿¡å†…å®¹smsTextï¼šéšä¾¿å†™</span><br><span class="line">apiæ¥å£ä¸­æœ‰å‘é€çŸ­ä¿¡çš„å„ä¸ªå¯¹åº”çŠ¶æ€ï¼šå‘é€äº†ä¸€æ¡ï¼Œå°±åªå‰©ä¸‹<span class="number">4</span>æ¡äº†</span><br></pre></td></tr></table></figure></li><li><p>å¯¼å…¥ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ä¸»è¦ç”¨äºåç«¯å‘é€httpè¯·æ±‚--&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- åç«¯å‘é€httpè¯·æ±‚ - ä¸€èˆ¬ç”¨åœ¨è°ƒç”¨ä¸‰æ–¹æ¥å£æ—¶ä¼šç”¨ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-httpclient<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-httpclient<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>å‘é€çŸ­ä¿¡å·¥å…·ç±»ï¼ˆå®˜ç½‘ä¹Ÿæœ‰ç›¸åº”ä»£ç å¯å‚è€ƒï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> io.coderyeah.basic.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.httpclient.HttpClient;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.httpclient.NameValuePair;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.httpclient.methods.PostMethod;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * çŸ­ä¿¡å‘é€å·¥å…·ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SmsUtils</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”¨æˆ·å</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">UID</span> <span class="operator">=</span> <span class="string">&quot;codermyth&quot;</span>;</span><br><span class="line">    <span class="comment">//ç§˜é’¥</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">KEY</span> <span class="operator">=</span> <span class="string">&quot;29766C0677741B5DA2CE2203260365DB&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‘é€çŸ­ä¿¡</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> phones  æ‰‹æœºä»¬ a,b</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> content å‘é€å†…å®¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> è¿”å›å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">sendSms</span><span class="params">(String phones, String content)</span> &#123;</span><br><span class="line">        <span class="type">PostMethod</span> <span class="variable">post</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">HttpClient</span> <span class="variable">client</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HttpClient</span>();</span><br><span class="line">            post = <span class="keyword">new</span> <span class="title class_">PostMethod</span>(<span class="string">&quot;http://utf8.api.smschinese.cn&quot;</span>);</span><br><span class="line">            post.addRequestHeader(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/x-www-form-urlencoded;charset=utf8&quot;</span>);<span class="comment">//åœ¨å¤´æ–‡ä»¶ä¸­è®¾ç½®è½¬ç </span></span><br><span class="line">            NameValuePair[] data = &#123;<span class="keyword">new</span> <span class="title class_">NameValuePair</span>(<span class="string">&quot;Uid&quot;</span>, SmsUtils.UID),</span><br><span class="line">                    <span class="keyword">new</span> <span class="title class_">NameValuePair</span>(<span class="string">&quot;Key&quot;</span>, SmsUtils.KEY),</span><br><span class="line">                    <span class="keyword">new</span> <span class="title class_">NameValuePair</span>(<span class="string">&quot;smsMob&quot;</span>, phones),</span><br><span class="line">                    <span class="keyword">new</span> <span class="title class_">NameValuePair</span>(<span class="string">&quot;smsText&quot;</span>, content)&#125;;</span><br><span class="line">            post.setRequestBody(data);</span><br><span class="line"></span><br><span class="line">            client.executeMethod(post);</span><br><span class="line">            <span class="type">int</span> <span class="variable">statusCode</span> <span class="operator">=</span> post.getStatusCode();</span><br><span class="line">            System.out.println(<span class="string">&quot;statusCode:&quot;</span> + statusCode); <span class="comment">//200 404 400</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(post.getResponseBodyAsString().getBytes(<span class="string">&quot;utf8&quot;</span>));</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (post != <span class="literal">null</span>) &#123;</span><br><span class="line">                post.releaseConnection();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        System.out.println(SmsUtils.sendSms(<span class="string">&quot;18365403510&quot;</span>, <span class="string">&quot;æ‚¨çš„éªŒè¯ç ä¸ºï¼šã€8848ã€‘,é‰´äºæ‚¨ä¼˜ç§€çš„èƒ½åŠ›è¡¨ç°,æ‚¨è¢«æˆäºˆç›ä¸½å¶å¥¥ç‰¹æ›¼ç§°å·,accept it, cutie!&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h3 id="ä¸‰-å‰ç«¯è·å–éªŒè¯ç æ¥å£"><a href="#ä¸‰-å‰ç«¯è·å–éªŒè¯ç æ¥å£" class="headerlink" title="ä¸‰. å‰ç«¯è·å–éªŒè¯ç æ¥å£"></a>ä¸‰. å‰ç«¯è·å–éªŒè¯ç æ¥å£</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;verification&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;code&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;am-icon-code-fork&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;tel&quot;</span> <span class="attr">name</span>=<span class="string">&quot;&quot;</span> <span class="attr">id</span>=<span class="string">&quot;code&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;phoneUserForm.phoneCode&quot;</span>  <span class="attr">placeholder</span>=<span class="string">&quot;è¯·è¾“å…¥éªŒè¯ç &quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">id</span>=<span class="string">&quot;dyMobileButton&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;sendMobileCode&quot;</span>&gt;</span>è·å–éªŒè¯ç <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è·å–çŸ­ä¿¡éªŒè¯ç </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‘é€éªŒè¯ç </span></span><br><span class="line"><span class="title function_">sendMobileCode</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">//1.åˆ¤æ–­æ‰‹æœºå·ä¸ä¸ºç©º</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">phoneUserForm</span>.<span class="property">phone</span>) &#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&quot;æ‰‹æœºå·ä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//2.åˆ¤æ–­å›¾ç‰‡éªŒè¯ç ä¸ä¸ºç©º</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">phoneUserForm</span>.<span class="property">imageCode</span>) &#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&quot;å›¾ç‰‡éªŒè¯ç ä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//3.è·å–æŒ‰é’®ï¼Œç¦ç”¨æŒ‰é’®  å‘é€æ—¶ç°åŒ–ä¸èƒ½ä½¿ç”¨ï¼Œå‘é€æˆåŠŸå€’è®¡æ—¶60æ‰èƒ½ä½¿ç”¨ï¼Œå¦‚æœå‘é€å¤±è´¥ç«‹å³å¯ä»¥å‘é€</span></span><br><span class="line">    <span class="keyword">let</span> sendBtn = $(event.<span class="property">target</span>);</span><br><span class="line">    sendBtn.<span class="title function_">attr</span>(<span class="string">&quot;disabled&quot;</span>, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> param = &#123;</span><br><span class="line">        <span class="attr">phone</span>: <span class="variable language_">this</span>.<span class="property">phoneUserForm</span>.<span class="property">phone</span>,</span><br><span class="line">        <span class="attr">imageCode</span>: <span class="variable language_">this</span>.<span class="property">phoneUserForm</span>.<span class="property">imageCode</span>,</span><br><span class="line">        <span class="attr">imageCodeKey</span>: <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;verifyCodeKey&quot;</span>)</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//4.å‘é€ajaxè¯·æ±‚</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">$http</span>.<span class="title function_">post</span>(<span class="string">&quot;/verifyCode/smsCode&quot;</span>, param).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> ajaxResult = res.<span class="property">data</span>;</span><br><span class="line">        <span class="keyword">if</span> (ajaxResult.<span class="property">success</span>) &#123;</span><br><span class="line">            <span class="title function_">alert</span>(<span class="string">&quot;æ‰‹æœºéªŒè¯ç å·²ç»å‘é€åˆ°æ‚¨çš„æ‰‹æœºï¼Œè¯·åœ¨3åˆ†é’Ÿå†…ä½¿ç”¨&quot;</span>);</span><br><span class="line">            <span class="comment">//4.1.å‘é€æˆï¼šå€’è®¡æ—¶</span></span><br><span class="line">            <span class="keyword">let</span> time = <span class="number">60</span>;</span><br><span class="line">            <span class="keyword">let</span> interval = <span class="variable language_">window</span>.<span class="built_in">setInterval</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                <span class="comment">//æ¯ä¸€æ¡å€’è®¡æ—¶å‡ä¸€</span></span><br><span class="line">                time = time - <span class="number">1</span>;</span><br><span class="line">                <span class="comment">//æŠŠå€’è®¡æ—¶æ—¶é—´æåˆ°æŒ‰é’®ä¸Š</span></span><br><span class="line">                sendBtn.<span class="title function_">html</span>(time + <span class="string">&#x27;s&#x27;</span>);</span><br><span class="line">                <span class="comment">//4.2.å€’è®¡æ—¶å®Œæˆæ¢å¤æŒ‰é’®</span></span><br><span class="line">                <span class="keyword">if</span> (time &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">                    sendBtn.<span class="title function_">html</span>(<span class="string">&quot;é‡æ–°å‘é€&quot;</span>);</span><br><span class="line">                    sendBtn.<span class="title function_">attr</span>(<span class="string">&quot;disabled&quot;</span>, <span class="literal">false</span>);</span><br><span class="line">                    <span class="comment">//æ¸…é™¤å®šæ—¶å™¨</span></span><br><span class="line">                    <span class="variable language_">window</span>.<span class="built_in">clearInterval</span>(interval);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, <span class="number">1000</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//4.3.å‘é€å¤±è´¥ï¼šæç¤ºï¼Œæ¢å¤æŒ‰é’®</span></span><br><span class="line">            sendBtn.<span class="title function_">attr</span>(<span class="string">&quot;disabled&quot;</span>, <span class="literal">false</span>);</span><br><span class="line">            <span class="title function_">alert</span>(ajaxResult.<span class="property">msg</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‘é€è¯·æ±‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ‰‹æœºæ³¨å†ŒåŠŸèƒ½</span></span><br><span class="line">            <span class="title function_">phoneRegister</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">agree</span>) &#123;</span><br><span class="line">                    <span class="title function_">alert</span>(<span class="string">&#x27;è¯·å‹¾é€‰æœåŠ¡åè®®&#x27;</span>)</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//å‰å°ä¸€èˆ¬åšæ ¡éªŒï¼šç©ºæ ¡éªŒï¼Œæ ¼å¼æ ¡éªŒï¼Œé‡å¤å¯†ç æ ¡éªŒ</span></span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">$http</span>.<span class="title function_">post</span>(<span class="string">&#x27;/user/register/phone&#x27;</span>, <span class="variable language_">this</span>.<span class="property">phoneUserForm</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">                    <span class="comment">//æ³¨å†ŒæˆåŠŸè·³è½¬åˆ°ç™»å½•é¡µé¢</span></span><br><span class="line">                    <span class="keyword">if</span> (res.<span class="property">data</span>.<span class="property">success</span>) &#123;</span><br><span class="line">                        location.<span class="property">href</span> = <span class="string">&quot;login.html&quot;</span>;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="title function_">alert</span>(res.<span class="property">data</span>.<span class="property">msg</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">                    <span class="title function_">alert</span>(<span class="string">&quot;ç³»ç»Ÿé”™è¯¯!&quot;</span>)</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;,</span><br></pre></td></tr></table></figure><h3 id="å››-åç«¯å®ç°è·å–çŸ­ä¿¡æ¥å£"><a href="#å››-åç«¯å®ç°è·å–çŸ­ä¿¡æ¥å£" class="headerlink" title="å››. åç«¯å®ç°è·å–çŸ­ä¿¡æ¥å£"></a>å››. åç«¯å®ç°è·å–çŸ­ä¿¡æ¥å£</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/smsCode&quot;)</span></span><br><span class="line">   <span class="meta">@ApiOperation(&quot;è·å–çŸ­ä¿¡éªŒè¯ç &quot;)</span></span><br><span class="line">   <span class="keyword">public</span> Result <span class="title function_">getPhoneCode</span><span class="params">(<span class="meta">@RequestBody</span> PhoneCodeDTO phoneCodeDTO)</span> &#123;</span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">           <span class="keyword">return</span> verifyCodeService.getPhoneCode(phoneCodeDTO);</span><br><span class="line">       &#125; <span class="keyword">catch</span> (BusinessException e) &#123;</span><br><span class="line">           e.printStackTrace();</span><br><span class="line">           <span class="keyword">return</span> Result.fail(e.getMessage());</span><br><span class="line">       &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">           <span class="keyword">return</span> Result.fail(<span class="string">&quot;ç³»ç»Ÿå¼‚å¸¸,è¯·ç¨åé‡è¯•!&quot;</span>);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">getPhoneCode</span><span class="params">(PhoneCodeDTO phoneCodeDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">String</span> <span class="variable">phone</span> <span class="operator">=</span> phoneCodeDTO.getPhone();</span><br><span class="line">        <span class="keyword">final</span> <span class="type">String</span> <span class="variable">InputImageCode</span> <span class="operator">=</span> phoneCodeDTO.getImageCode();</span><br><span class="line">        <span class="keyword">final</span> <span class="type">String</span> <span class="variable">imageCodeKey</span> <span class="operator">=</span> phoneCodeDTO.getImageCodeKey();</span><br><span class="line">        <span class="comment">// 1.åˆ¤æ–­å‚æ•°æ˜¯å¦ä¸ºç©º</span></span><br><span class="line">        <span class="keyword">if</span> (StrUtil.isBlank(phone)) &#123;</span><br><span class="line">            <span class="comment">// æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(<span class="string">&quot;ç”µè¯å·ç ä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (StrUtil.isBlank(InputImageCode)) &#123;</span><br><span class="line">            <span class="comment">// æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(<span class="string">&quot;å›¾å½¢éªŒè¯ç ä¸èƒ½ä¸ºç©ºä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 2.åˆ¤æ–­å›¾å½¢éªŒè¯ç æ˜¯å¦è¿‡æœŸ æ­£ç¡®</span></span><br><span class="line">        <span class="keyword">final</span> <span class="type">String</span> <span class="variable">imageCode</span> <span class="operator">=</span> stringRedisTemplate.opsForValue().get(<span class="string">&quot;cache:code:image:&quot;</span> + imageCodeKey);</span><br><span class="line">        <span class="keyword">if</span> (StrUtil.isBlank(imageCode)) &#123;</span><br><span class="line">            <span class="comment">// è¿‡æœŸäº†</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(<span class="string">&quot;å›¾å½¢éªŒè¯ç å·²è¿‡æœŸ,è¯·é‡æ–°è¾“å…¥ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// åˆ¤æ–­æ˜¯å¦ä¸€è‡´ å¿½ç•¥å¤§å°å†™</span></span><br><span class="line">        <span class="keyword">if</span> (!InputImageCode.equalsIgnoreCase(imageCode)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(<span class="string">&quot;å›¾ç‰‡éªŒè¯ç é”™è¯¯,è¯·é‡æ–°è¾“å…¥ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 3. é€šè¿‡å·ç åˆ¤æ–­ç”¨æˆ·æ˜¯å¦å·²ç»æ³¨å†Œ</span></span><br><span class="line">        <span class="keyword">final</span> <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userMapper.selectOne(<span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;User&gt;().eq(User::getPhone, phone));</span><br><span class="line">        <span class="keyword">if</span> (user != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">// ç”¨æˆ·å·²ç»å­˜åœ¨</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(<span class="string">&quot;è¯¥æ‰‹æœºå·ç å·²è¢«æ³¨å†Œè¿‡,è¯·æ‚¨ç›´æ¥ç™»å½•...&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 4.ä»redisè·å–çŸ­ä¿¡éªŒè¯ç </span></span><br><span class="line">        <span class="comment">// ç”¨æ¥å­˜å‚¨çŸ­ä¿¡éªŒè¯ç   redisä¸­å­˜å‚¨çš„å€¼æ˜¯ ã€çŸ­ä¿¡éªŒè¯ç :æ—¶é—´æˆ³ã€‘</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">code</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> stringRedisTemplate.opsForValue().get(Constants.USER_REGISTER_PHONE_PREFIX + phone);</span><br><span class="line">        <span class="keyword">if</span> (value != <span class="literal">null</span>) &#123; <span class="comment">// æ²¡æœ‰è¿‡æœŸ</span></span><br><span class="line">            <span class="comment">// åˆ¤æ–­æ—¶é—´æ˜¯å¦è¿‡æœŸ</span></span><br><span class="line">            <span class="keyword">final</span> <span class="type">long</span> <span class="variable">oldTime</span> <span class="operator">=</span> Long.parseLong(value.split(<span class="string">&quot;:&quot;</span>)[<span class="number">1</span>]);</span><br><span class="line">            <span class="comment">// ä¸€åˆ†é’Ÿä¹‹å†…ä¸å…è®¸é¢‘ç¹æ“ä½œ</span></span><br><span class="line">            <span class="keyword">if</span> ((System.currentTimeMillis() - oldTime) &lt;= <span class="number">1000</span> * <span class="number">60</span>) &#123;<span class="comment">// æ²¡è¿‡é‡å‘æ—¶é—´</span></span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(<span class="string">&quot;æ“ä½œé¢‘ç¹,è¯·ç¨åå†è¯•!&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                code = value.split(<span class="string">&quot;:&quot;</span>)[<span class="number">0</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;<span class="comment">// è¿‡æœŸäº†</span></span><br><span class="line">            <span class="comment">// ç”ŸæˆéªŒè¯ç </span></span><br><span class="line">            code = String.valueOf(RandomUtil.randomNumbers(<span class="number">6</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å­˜å…¥redis æœ‰æ•ˆæœŸ3åˆ†é’Ÿ</span></span><br><span class="line">        stringRedisTemplate.opsForValue().set(<span class="string">&quot;user:register:&quot;</span> + phone, code + <span class="string">&quot;:&quot;</span> + System.currentTimeMillis(), <span class="number">3L</span>, TimeUnit.MINUTES);</span><br><span class="line">        <span class="comment">// å‘é€éªŒè¯ç çŸ­ä¿¡</span></span><br><span class="line"><span class="comment">//        SmsUtils.sendSms(phone, &quot;æ‚¨çš„éªŒè¯ç æ˜¯&quot; + code + &quot;,è¯·åŠæ—¶ä½¿ç”¨æœ‰é™æœŸä¸º3åˆ†é’Ÿ&quot;);</span></span><br><span class="line">        log.info(<span class="string">&quot;=========æ‚¨çš„éªŒè¯ç æ˜¯:&#123;&#125;=========&quot;</span>, code);</span><br><span class="line">        <span class="keyword">return</span> Result.success(<span class="string">&quot;è·å–éªŒè¯ç æˆåŠŸã€&quot;</span> + code + <span class="string">&quot;ã€‘&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;ä¸€-MD5åŠ å¯†å·¥å…·ç±»&quot;&gt;&lt;a href=&quot;#ä¸€-MD5åŠ å¯†å·¥å…·ç±»&quot; class=&quot;headerlink&quot; title=&quot;ä¸€. MD5åŠ å¯†å·¥å…·ç±»&quot;&gt;&lt;/a&gt;ä¸€. MD5åŠ å¯†å·¥å…·ç±»&lt;/h3&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;</summary>
      
    
    
    
    
  </entry>
  
</feed>
